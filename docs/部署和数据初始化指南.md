# éƒ¨ç½²å’Œæ•°æ®åˆå§‹åŒ–æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [æœ¬åœ°å¼€å‘ç¯å¢ƒåˆå§‹åŒ–](#æœ¬åœ°å¼€å‘ç¯å¢ƒåˆå§‹åŒ–)
2. [å¯¼èˆªèœå•æ•°æ®ç”Ÿæˆ](#å¯¼èˆªèœå•æ•°æ®ç”Ÿæˆ)
3. [AWS ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#aws-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
4. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æœ¬åœ°å¼€å‘ç¯å¢ƒåˆå§‹åŒ–

### 1. å®‰è£…ä¾èµ–

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
npm install

# è¿›å…¥ CMS ç›®å½•
cd cms
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` åˆ° `.env`:

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ï¼š

```env
DATABASE_URL="postgresql://busrom_dev:busrom_dev_password@localhost:5432/busrom_dev"
SESSION_SECRET="your-secret-here-min-32-chars"
```

### 3. å¯åŠ¨æœ¬åœ°æ•°æ®åº“ï¼ˆDockerï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
docker-compose up -d postgres
```

### 4. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
cd cms
npm run migrate
```

### 5. ç”Ÿæˆå¯¼èˆªèœå•æ•°æ®

```bash
npm run seed:navigation
```

### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—®: http://localhost:3000

---

## å¯¼èˆªèœå•æ•°æ®ç”Ÿæˆ

### è‡ªåŠ¨ç”Ÿæˆè„šæœ¬

è„šæœ¬ä½ç½®: `cms/scripts/seed-navigation-menus.ts`

### ç”Ÿæˆçš„èœå•ç»“æ„

```
âœ… Home (/)
âœ… Product (/product)
   â”œâ”€ Glass Standoff (/product/glass-standoff)
   â”œâ”€ Glass Connected Fitting (/product/glass-connected-fitting)
   â”œâ”€ Glass Fence Spigot (/product/glass-fence-spigot)
   â”œâ”€ Glass Clip (/product/glass-clip)
   â”œâ”€ Glass Hinge (/product/glass-hinge)
   â”œâ”€ Sliding Door Kit (/product/sliding-door-kit)
   â”œâ”€ Bathroom & Door Handle (/product/bathroom-door-handle)
   â””â”€ Hidden Hook (/product/hidden-hook)

âœ… Shop (/shop)
   â”œâ”€ Glass Standoff (/shop?series=glass-standoff)
   â”œâ”€ Glass Connected Fitting (/shop?series=glass-connected-fitting)
   â”œâ”€ Glass Fence Spigot (/shop?series=glass-fence-spigot)
   â”œâ”€ Glass Clip (/shop?series=glass-clip)
   â”œâ”€ Glass Hinge (/shop?series=glass-hinge)
   â”œâ”€ Sliding Door Kit (/shop?series=sliding-door-kit)
   â”œâ”€ Bathroom & Door Handle (/shop?series=bathroom-door-handle)
   â””â”€ Hidden Hook (/shop?series=hidden-hook)

âœ… Service (/service)
   â”œâ”€ Service Overview (/service)
   â”œâ”€ One-stop Shop (/service/one-stop-shop)
   â”œâ”€ FAQ (/service/faq)
   â””â”€ Application (/service/application)

âœ… About Us (/about-us)
   â”œâ”€ Our Story (/about-us/story)
   â”œâ”€ Blog (/about-us/blog)
   â”œâ”€ Support (/about-us/support)
   â”œâ”€ Privacy Policy (/privacy-policy)
   â””â”€ Fraud Notice (/fraud-notice)

âœ… Contact Us (/contact-us)
```

### è¿è¡Œç§å­è„šæœ¬

```bash
cd cms
npm run seed:navigation
```

### è„šæœ¬ç‰¹æ€§

- âœ… **å¹‚ç­‰æ€§**: å¯ä»¥å¤šæ¬¡è¿è¡Œï¼Œä¸ä¼šåˆ›å»ºé‡å¤æ•°æ®
- âœ… **æ™ºèƒ½è·³è¿‡**: æ£€æµ‹å·²å­˜åœ¨çš„èœå•é¡¹ï¼Œåªåˆ›å»ºç¼ºå¤±çš„
- âœ… **å¤šè¯­è¨€æ”¯æŒ**: åŒ…å« 24 ç§è¯­è¨€çš„ç¿»è¯‘
- âœ… **ç³»ç»Ÿä¿æŠ¤**: æ ¸å¿ƒèœå•æ ‡è®°ä¸º `isSystem: true`ï¼Œé˜²æ­¢è¯¯åˆ 

### è¾“å‡ºç¤ºä¾‹

```
ğŸš€ Starting navigation menu seed...

ğŸ“‹ Step 1: Creating top-level menus...
  âœ… Created: Home
  âœ… Created: Product
  âœ… Created: Shop
  âœ… Created: Service
  âœ… Created: About Us
  âœ… Created: Contact Us

ğŸ“‹ Step 2: Creating Product series submenu...
  âœ… Created: Product > Glass Standoff
  âœ… Created: Product > Glass Connected Fitting
  ...

ğŸ“‹ Step 3: Creating Shop series submenu...
  âœ… Created: Shop > Glass Standoff
  âœ… Created: Shop > Glass Connected Fitting
  ...

ğŸ“‹ Step 4: Creating Service submenu...
  âœ… Created: Service > Service Overview
  âœ… Created: Service > One-stop Shop
  ...

ğŸ“‹ Step 5: Creating About Us submenu...
  âœ… Created: About Us > Our Story
  âœ… Created: About Us > Blog
  ...

==================================================
âœ¨ Navigation menu seed completed!
==================================================
ğŸ“Š Summary:
   âœ… Created: 35 items
   â­ï¸  Skipped: 0 items (already exist)
   ğŸ“ Total:   35 items
==================================================
```

---

## AWS ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### æ–¹å¼ä¸€ï¼šä½¿ç”¨è‡ªåŠ¨éƒ¨ç½²è„šæœ¬

```bash
# SSH åˆ° EC2 å®ä¾‹
ssh -i your-key.pem ec2-user@your-ec2-ip

# å…‹éš†ä»“åº“
git clone https://github.com/your-org/busrom-cms.git
cd busrom-cms/cms

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # ç¼–è¾‘ç”Ÿäº§ç¯å¢ƒé…ç½®

# è¿è¡Œéƒ¨ç½²è„šæœ¬
bash scripts/deploy-setup.sh
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 1. å®‰è£…ä¾èµ–

```bash
npm ci
```

#### 2. ç”Ÿæˆ Prisma å®¢æˆ·ç«¯

```bash
npx prisma generate
```

#### 3. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
npx keystone prisma migrate deploy
```

#### 4. æ„å»º Keystone

```bash
npm run build
```

#### 5. ç”Ÿæˆå¯¼èˆªèœå•

```bash
npm run seed:navigation
```

#### 6. ç”Ÿæˆå…¶ä»–åˆå§‹æ•°æ®ï¼ˆå¯é€‰ï¼‰

```bash
# å¦‚æœæœ‰å…¶ä»–ç§å­è„šæœ¬
npm run seed:categories
npm run seed:media-categories
```

#### 7. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨

```bash
# ä½¿ç”¨ PM2 (æ¨è)
npm install -g pm2
pm2 start npm --name "busrom-cms" -- start
pm2 save
pm2 startup

# æˆ–ç›´æ¥è¿è¡Œ
npm start
```

### ç¯å¢ƒå˜é‡é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

```env
# æ•°æ®åº“
DATABASE_URL="postgresql://username:password@your-rds-endpoint:5432/busrom_prod"

# Session
SESSION_SECRET="production-secret-min-32-chars-very-secure"

# AWS S3
AWS_S3_BUCKET_NAME="busrom-media-prod"
AWS_REGION="us-east-1"
AWS_ACCESS_KEY_ID="your-access-key"
AWS_SECRET_ACCESS_KEY="your-secret-key"

# æœåŠ¡å™¨
PORT=3000
NODE_ENV=production

# CloudFront (å¯é€‰)
AWS_CLOUDFRONT_DOMAIN="d1234567890.cloudfront.net"
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•é‡æ–°ç”Ÿæˆå¯¼èˆªèœå•ï¼Ÿ

A: ç›´æ¥è¿è¡Œç§å­è„šæœ¬ï¼Œå®ƒä¼šè·³è¿‡å·²å­˜åœ¨çš„èœå•é¡¹ï¼š

```bash
npm run seed:navigation
```

### Q2: å¦‚ä½•åˆ é™¤æ‰€æœ‰å¯¼èˆªèœå•é‡æ–°å¼€å§‹ï¼Ÿ

A: å¯ä»¥åœ¨ Keystone Admin UI ä¸­æ‰‹åŠ¨åˆ é™¤ï¼Œæˆ–ä½¿ç”¨ Prismaï¼š

```bash
# è¿›å…¥ Prisma Studio
npx prisma studio

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œ
npx prisma db execute --stdin <<< "DELETE FROM \"NavigationMenu\";"
```

ç„¶åé‡æ–°è¿è¡Œç§å­è„šæœ¬ã€‚

### Q3: ç§å­è„šæœ¬æŠ¥é”™æ€ä¹ˆåŠï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. æ•°æ®åº“æ˜¯å¦æ­£å¸¸è¿æ¥
2. Keystone æ˜¯å¦å·²æ„å»ºï¼ˆ`npm run build`ï¼‰
3. Prisma å®¢æˆ·ç«¯æ˜¯å¦å·²ç”Ÿæˆï¼ˆ`npx prisma generate`ï¼‰
4. æŸ¥çœ‹é”™è¯¯æ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯

### Q4: å¦‚ä½•æ·»åŠ æ–°çš„èœå•é¡¹ï¼Ÿ

A: æœ‰ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼ 1: åœ¨ CMS Admin UI ä¸­æ‰‹åŠ¨æ·»åŠ **
1. è®¿é—® `/admin`
2. è¿›å…¥ "Navigation Menus"
3. ç‚¹å‡» "Create Navigation Menu"
4. å¡«å†™è¡¨å•å¹¶ä¿å­˜

**æ–¹å¼ 2: ä¿®æ”¹ç§å­è„šæœ¬**
1. ç¼–è¾‘ `cms/scripts/seed-navigation-menus.ts`
2. åœ¨ç›¸åº”çš„æ•°ç»„ä¸­æ·»åŠ æ–°èœå•é¡¹
3. è¿è¡Œ `npm run seed:navigation`

### Q5: å¯¼èˆªèœå•æ”¯æŒå¤šå°‘ç§è¯­è¨€ï¼Ÿ

A: å½“å‰æ”¯æŒ 24 ç§è¯­è¨€ï¼š

- è‹±è¯­ (en)
- ç®€ä½“ä¸­æ–‡ (zh-CN)
- ç¹ä½“ä¸­æ–‡ (zh-TW)
- è¥¿ç­ç‰™è¯­ (es)
- æ³•è¯­ (fr)
- å¾·è¯­ (de)
- æ„å¤§åˆ©è¯­ (it)
- è‘¡è„ç‰™è¯­ (pt)
- ä¿„è¯­ (ru)
- æ—¥è¯­ (ja)
- éŸ©è¯­ (ko)
- é˜¿æ‹‰ä¼¯è¯­ (ar)
- å°åœ°è¯­ (hi)
- æ³°è¯­ (th)
- è¶Šå—è¯­ (vi)
- å°å°¼è¯­ (id)
- é©¬æ¥è¯­ (ms)
- åœŸè€³å…¶è¯­ (tr)
- æ³¢å…°è¯­ (pl)
- è·å…°è¯­ (nl)
- ç‘å…¸è¯­ (sv)
- ä¸¹éº¦è¯­ (da)
- æŒªå¨è¯­ (no)
- èŠ¬å…°è¯­ (fi)
- æ·å…‹è¯­ (cs)

### Q6: å¦‚ä½•ä¿®æ”¹ç³»ç»Ÿèœå•çš„å†…å®¹ï¼Ÿ

A: ç³»ç»Ÿèœå•ï¼ˆ`isSystem: true`ï¼‰å¯ä»¥ç¼–è¾‘å†…å®¹ï¼Œä½†ä¸èƒ½åˆ é™¤ã€‚åœ¨ Admin UI ä¸­ï¼š

1. æ‰¾åˆ°è¦ä¿®æ”¹çš„èœå•é¡¹
2. ç‚¹å‡»è¿›å…¥ç¼–è¾‘é¡µé¢
3. ä¿®æ”¹ `name`ã€`link`ã€`order` ç­‰å­—æ®µ
4. ä¿å­˜

æ³¨æ„ï¼šåˆ é™¤æŒ‰é’®ä¼šè¢«ç¦ç”¨ï¼Œå› ä¸ºè¿™æ˜¯ç³»ç»Ÿæ ¸å¿ƒèœå•ã€‚

### Q7: Shop èœå•å’Œ Product èœå•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

A:

**Product èœå•**:
- å±•ç¤ºäº§å“ç³»åˆ—åˆ—è¡¨
- é“¾æ¥æ ¼å¼: `/product/glass-standoff`
- ç‚¹å‡»åè·³è½¬åˆ°è¯¥ç³»åˆ—çš„è¯¦æƒ…é¡µ

**Shop èœå•**:
- å±•ç¤ºæ‰€æœ‰äº§å“ï¼ˆå¯æŒ‰ç³»åˆ—ç­›é€‰ï¼‰
- é“¾æ¥æ ¼å¼: `/shop?series=glass-standoff`
- ç‚¹å‡»åè·³è½¬åˆ°äº§å“åˆ—è¡¨é¡µï¼Œå¹¶è‡ªåŠ¨åœ¨å·¦ä¾§ç­›é€‰å™¨ä¸­é€‰ä¸­è¯¥ç³»åˆ—

### Q8: å¦‚ä½•åœ¨ CI/CD ä¸­é›†æˆç§å­è„šæœ¬ï¼Ÿ

A: åœ¨ CI/CD é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```yaml
# .github/workflows/deploy.yml (GitHub Actions ç¤ºä¾‹)
- name: Seed Database
  run: |
    cd cms
    npm run seed:navigation
  env:
    DATABASE_URL: ${{ secrets.DATABASE_URL }}
```

æˆ–åœ¨ AWS CodeDeploy çš„ `appspec.yml` ä¸­ï¼š

```yaml
hooks:
  AfterInstall:
    - location: scripts/deploy-setup.sh
      timeout: 300
      runas: ec2-user
```

---

## é™„å½•ï¼šç§å­è„šæœ¬ç»´æŠ¤

### æ·»åŠ æ–°çš„äº§å“ç³»åˆ—

ç¼–è¾‘ `cms/scripts/seed-navigation-menus.ts`ï¼Œæ‰¾åˆ° `PRODUCT_SERIES` æ•°ç»„ï¼š

```typescript
const PRODUCT_SERIES = [
  // ... ç°æœ‰ç³»åˆ—
  {
    slug: 'new-product-series',
    nameEn: 'New Product Series',
    nameZh: 'æ–°äº§å“ç³»åˆ—'
  },
]
```

### æ·»åŠ æ–°çš„æœåŠ¡å­èœå•

ç¼–è¾‘ `SERVICE_SUBMENU` æ•°ç»„ï¼š

```typescript
const SERVICE_SUBMENU = [
  // ... ç°æœ‰èœå•
  {
    identifier: 'service-new',
    parentIdentifier: 'service',
    name: {
      en: 'New Service',
      'zh-CN': 'æ–°æœåŠ¡',
    },
    type: 'STANDARD',
    icon: 'Star',
    link: '/service/new-service',
    order: 5,
  },
]
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-04
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
