# è”ç³»æˆ‘ä»¬é¡µé¢å®ç°æŒ‡å—

> **çŠ¶æ€**: âœ… å‰ç«¯å·²å®Œæˆ
> **æ—¥æœŸ**: 2025-11-15
> **ä¼˜å…ˆçº§**: P0 (æœ€é«˜ä¼˜å…ˆçº§)

---

## ğŸ“‹ å®ç°æ¦‚è¿°

è”ç³»æˆ‘ä»¬é¡µé¢ä½¿ç”¨ **FormConfig åŠ¨æ€è¡¨å•ç³»ç»Ÿ**,æ— éœ€åˆ›å»º Page,å®ç°æ›´çµæ´»çš„è¡¨å•ç®¡ç†ã€‚

### å·²å®Œæˆçš„å·¥ä½œ

1. âœ… **API ç«¯ç‚¹**: `/api/form-config/[name]/route.ts`
2. âœ… **å‰ç«¯é¡µé¢**: `/app/[locale]/contact-us/page.tsx`
3. âœ… **å®¢æˆ·ç«¯ç»„ä»¶**: `ContactPageClient.tsx`
4. âœ… **åŠ¨æ€è¡¨å•ç»„ä»¶**: `DynamicForm.tsx`
5. âœ… **å¤šè¯­è¨€æ”¯æŒ**: en.json å’Œ zh.json

### æŠ€æœ¯æ¶æ„

```
ç”¨æˆ·è®¿é—® /en/contact-us
    â†“
ContactPageClient ç»„ä»¶
    â†“
DynamicForm ç»„ä»¶
    â†“ è·å–è¡¨å•é…ç½®
/api/form-config/contact-us-form?locale=en
    â†“ æŸ¥è¯¢ FormConfig
Keystone GraphQL API
    â†“ è¿”å›é…ç½®
DynamicForm æ¸²æŸ“è¡¨å•å­—æ®µ
    â†“ ç”¨æˆ·æäº¤
/api/form-submissions (å·²æœ‰)
    â†“ ä¿å­˜æ•°æ®
FormSubmission æ¨¡å‹
    â†“ è‡ªåŠ¨å‘é€é‚®ä»¶
ç®¡ç†å‘˜æ”¶åˆ°é€šçŸ¥
```

---

## ğŸ”§ åœ¨ CMS ä¸­é…ç½®è¡¨å•

### æ­¥éª¤ 1: å¯åŠ¨ CMS

```bash
cd cms
npm run dev
```

è®¿é—®: `http://localhost:3000/admin`

### æ­¥éª¤ 2: åˆ›å»ºè”ç³»è¡¨å•é…ç½®

1. åœ¨ Keystone Admin å·¦ä¾§èœå•ç‚¹å‡» **"Form Configurations"**
2. ç‚¹å‡» **"Create Form Configuration"**
3. å¡«å†™ä»¥ä¸‹ä¿¡æ¯:

#### åŸºæœ¬ä¿¡æ¯

| å­—æ®µ | å€¼ | è¯´æ˜ |
|-----|---|------|
| **Form Name** | `contact-us-form` | âš ï¸ å¿…é¡»ä¸å‰ç«¯ä»£ç ä¸€è‡´ |
| **Display Name (EN)** | Contact Us Form | æ˜¾ç¤ºåç§° |
| **Display Name (ZH)** | è”ç³»æˆ‘ä»¬è¡¨å• | |
| **Description (EN)** | Contact form for general inquiries | |
| **Description (ZH)** | ç”¨äºä¸€èˆ¬å’¨è¯¢çš„è”ç³»è¡¨å• | |
| **Form Location** | Contact Us Page | é€‰æ‹© `CONTACT_US` |

#### è¡¨å•å­—æ®µé…ç½®

ç‚¹å‡» **"Form Fields"** å­—æ®µ,ä½¿ç”¨è¡¨å•å­—æ®µç¼–è¾‘å™¨é…ç½®ä»¥ä¸‹å­—æ®µ:

**è‹±æ–‡ (en)**:

```json
[
  {
    "fieldName": "name",
    "fieldType": "text",
    "label": "Your Name",
    "placeholder": "John Doe",
    "required": true,
    "order": 1
  },
  {
    "fieldName": "email",
    "fieldType": "email",
    "label": "Email Address",
    "placeholder": "john@example.com",
    "required": true,
    "order": 2
  },
  {
    "fieldName": "company",
    "fieldType": "text",
    "label": "Company Name",
    "placeholder": "Your Company",
    "required": false,
    "order": 3
  },
  {
    "fieldName": "phone",
    "fieldType": "tel",
    "label": "Phone Number",
    "placeholder": "+1 234 567 8900",
    "required": false,
    "order": 4
  },
  {
    "fieldName": "subject",
    "fieldType": "select",
    "label": "Subject",
    "required": true,
    "order": 5,
    "options": [
      { "value": "general", "label": "General Inquiry" },
      { "value": "product", "label": "Product Inquiry" },
      { "value": "quotation", "label": "Request Quotation" },
      { "value": "support", "label": "Technical Support" },
      { "value": "partnership", "label": "Partnership Opportunity" }
    ]
  },
  {
    "fieldName": "message",
    "fieldType": "textarea",
    "label": "Message",
    "placeholder": "Tell us more about your inquiry...",
    "required": true,
    "order": 6
  }
]
```

**ä¸­æ–‡ (zh)**:

```json
[
  {
    "fieldName": "name",
    "fieldType": "text",
    "label": "æ‚¨çš„å§“å",
    "placeholder": "å¼ ä¸‰",
    "required": true,
    "order": 1
  },
  {
    "fieldName": "email",
    "fieldType": "email",
    "label": "ç”µå­é‚®ç®±",
    "placeholder": "zhang@example.com",
    "required": true,
    "order": 2
  },
  {
    "fieldName": "company",
    "fieldType": "text",
    "label": "å…¬å¸åç§°",
    "placeholder": "æ‚¨çš„å…¬å¸",
    "required": false,
    "order": 3
  },
  {
    "fieldName": "phone",
    "fieldType": "tel",
    "label": "ç”µè¯å·ç ",
    "placeholder": "+86 138 0000 0000",
    "required": false,
    "order": 4
  },
  {
    "fieldName": "subject",
    "fieldType": "select",
    "label": "ä¸»é¢˜",
    "required": true,
    "order": 5,
    "options": [
      { "value": "general", "label": "ä¸€èˆ¬å’¨è¯¢" },
      { "value": "product", "label": "äº§å“å’¨è¯¢" },
      { "value": "quotation", "label": "è¯·æ±‚æŠ¥ä»·" },
      { "value": "support", "label": "æŠ€æœ¯æ”¯æŒ" },
      { "value": "partnership", "label": "åˆä½œæœºä¼š" }
    ]
  },
  {
    "fieldName": "message",
    "fieldType": "textarea",
    "label": "ç•™è¨€",
    "placeholder": "å‘Šè¯‰æˆ‘ä»¬æ›´å¤šå…³äºæ‚¨çš„å’¨è¯¢...",
    "required": true,
    "order": 6
  }
]
```

#### æŒ‰é’®å’Œæ¶ˆæ¯æ–‡æœ¬

| å­—æ®µ | è‹±æ–‡ (EN) | ä¸­æ–‡ (ZH) |
|-----|----------|----------|
| **Submit Button Text** | Send Message | å‘é€æ¶ˆæ¯ |
| **Success Message** | Thank you for contacting us! We'll get back to you soon. | æ„Ÿè°¢æ‚¨è”ç³»æˆ‘ä»¬ï¼æˆ‘ä»¬ä¼šå°½å¿«å›å¤æ‚¨ã€‚ |
| **Error Message** | Failed to send message. Please try again. | å‘é€å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚ |

#### é‚®ä»¶é€šçŸ¥é…ç½®

| å­—æ®µ | å€¼ | è¯´æ˜ |
|-----|---|------|
| **Notification Email** | `info@busrom.com` | æ¥æ”¶è¡¨å•æäº¤é€šçŸ¥çš„é‚®ç®± |
| **Enable Email Notification** | âœ… | å‹¾é€‰ |
| **Enable Auto Reply** | âœ… | å¯é€‰,å‹¾é€‰åè‡ªåŠ¨å›å¤ç”¨æˆ· |
| **Auto Reply Subject (EN)** | Thank you for contacting Busrom | |
| **Auto Reply Subject (ZH)** | æ„Ÿè°¢æ‚¨è”ç³» Busrom | |
| **Auto Reply Content (EN)** | Dear {name},<br><br>Thank you for your inquiry. Our team will review your message and get back to you within 24 hours.<br><br>Best regards,<br>Busrom Team | |
| **Auto Reply Content (ZH)** | å°Šæ•¬çš„ {name},<br><br>æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ã€‚æˆ‘ä»¬çš„å›¢é˜Ÿå°†å®¡æ ¸æ‚¨çš„ç•™è¨€å¹¶åœ¨ 24 å°æ—¶å†…å›å¤æ‚¨ã€‚<br><br>æ­¤è‡´<br>Busrom å›¢é˜Ÿ | |

#### å…¶ä»–é…ç½®

| å­—æ®µ | å€¼ |
|-----|---|
| **Enable CAPTCHA** | å¯é€‰ (å»ºè®®ç”Ÿäº§ç¯å¢ƒå¯ç”¨) |
| **Max Submissions Per Day** | 10 (åŒä¸€IPæ¯å¤©æœ€å¤šæäº¤10æ¬¡) |

### æ­¥éª¤ 3: å‘å¸ƒè¡¨å•

- å°† **Status** è®¾ç½®ä¸º **"Published"**
- ç‚¹å‡» **"Save"**

---

## ğŸ§ª æµ‹è¯•è¡¨å•

### æ­¥éª¤ 1: å¯åŠ¨å‰ç«¯

```bash
cd web
npm run dev
```

### æ­¥éª¤ 2: è®¿é—®è”ç³»æˆ‘ä»¬é¡µé¢

- è‹±æ–‡: `http://localhost:3001/en/contact-us`
- ä¸­æ–‡: `http://localhost:3001/zh/contact-us`

### æ­¥éª¤ 3: æµ‹è¯•åŠŸèƒ½

**æµ‹è¯•æ¸…å•**:

- [ ] é¡µé¢åŠ è½½æ­£å¸¸
- [ ] è¡¨å•å­—æ®µæ˜¾ç¤ºæ­£ç¡® (6 ä¸ªå­—æ®µ)
- [ ] è‹±æ–‡/ä¸­æ–‡åˆ‡æ¢æ­£å¸¸
- [ ] å¿…å¡«å­—æ®µéªŒè¯ç”Ÿæ•ˆ
- [ ] æäº¤è¡¨å•æˆåŠŸ
- [ ] æˆåŠŸæ¶ˆæ¯æ˜¾ç¤º
- [ ] åç«¯æ”¶åˆ°æäº¤æ•°æ®
- [ ] é‚®ä»¶é€šçŸ¥å‘é€æˆåŠŸ (å¦‚æœé…ç½®äº† SMTP)

### æ­¥éª¤ 4: æŸ¥çœ‹æäº¤æ•°æ®

1. è¿›å…¥ Keystone Admin
2. ç‚¹å‡» **"Form Submissions"**
3. æŸ¥çœ‹æœ€æ–°æäº¤è®°å½•
4. ç¡®è®¤æ•°æ®å®Œæ•´ä¸”æ ¼å¼æ­£ç¡®

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
web/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ form-config/
â”‚   â”‚       â””â”€â”€ [name]/
â”‚   â”‚           â””â”€â”€ route.ts          âœ… æ–°å»º - è·å–è¡¨å•é…ç½®
â”‚   â””â”€â”€ [locale]/
â”‚       â””â”€â”€ contact-us/
â”‚           â”œâ”€â”€ page.tsx               âœ… æ–°å»º - æœåŠ¡å™¨ç»„ä»¶
â”‚           â””â”€â”€ ContactPageClient.tsx  âœ… æ–°å»º - å®¢æˆ·ç«¯ç»„ä»¶
â”œâ”€â”€ components/
â”‚   â””â”€â”€ forms/
â”‚       â””â”€â”€ DynamicForm.tsx            âœ… æ–°å»º - åŠ¨æ€è¡¨å•ç»„ä»¶
â””â”€â”€ messages/
    â”œâ”€â”€ en.json                        âœ… å·²æ›´æ–° - æ·»åŠ  ContactPage ç¿»è¯‘
    â””â”€â”€ zh.json                        âœ… å·²æ›´æ–° - æ·»åŠ  ContactPage ç¿»è¯‘
```

---

## ğŸ”„ æœªæ¥ä¼˜åŒ–

### P1 ä¼˜å…ˆçº§

1. **é›†æˆ Google Maps**
   - åœ¨å…¬å¸ä¿¡æ¯åŒºåŸŸåµŒå…¥ Google Maps
   - æ˜¾ç¤º Busrom åŠå…¬åœ°ç‚¹

2. **ä» SiteConfig è·å–å…¬å¸ä¿¡æ¯**
   - åœ°å€ã€ç”µè¯ã€é‚®ç®±ç­‰ä» SiteConfig åŠ¨æ€è·å–
   - ä¸éœ€è¦ç¡¬ç¼–ç åœ¨ç»„ä»¶ä¸­

3. **æ·»åŠ ç¤¾äº¤åª’ä½“é“¾æ¥**
   - ä» SiteConfig è·å–ç¤¾äº¤åª’ä½“é“¾æ¥
   - æ˜¾ç¤ºçœŸå®çš„ç¤¾äº¤åª’ä½“å›¾æ ‡

### P2 ä¼˜å…ˆçº§

4. **æ·»åŠ  Google reCAPTCHA**
   - é˜²æ­¢åƒåœ¾æäº¤
   - åœ¨ FormConfig ä¸­é…ç½® enableCaptcha æ—¶å¯ç”¨

5. **æ–‡ä»¶ä¸Šä¼ æ”¯æŒ**
   - å…è®¸ç”¨æˆ·ä¸Šä¼ é™„ä»¶ (PDF/å›¾ç‰‡)
   - å­˜å‚¨åˆ° S3

6. **æ›´å¤šè¡¨å•ç±»å‹**
   - è¯¢ä»·è¡¨å•
   - æŠ€æœ¯æ”¯æŒè¡¨å•
   - åˆä½œä¼™ä¼´ç”³è¯·è¡¨å•

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è¡¨å•é…ç½®åŠ è½½å¤±è´¥

**ç—‡çŠ¶**: é¡µé¢æ˜¾ç¤º "Form configuration not found"

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ FormConfig çš„ `name` å­—æ®µæ˜¯å¦ä¸º `contact-us-form`
2. æ£€æŸ¥ FormConfig çš„ `status` æ˜¯å¦ä¸º `PUBLISHED`
3. æ£€æŸ¥ CMS æ˜¯å¦æ­£åœ¨è¿è¡Œ (`http://localhost:3000`)

### é—®é¢˜ 2: è¡¨å•æäº¤å¤±è´¥

**ç—‡çŠ¶**: ç‚¹å‡»æäº¤åæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `/api/form-submissions` ç«¯ç‚¹æ˜¯å¦æ­£å¸¸
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯æ—¥å¿—
3. æŸ¥çœ‹ CMS æœåŠ¡å™¨æ—¥å¿—

### é—®é¢˜ 3: é‚®ä»¶é€šçŸ¥æœªå‘é€

**ç—‡çŠ¶**: è¡¨å•æäº¤æˆåŠŸä½†æœªæ”¶åˆ°é‚®ä»¶

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ SMTP é…ç½® (åœ¨ cms/.env ä¸­)
2. æ£€æŸ¥ FormConfig çš„ `notificationEmail` æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ FormConfig çš„ `enableEmailNotification` æ˜¯å¦å‹¾é€‰
4. æŸ¥çœ‹ CMS æ—¥å¿—ä¸­çš„é‚®ä»¶å‘é€é”™è¯¯

---

## âœ… å®Œæˆæ£€æŸ¥è¡¨

éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå‰,ç¡®ä¿:

- [ ] åœ¨ CMS ä¸­åˆ›å»ºå¹¶å‘å¸ƒ `contact-us-form` é…ç½®
- [ ] é…ç½®æ­£ç¡®çš„é€šçŸ¥é‚®ç®±
- [ ] æµ‹è¯•è¡¨å•æäº¤æˆåŠŸ
- [ ] æµ‹è¯•é‚®ä»¶é€šçŸ¥å‘é€
- [ ] æµ‹è¯•å¤šè¯­è¨€åˆ‡æ¢ (en/zh)
- [ ] æ›´æ–°å…¬å¸è”ç³»ä¿¡æ¯ (åœ°å€/ç”µè¯/é‚®ç®±)
- [ ] é›†æˆ Google Maps (å¯é€‰)
- [ ] å¯ç”¨ reCAPTCHA (æ¨è)
- [ ] æ£€æŸ¥é¡µé¢ SEO metadata
- [ ] ç§»åŠ¨ç«¯é€‚é…æµ‹è¯•

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜,è¯·å‚è€ƒ:
- **FormConfig æ–‡æ¡£**: `docs/å¦‚ä½•ä½¿ç”¨è¡¨å•ç»„ä»¶å—.md`
- **FormSubmission æ–‡æ¡£**: `docs/FormSubmission_Implementation.md`
- **å‰ç«¯å¼€å‘æŒ‡å—**: `docs/å‰ç«¯å¼€å‘æŒ‡å—_v2.0.md`

---

**æ–‡æ¡£æ›´æ–°æ—¥æœŸ**: 2025-11-15
