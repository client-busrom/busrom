# è¡¨å•ç»„ä»¶å—å¤šè¯­è¨€æ”¯æŒ

## æ¦‚è¿°

FormConfig å’Œ Form Block å·²ç»å®Œå…¨æ”¯æŒå¤šè¯­è¨€é…ç½®ï¼Œå­—æ®µç»“æ„ä¸ Product çš„ specifications ä¿æŒä¸€è‡´ã€‚

## æ•°æ®ç»“æ„

### FormConfig ä¸­çš„ fields å­—æ®µ

```typescript
fields: [
  {
    fieldName: 'name',           // å­—æ®µåç§°ï¼ˆå›ºå®šï¼Œç”¨äºæäº¤æ•°æ®ï¼‰
    fieldType: 'text',           // å­—æ®µç±»å‹
    label: {                     // å¤šè¯­è¨€æ ‡ç­¾
      en: 'Your Name',
      zh: 'æ‚¨çš„å§“å',
      // å¯æ·»åŠ æ›´å¤šè¯­è¨€...
    },
    placeholder: {               // å¤šè¯­è¨€å ä½ç¬¦
      en: 'Enter your name',
      zh: 'è¯·è¾“å…¥æ‚¨çš„å§“å',
    },
    required: true,              // æ˜¯å¦å¿…å¡«
    order: 1,                    // æ˜¾ç¤ºé¡ºåº
  },
  // æ›´å¤šå­—æ®µ...
]
```

### ä¸ Product.specifications çš„å¯¹æ¯”

| Product.specifications | FormConfig.fields | è¯´æ˜ |
|------------------------|-------------------|------|
| `text` | `fieldName` | å­—æ®µæ ‡è¯† |
| `items[].text` | `label` | å¤šè¯­è¨€æ ‡ç­¾ |
| `items[].url` | `placeholder` | å¤šè¯­è¨€æç¤ºæ–‡æœ¬ |
| - | `fieldType` | å­—æ®µç±»å‹ï¼ˆtext/email/textareaç­‰ï¼‰|
| - | `required` | æ˜¯å¦å¿…å¡« |

## æ”¯æŒçš„å­—æ®µç±»å‹

åœ¨ `FormFieldsConfigField.tsx` ä¸­å®šä¹‰ï¼š

```typescript
const FIELD_TYPES = [
  { value: 'text', label: 'Text (å•è¡Œæ–‡æœ¬)' },
  { value: 'email', label: 'Email (é‚®ç®±)' },
  { value: 'tel', label: 'Tel (ç”µè¯)' },
  { value: 'textarea', label: 'Textarea (å¤šè¡Œæ–‡æœ¬)' },
  { value: 'number', label: 'Number (æ•°å­—)' },
  { value: 'select', label: 'Select (ä¸‹æ‹‰é€‰æ‹©)' },
  { value: 'radio', label: 'Radio (å•é€‰)' },
  { value: 'checkbox', label: 'Checkbox (å¤é€‰æ¡†)' },
  { value: 'date', label: 'Date (æ—¥æœŸ)' },
  { value: 'file', label: 'File (æ–‡ä»¶ä¸Šä¼ )' },
]
```

## å‰ç«¯å¤šè¯­è¨€å¤„ç†

### ContactFormBlock ç»„ä»¶

å‰ç«¯ç»„ä»¶ä¼šæ ¹æ®å½“å‰ locale è‡ªåŠ¨é€‰æ‹©å¯¹åº”è¯­è¨€ï¼š

```typescript
// Helper function to get localized text
const getLocalizedText = (text: Record<string, string> | string | undefined): string => {
  if (!text) return ''
  if (typeof text === 'string') return text
  // Try to get text in current locale, fallback to 'en', then any available language
  return text[locale] || text['en'] || text['zh'] || Object.values(text)[0] || ''
}

// ä½¿ç”¨ç¤ºä¾‹
const labelText = getLocalizedText(field.label)
const placeholderText = getLocalizedText(field.placeholder)
```

### è¯­è¨€ä¼˜å…ˆçº§

```
å½“å‰ locale > en > zh > ç¬¬ä¸€ä¸ªå¯ç”¨è¯­è¨€ > ç©ºå­—ç¬¦ä¸²
```

ä¾‹å¦‚ï¼š
- å¦‚æœ `locale = 'ja'`ï¼Œä½†å­—æ®µåªæœ‰ `en` å’Œ `zh`ï¼Œåˆ™ä½¿ç”¨ `en`
- å¦‚æœå­—æ®µåªæœ‰ `zh`ï¼Œåˆ™ä½¿ç”¨ `zh`

## CMS é¢„è§ˆç»„ä»¶

åœ¨ CMS ç¼–è¾‘å™¨ä¸­ï¼Œé¢„è§ˆä¼šæ˜¾ç¤ºä¸­æ–‡ä¼˜å…ˆï¼š

```typescript
const getDisplayText = (text: any): string => {
  if (!text) return ''
  if (typeof text === 'string') return text
  // Try zh first, then en, then any available language
  return text.zh || text.en || Object.values(text)[0] || ''
}
```

## ç§å­æ•°æ®ç¤ºä¾‹

å·²åˆ›å»ºçš„ 5 ä¸ª FormConfig éƒ½åŒ…å«ä¸­è‹±æ–‡åŒè¯­ï¼š

```typescript
{
  name: 'general-contact-form',
  displayName: {
    en: 'General Contact Form',
    zh: 'é€šç”¨è”ç³»è¡¨å•',
  },
  fields: [
    {
      fieldName: 'name',
      fieldType: 'text',
      label: { en: 'Your Name', zh: 'æ‚¨çš„å§“å' },
      placeholder: { en: 'Enter your name', zh: 'è¯·è¾“å…¥æ‚¨çš„å§“å' },
      required: true,
      order: 1,
    },
    // ...
  ],
  submitButtonText: {
    en: 'Submit',
    zh: 'æäº¤',
  },
  successMessage: {
    en: 'Thank you! Your message has been sent successfully.',
    zh: 'æ„Ÿè°¢æ‚¨ï¼æ‚¨çš„æ¶ˆæ¯å·²æˆåŠŸå‘é€ã€‚',
  },
  errorMessage: {
    en: 'Something went wrong. Please try again.',
    zh: 'å‡ºé”™äº†ï¼Œè¯·é‡è¯•ã€‚',
  },
}
```

## å¤šè¯­è¨€å­—æ®µå®Œæ•´åˆ—è¡¨

FormConfig ä¸­æ”¯æŒå¤šè¯­è¨€çš„å­—æ®µï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `displayName` | json | è¡¨å•æ˜¾ç¤ºåç§° |
| `description` | json | è¡¨å•æè¿° |
| `fields[].label` | object | å­—æ®µæ ‡ç­¾ |
| `fields[].placeholder` | object | å­—æ®µå ä½ç¬¦ |
| `fields[].options[].label` | object | é€‰é¡¹æ ‡ç­¾ï¼ˆç”¨äº select/radio/checkboxï¼‰|
| `submitButtonText` | json | æäº¤æŒ‰é’®æ–‡å­— |
| `successMessage` | json | æˆåŠŸæç¤ºæ¶ˆæ¯ |
| `errorMessage` | json | é”™è¯¯æç¤ºæ¶ˆæ¯ |
| `autoReplySubject` | json | è‡ªåŠ¨å›å¤é‚®ä»¶ä¸»é¢˜ |
| `autoReplyContent` | json | è‡ªåŠ¨å›å¤é‚®ä»¶å†…å®¹ |

## æ·»åŠ æ–°è¯­è¨€

### 1. åœ¨ CMS ä¸­é…ç½®

ä½¿ç”¨ `FormFieldsConfigField` è‡ªå®šä¹‰å­—æ®µç¼–è¾‘å™¨ï¼š

1. ç‚¹å‡»å­—æ®µçš„"ç¼–è¾‘"æŒ‰é’®
2. åœ¨ label å’Œ placeholder çš„å¤šè¯­è¨€ç¼–è¾‘å™¨ä¸­æ·»åŠ æ–°è¯­è¨€
3. æ”¯æŒçš„è¯­è¨€åœ¨ `MultilingualJSONField` ä¸­å®šä¹‰

### 2. å‰ç«¯è‡ªåŠ¨æ”¯æŒ

å‰ç«¯ä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ·çš„ locale é€‰æ‹©å¯¹åº”è¯­è¨€ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

## è‡ªå®šä¹‰å­—æ®µç¼–è¾‘å™¨

FormConfig ä½¿ç”¨ä¸“é—¨çš„è‡ªå®šä¹‰å­—æ®µç¼–è¾‘å™¨ï¼š

**CMS**: `cms/custom-fields/FormFieldsConfigField.tsx`
- æ”¯æŒæ‹–æ‹½æ’åº
- å¤šè¯­è¨€ç¼–è¾‘
- å­—æ®µç±»å‹é€‰æ‹©
- éªŒè¯è§„åˆ™é…ç½®

## å‰ç«¯æ¸²æŸ“æµç¨‹

```
1. ç”¨æˆ·è®¿é—®é¡µé¢ï¼ˆå¸¦ locale å‚æ•°ï¼‰
   â†“
2. åŠ è½½ FormConfig æ•°æ®
   â†“
3. è§£æ fields æ•°ç»„
   â†“
4. å¯¹æ¯ä¸ªå­—æ®µè°ƒç”¨ getLocalizedText()
   â†“
5. æ ¹æ® locale é€‰æ‹©å¯¹åº”è¯­è¨€æ–‡æœ¬
   â†“
6. æ¸²æŸ“è¡¨å•
```

## æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šä¸­æ–‡ç”¨æˆ·

```
locale = 'zh'
label = { en: 'Your Name', zh: 'æ‚¨çš„å§“å' }
â†’ æ˜¾ç¤ºï¼šæ‚¨çš„å§“å
```

### åœºæ™¯ 2ï¼šè‹±æ–‡ç”¨æˆ·

```
locale = 'en'
label = { en: 'Your Name', zh: 'æ‚¨çš„å§“å' }
â†’ æ˜¾ç¤ºï¼šYour Name
```

### åœºæ™¯ 3ï¼šæ—¥æ–‡ç”¨æˆ·ï¼ˆå­—æ®µæœªé…ç½®æ—¥æ–‡ï¼‰

```
locale = 'ja'
label = { en: 'Your Name', zh: 'æ‚¨çš„å§“å' }
â†’ å›é€€åˆ° enï¼šYour Name
```

### åœºæ™¯ 4ï¼šå­—æ®µåªé…ç½®äº†ä¸­æ–‡

```
locale = 'en'
label = { zh: 'æ‚¨çš„å§“å' }
â†’ å›é€€åˆ° zhï¼šæ‚¨çš„å§“å
```

## æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **è‡³å°‘é…ç½®ä¸­è‹±æ–‡**
   - `en` å’Œ `zh` æ˜¯å¿…é¡»çš„
   - å…¶ä»–è¯­è¨€å¯é€‰

2. **ä¿æŒä¸€è‡´æ€§**
   - åŒä¸€è¡¨å•çš„æ‰€æœ‰å­—æ®µåº”è¯¥é…ç½®ç›¸åŒçš„è¯­è¨€é›†
   - é¿å…æœ‰çš„å­—æ®µæœ‰æ—¥æ–‡ï¼Œæœ‰çš„å­—æ®µæ²¡æœ‰

3. **ä½¿ç”¨æ ‡å‡†çš„å­—æ®µåç§°**
   - `name`, `email`, `whatsapp`, `message`, `companyName`
   - æ–¹ä¾¿åç«¯å¤„ç†å’Œæ•°æ®åº“å­˜å‚¨

4. **åˆç†çš„å ä½ç¬¦æ–‡æœ¬**
   - å ä½ç¬¦åº”è¯¥æ˜¯ç¤ºä¾‹æ–‡æœ¬ï¼Œä¸æ˜¯è¯´æ˜æ–‡å­—
   - âŒ "è¯·è¾“å…¥æ‚¨çš„å§“å"
   - âœ… "å¼ ä¸‰"

### âŒ ä¸æ¨èåšæ³•

1. ~~åªé…ç½®ä¸€ç§è¯­è¨€~~
   - è‡³å°‘è¦æœ‰ä¸­è‹±æ–‡

2. ~~æ··åˆä½¿ç”¨å­—ç¬¦ä¸²å’Œå¯¹è±¡~~
   - è¦ä¹ˆå…¨éƒ¨ç”¨å¯¹è±¡ï¼Œè¦ä¹ˆå…¨éƒ¨ç”¨å­—ç¬¦ä¸²

3. ~~å­—æ®µåç§°ä¸ä¸€è‡´~~
   - âŒ æœ‰çš„ç”¨ `email`ï¼Œæœ‰çš„ç”¨ `emailAddress`
   - âœ… ç»Ÿä¸€ä½¿ç”¨ `email`

## ç›¸å…³æ–‡ä»¶

### CMS (åç«¯)
- `cms/schemas/FormConfig.ts` - FormConfig æ¨¡å‹å®šä¹‰
- `cms/custom-fields/FormFieldsConfigField.tsx` - å­—æ®µç¼–è¾‘å™¨
- `cms/component-blocks/components/form-block.tsx` - ç»„ä»¶å—å®šä¹‰

### Web (å‰ç«¯)
- `web/app/components/ContactFormBlock.tsx` - è¡¨å•æ¸²æŸ“ç»„ä»¶

### ç§å­æ•°æ®
- `scripts/seed-formconfig.ts` - FormConfig ç§å­æ•°æ®

## æ€»ç»“

FormConfig çš„å¤šè¯­è¨€æ”¯æŒå·²ç»å®Œå…¨å®ç°ï¼Œä¸ Product.specifications çš„ç»“æ„ä¿æŒä¸€è‡´ï¼š

1. âœ… æ•°æ®ç»“æ„æ”¯æŒå¤šè¯­è¨€å¯¹è±¡
2. âœ… CMS ç¼–è¾‘å™¨æ”¯æŒå¤šè¯­è¨€ç¼–è¾‘
3. âœ… å‰ç«¯è‡ªåŠ¨æ ¹æ® locale é€‰æ‹©è¯­è¨€
4. âœ… å›é€€æœºåˆ¶ç¡®ä¿æ€»èƒ½æ˜¾ç¤ºæ–‡æœ¬
5. âœ… ç§å­æ•°æ®åŒ…å«ä¸­è‹±æ–‡åŒè¯­ç¤ºä¾‹

è¿è¥äººå‘˜å¯ä»¥è½»æ¾åœ°åœ¨ CMS ä¸­é…ç½®å¤šè¯­è¨€è¡¨å•ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ·çš„è¯­è¨€åå¥½æ˜¾ç¤ºç›¸åº”çš„æ–‡æœ¬ï¼ğŸ‰
