# å¯¼èˆªèœå•é…ç½®è¯´æ˜

## ä¸€ã€èœå•ç»“æ„è®¾è®¡

### Shop èœå•çš„åŒé‡äº¤äº’æ–¹å¼

æ ¹æ®éœ€æ±‚ï¼ŒShop èœå•æ”¯æŒä¸¤ç§ç‚¹å‡»æ–¹å¼ï¼š

```
Shop (ä¸€çº§èœå•)
â”œâ”€ ç‚¹å‡»æ–‡å­— â†’ /shop (æ‰“å¼€äº§å“åˆ—è¡¨é¡µ)
â””â”€ ç‚¹å‡»ä¸‹æ‹‰æŒ‰é’® â†’ å±•å¼€äºŒçº§èœå•
   â”œâ”€ Glass Standoff â†’ /shop?series=glass-standoff
   â”œâ”€ Glass Connected Fitting â†’ /shop?series=glass-connected-fitting
   â”œâ”€ Glass Fence Spigot â†’ /shop?series=glass-fence-spigot
   â””â”€ ...
```

### Product èœå•çš„ç±»ä¼¼ç»“æ„

```
Product (ä¸€çº§èœå•)
â”œâ”€ ç‚¹å‡»æ–‡å­— â†’ /product (æ‰“å¼€ç³»åˆ—åˆ—è¡¨é¡µ)
â””â”€ ç‚¹å‡»ä¸‹æ‹‰æŒ‰é’® â†’ å±•å¼€äºŒçº§èœå•
   â”œâ”€ Glass Standoff â†’ /product/glass-standoff
   â”œâ”€ Glass Connected Fitting â†’ /product/glass-connected-fitting
   â””â”€ ...
```

---

## äºŒã€CMS ä¸­çš„é…ç½®æ–¹å¼

### 1. é…ç½® Shop ä¸€çº§èœå•

| å­—æ®µ | å€¼ |
|------|-----|
| **Name** | `{"en": "Shop", "zh-CN": "å•†åº—", ...}` |
| **Type** | `PRODUCT_CARDS` (å›¾æ–‡å¡ç‰‡) |
| **Link** | `/shop` |
| **Parent** | (ç•™ç©ºï¼Œè¡¨ç¤ºé¡¶çº§èœå•) |
| **Order** | `3` |
| **Visible** | âœ… |
| **isSystem** | âœ… (ç³»ç»Ÿèœå•ï¼Œä¸å¯åˆ é™¤) |

### 2. é…ç½® Shop çš„å­èœå•é¡¹

#### Glass Standoff å­èœå•

| å­—æ®µ | å€¼ |
|------|-----|
| **Name** | `{"en": "Glass Standoff", "zh-CN": "ç»ç’ƒç«‹æŸ±", ...}` |
| **Type** | `PRODUCT_CARDS` |
| **Link** | `/shop?series=glass-standoff` â­ |
| **Image** | (é€‰æ‹©ç³»åˆ—ä»£è¡¨å›¾) |
| **Parent** | Shop |
| **Order** | `1` |

#### Glass Connected Fitting å­èœå•

| å­—æ®µ | å€¼ |
|------|-----|
| **Name** | `{"en": "Glass Connected Fitting", ...}` |
| **Type** | `PRODUCT_CARDS` |
| **Link** | `/shop?series=glass-connected-fitting` â­ |
| **Image** | (é€‰æ‹©ç³»åˆ—ä»£è¡¨å›¾) |
| **Parent** | Shop |
| **Order** | `2` |

ä»¥æ­¤ç±»æ¨...

---

## ä¸‰ã€å‰ç«¯å®ç°è¦ç‚¹

### 1. å¯¼èˆªæ ç»„ä»¶ç»“æ„

```tsx
// components/Header/Navigation.tsx

<nav>
  {menuItems.map(menu => (
    <div key={menu.id} className="menu-item">
      {/* ä¸€çº§èœå•ï¼šå¯ç‚¹å‡»çš„é“¾æ¥ */}
      <Link href={menu.link}>
        {menu.name}
      </Link>

      {/* ä¸‹æ‹‰æŒ‰é’®ï¼šä»…å½“æœ‰å­èœå•æ—¶æ˜¾ç¤º */}
      {menu.children?.length > 0 && (
        <button
          onClick={() => toggleSubmenu(menu.id)}
          className="dropdown-toggle"
        >
          <ChevronDown />
        </button>
      )}

      {/* å­èœå• */}
      {isSubmenuOpen(menu.id) && (
        <Submenu menu={menu} />
      )}
    </div>
  ))}
</nav>
```

### 2. æ¸²æŸ“ä¸åŒç±»å‹çš„å­èœå•

```tsx
// components/Header/Submenu.tsx

const Submenu = ({ menu }: { menu: NavigationMenuItem }) => {
  switch (menu.type) {
    case 'PRODUCT_CARDS':
      // Shop å’Œ Product çš„ç³»åˆ—å¡ç‰‡å±•ç¤º
      return (
        <div className="mega-menu grid grid-cols-4 gap-4">
          {menu.children.map(child => (
            <Link
              key={child.id}
              href={child.link}  // /shop?series=xxx
              className="product-card"
            >
              <img src={child.image?.url} alt={child.name} />
              <h3>{child.name}</h3>
            </Link>
          ))}
        </div>
      )

    case 'SUBMENU':
      // About Us çš„å›¾æ ‡å­èœå•
      return (
        <div className="icon-submenu">
          {menu.children.map(child => (
            <Link key={child.id} href={child.link}>
              <Icon name={child.icon} />
              <span>{child.name}</span>
            </Link>
          ))}
        </div>
      )

    case 'STANDARD':
      // Service çš„æ™®é€šä¸‹æ‹‰èœå•
      return (
        <ul className="dropdown-menu">
          {menu.children.map(child => (
            <li key={child.id}>
              <Link href={child.link}>{child.name}</Link>
            </li>
          ))}
        </ul>
      )
  }
}
```

### 3. Shop é¡µé¢çš„ç­›é€‰é€»è¾‘

```tsx
// app/shop/page.tsx

export default async function ShopPage({
  searchParams
}: {
  searchParams: { series?: string }
}) {
  const selectedSeries = searchParams.series

  return (
    <div className="shop-page">
      {/* å·¦ä¾§ç­›é€‰å™¨ */}
      <aside className="filters">
        <h3>Product Series</h3>
        <SeriesFilter
          selectedSeries={selectedSeries} // â­ è‡ªåŠ¨é€‰ä¸­
        />
      </aside>

      {/* å³ä¾§äº§å“åˆ—è¡¨ */}
      <main>
        <ProductList series={selectedSeries} />
      </main>
    </div>
  )
}
```

### 4. ç­›é€‰å™¨ç»„ä»¶è‡ªåŠ¨é€‰ä¸­é€»è¾‘

```tsx
// components/Shop/SeriesFilter.tsx

const SeriesFilter = ({ selectedSeries }: { selectedSeries?: string }) => {
  const [selected, setSelected] = useState(selectedSeries)

  // å½“ URL å‚æ•°å˜åŒ–æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°é€‰ä¸­çŠ¶æ€
  useEffect(() => {
    if (selectedSeries) {
      setSelected(selectedSeries)
    }
  }, [selectedSeries])

  return (
    <div className="series-filter">
      {SERIES_LIST.map(series => (
        <label key={series.slug}>
          <input
            type="checkbox"
            checked={selected === series.slug}
            onChange={() => {
              const newSeries = selected === series.slug ? undefined : series.slug
              setSelected(newSeries)

              // æ›´æ–° URL
              const url = new URL(window.location.href)
              if (newSeries) {
                url.searchParams.set('series', newSeries)
              } else {
                url.searchParams.delete('series')
              }
              router.push(url.toString())
            }}
          />
          {series.name}
        </label>
      ))}
    </div>
  )
}
```

---

## å››ã€GraphQL æŸ¥è¯¢ç¤ºä¾‹

### è·å–å¯¼èˆªèœå•æ•°æ®

```graphql
query GetNavigationMenu {
  navigationMenus(
    where: {
      parent: { equals: null },  # åªè·å–é¡¶çº§èœå•
      visible: { equals: true }
    },
    orderBy: { order: asc }
  ) {
    id
    name  # JSON å¤šè¯­è¨€å­—æ®µ
    type
    icon
    link
    order

    children(
      where: { visible: { equals: true } },
      orderBy: { order: asc }
    ) {
      id
      name
      type
      icon
      link
      image {
        url
        alt
      }
    }
  }
}
```

### å“åº”ç¤ºä¾‹

```json
{
  "navigationMenus": [
    {
      "id": "menu-home",
      "name": {"en": "Home", "zh-CN": "é¦–é¡µ"},
      "type": "STANDARD",
      "link": "/",
      "children": []
    },
    {
      "id": "menu-shop",
      "name": {"en": "Shop", "zh-CN": "å•†åº—"},
      "type": "PRODUCT_CARDS",
      "link": "/shop",  // â­ ä¸€çº§èœå•è‡ªèº«çš„é“¾æ¥
      "children": [
        {
          "id": "shop-glass-standoff",
          "name": {"en": "Glass Standoff", "zh-CN": "ç»ç’ƒç«‹æŸ±"},
          "type": "PRODUCT_CARDS",
          "link": "/shop?series=glass-standoff",  // â­ å¸¦ç­›é€‰å‚æ•°
          "image": {
            "url": "/uploads/glass-standoff.jpg",
            "alt": "Glass Standoff"
          }
        },
        {
          "id": "shop-glass-fitting",
          "name": {"en": "Glass Connected Fitting"},
          "link": "/shop?series=glass-connected-fitting",
          "image": {...}
        }
      ]
    }
  ]
}
```

---

## äº”ã€å…³é”®è¦ç‚¹æ€»ç»“

### âœ… ç°æœ‰æ¨¡å‹å·²æ”¯æŒçš„åŠŸèƒ½

1. **ä¸€çº§èœå•å¯ç‚¹å‡»** - `link` å­—æ®µå¯é…ç½® `/shop`
2. **å­èœå•å¸¦æŸ¥è¯¢å‚æ•°** - `link` å­—æ®µå¯é…ç½® `/shop?series=xxx`
3. **å¤šç§èœå•ç±»å‹** - `type` å­—æ®µæ”¯æŒä¸‰ç§å±•ç¤ºæ–¹å¼
4. **å›¾ç‰‡æ”¯æŒ** - `image` å…³è” Media æ¨¡å‹
5. **å¤šè¯­è¨€æ”¯æŒ** - `name` ä½¿ç”¨ JSON å­—æ®µ

### ğŸ¨ å‰ç«¯éœ€è¦å®ç°çš„åŠŸèƒ½

1. **åˆ†ç¦»ç‚¹å‡»åŒºåŸŸ**
   - èœå•æ–‡å­—åŒºåŸŸ â†’ è·³è½¬åˆ° `menu.link`
   - ä¸‹æ‹‰å›¾æ ‡åŒºåŸŸ â†’ å±•å¼€/æ”¶èµ·å­èœå•

2. **æ ¹æ®ç±»å‹æ¸²æŸ“å­èœå•**
   - `PRODUCT_CARDS` â†’ å¡ç‰‡ç½‘æ ¼å¸ƒå±€
   - `SUBMENU` â†’ å¸¦å›¾æ ‡çš„åˆ—è¡¨
   - `STANDARD` â†’ æ™®é€šä¸‹æ‹‰åˆ—è¡¨

3. **Shop é¡µé¢ URL å‚æ•°å¤„ç†**
   - è¯»å– `?series=xxx` å‚æ•°
   - è‡ªåŠ¨åœ¨å·¦ä¾§ç­›é€‰å™¨ä¸­é€‰ä¸­å¯¹åº”ç³»åˆ—
   - ç­›é€‰äº§å“åˆ—è¡¨

### ğŸ“Œ é…ç½®æœ€ä½³å®è·µ

1. **ç³»ç»Ÿæ ¸å¿ƒèœå•** (Home/Product/Shop/Service/About Us/Contact Us) åº”æ ‡è®° `isSystem: true`
2. **äº§å“ç³»åˆ—å­èœå•** çš„ `link` æ ¼å¼ç»Ÿä¸€ä¸º `/shop?series={slug}`
3. **å›¾ç‰‡æ¯”ä¾‹** å»ºè®®ç»Ÿä¸€ä¸º 1:1 æˆ– 4:3
4. **æ’åº** ä½¿ç”¨ 1-100 ä¹‹é—´çš„æ•´æ•°ï¼Œé¢„ç•™æ‰©å±•ç©ºé—´

---

## å…­ã€æ•°æ®åº“è¿ç§»æ³¨æ„äº‹é¡¹

å½“å‰æ¨¡å‹å·²ç»éƒ¨ç½²åï¼Œå¦‚æœéœ€è¦æ‰¹é‡åˆ›å»ºèœå•ï¼Œå¯ä»¥ä½¿ç”¨ Keystone çš„ GraphQL APIï¼š

```typescript
// scripts/seed-navigation.ts

const NAVIGATION_MENUS = [
  // Shop ä¸»èœå•
  {
    name: { en: 'Shop', 'zh-CN': 'å•†åº—' },
    type: 'PRODUCT_CARDS',
    link: '/shop',
    order: 3,
    visible: true,
    isSystem: true,
    children: [
      {
        name: { en: 'Glass Standoff', 'zh-CN': 'ç»ç’ƒç«‹æŸ±' },
        type: 'PRODUCT_CARDS',
        link: '/shop?series=glass-standoff',
        order: 1,
        image: { connect: { id: 'media-id-1' } },
      },
      // ... å…¶ä»–ç³»åˆ—
    ]
  }
]

// ä½¿ç”¨ context.query æ‰¹é‡åˆ›å»º
for (const menu of NAVIGATION_MENUS) {
  await context.query.NavigationMenu.createOne({ data: menu })
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-04
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
