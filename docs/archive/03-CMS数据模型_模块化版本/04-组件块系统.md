# 04 - ç»„ä»¶å—ç³»ç»Ÿ

> **é˜…è¯»æ—¶é—´**: 20 åˆ†é’Ÿ  
> **é€‚ç”¨å¯¹è±¡**: åç«¯å¼€å‘å·¥ç¨‹å¸ˆã€å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ

åŒ…å«: ç»„ä»¶å—ç®¡ç†ã€æ¶æ„è®¾è®¡ã€Document Field é…ç½®ã€10ç§å¯Œæ–‡æœ¬ç»„ä»¶

---

## ğŸ¨ ç»„ä»¶å—ç®¡ç†ç³»ç»Ÿ (Component Block Manager)

### æ ¸å¿ƒéœ€æ±‚

å®¢æˆ·éœ€è¦ä¸€ä¸ª**å¯è§†åŒ–çš„ç»„ä»¶å—ç®¡ç†ç³»ç»Ÿ**ï¼Œè®©è¿è¥äººå‘˜å¯ä»¥ï¼š

1. âœ… **æŸ¥çœ‹**æ‰€æœ‰å¯ç”¨çš„ç»„ä»¶å—
2. âœ… **åˆ›å»º**æ–°çš„è‡ªå®šä¹‰ç»„ä»¶å—
3. âœ… **ç¼–è¾‘**è‡ªå®šä¹‰ç»„ä»¶å—çš„é…ç½®
4. âœ… **åˆ é™¤**è‡ªå®šä¹‰ç»„ä»¶å—ï¼ˆæœ‰é™åˆ¶ï¼‰
5. âœ… åœ¨ Document Field ç¼–è¾‘å™¨çš„ **"+" æŒ‰é’®**ä¸­ä½¿ç”¨è¿™äº›ç»„ä»¶å—

---

### ç»„ä»¶å—åˆ†ç±»ä¸æƒé™

| ç»„ä»¶å—ç±»å‹ | ç¤ºä¾‹ | å¯åˆ é™¤ï¼Ÿ | å¯ç¼–è¾‘ï¼Ÿ |
|-----------|------|---------|---------|
| **ğŸ”’ ç³»ç»Ÿæ¨¡æ¿ç»„ä»¶å—** | Single Image, Image Gallery, Video Embed | âŒ ä¸å¯åˆ é™¤ | âŒ ä¸å¯ç¼–è¾‘<br>ï¼ˆç³»ç»Ÿé¢„å®šä¹‰ï¼‰ |
| **ğŸ”’ å¤ç”¨ç»„ä»¶å—** | Global Footer, Inquiry Form | âŒ ä¸å¯åˆ é™¤ | âœ… å¯ç¼–è¾‘å†…å®¹<br>ï¼ˆä½†ä¸èƒ½åˆ é™¤ï¼‰ |
| **ğŸ”’ æ•°æ®åº“å¼•ç”¨ç»„ä»¶å—** | Product Reference, Blog Post Reference | âŒ ä¸å¯åˆ é™¤ | âŒ ä¸å¯ç¼–è¾‘ |
| **âœï¸ è‡ªå®šä¹‰æ¨¡æ¿ç»„ä»¶å—** | è¿è¥äººå‘˜åˆ›å»ºçš„ç»„ä»¶ | âœ… **å¯åˆ é™¤** | âœ… å¯ç¼–è¾‘ |

---

### æ•°æ®æ¨¡å‹è®¾è®¡

#### ComponentBlockDefinition (ç»„ä»¶å—å®šä¹‰è¡¨)

```typescript
// keystone/schemas/ComponentBlockDefinition.ts
export const ComponentBlockDefinition = list({
  fields: {
    // åŸºç¡€ä¿¡æ¯
    key: text({ 
      isIndexed: 'unique', 
      validation: { isRequired: true },
      ui: { description: 'Unique identifier (e.g., "custom-pricing-table")' }
    }),
    
    name: text({ 
      validation: { isRequired: true },
      ui: { description: 'Display name in the "+" menu' }
    }),
    
    icon: text({
      defaultValue: 'ğŸ“¦',
      ui: { description: 'Emoji icon for the "+" menu' }
    }),
    
    description: text({
      ui: { displayMode: 'textarea', description: 'Help text for users' }
    }),
    
    // ğŸ”¥ ç»„ä»¶å—ç±»å‹
    type: select({
      options: [
        { label: 'ğŸ“¦ Template Block (æ¨¡æ¿ç»„ä»¶å—)', value: 'TEMPLATE' },
        { label: 'ğŸ”— Reusable Block (å¤ç”¨ç»„ä»¶å—)', value: 'REUSABLE' },
        { label: 'ğŸ”— Database Reference (æ•°æ®åº“å¼•ç”¨)', value: 'DATABASE_REF' },
      ],
      validation: { isRequired: true },
      ui: {
        description: 'Type determines behavior and editability'
      }
    }),
    
    // ğŸ”¥ æ˜¯å¦ä¸ºç³»ç»Ÿé¢„å®šä¹‰
    isSystem: checkbox({
      defaultValue: false,
      ui: {
        description: 'âš ï¸ System blocks cannot be deleted',
        itemView: { fieldMode: 'read' } // åªè¯»ï¼Œé˜²æ­¢è¿è¥äººå‘˜ä¿®æ”¹
      }
    }),
    
    // ğŸ”¥ å­—æ®µå®šä¹‰ (Schema)
    schema: json({
      ui: {
        views: './custom-views/ComponentBlockSchemaEditor',
        description: 'Define the fields for this component block'
      }
    }),
    
    // ğŸ”¥ é¢„è§ˆç»„ä»¶ä»£ç  (å¯é€‰ï¼Œé«˜çº§åŠŸèƒ½)
    previewCode: text({
      ui: {
        displayMode: 'textarea',
        description: 'Optional: Custom React preview component code'
      }
    }),
    
    // åˆ†ç±»/æ ‡ç­¾
    category: select({
      options: [
        { label: 'Content', value: 'CONTENT' },
        { label: 'Media', value: 'MEDIA' },
        { label: 'Layout', value: 'LAYOUT' },
        { label: 'Form', value: 'FORM' },
        { label: 'Data Display', value: 'DATA_DISPLAY' },
        { label: 'Other', value: 'OTHER' },
      ],
      defaultValue: 'OTHER'
    }),
    
    // çŠ¶æ€
    status: select({
      options: [
        { label: 'Active', value: 'ACTIVE' },
        { label: 'Draft', value: 'DRAFT' },
        { label: 'Deprecated', value: 'DEPRECATED' },
      ],
      defaultValue: 'ACTIVE',
      ui: {
        description: 'Only ACTIVE blocks appear in the "+" menu'
      }
    }),
    
    // æ’åº
    order: integer({ 
      defaultValue: 0,
      ui: { description: 'Display order in the "+" menu' }
    }),
    
    // æ—¶é—´æˆ³
    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
    updatedAt: timestamp({ db: { updatedAt: true } }),
    createdBy: relationship({ ref: 'User' }),
  },
  
  // ğŸ”¥ è®¿é—®æ§åˆ¶ï¼šç³»ç»Ÿå—ä¸å¯åˆ é™¤
  access: {
    operation: {
      delete: ({ session, item }) => {
        // åªæœ‰éç³»ç»Ÿå—å¯ä»¥åˆ é™¤
        return !item.isSystem
      },
    }
  },
  
  hooks: {
    validateInput: async ({ resolvedData, item, addValidationError }) => {
      // é˜²æ­¢ä¿®æ”¹ç³»ç»Ÿå—çš„ isSystem æ ‡å¿—
      if (item?.isSystem && resolvedData.isSystem === false) {
        addValidationError('Cannot change system blocks to non-system')
      }
      
      // éªŒè¯ schema JSON æ ¼å¼
      if (resolvedData.schema) {
        try {
          const schema = JSON.parse(resolvedData.schema)
          // éªŒè¯ schema ç»“æ„...
        } catch (e) {
          addValidationError('Invalid schema JSON format')
        }
      }
    },
    
    // åˆ é™¤å‰æ£€æŸ¥ä½¿ç”¨æƒ…å†µ
    beforeOperation: async ({ operation, item, context }) => {
      if (operation === 'delete') {
        // æ£€æŸ¥æ˜¯å¦æœ‰é¡µé¢æ­£åœ¨ä½¿ç”¨æ­¤ç»„ä»¶å—
        const usage = await checkComponentBlockUsage(item.key, context)
        if (usage.count > 0) {
          throw new Error(
            `Cannot delete: This component block is used in ${usage.count} page(s). ` +
            `Please remove all usages first.`
          )
        }
      }
    }
  },
  
  ui: {
    listView: {
      initialColumns: ['icon', 'name', 'type', 'isSystem', 'status', 'order'],
      initialSort: { field: 'order', direction: 'ASC' },
    }
  }
})
```

---

### Schema å®šä¹‰æ ¼å¼

è¿è¥äººå‘˜åœ¨ `schema` å­—æ®µä¸­å®šä¹‰ç»„ä»¶å—çš„å­—æ®µï¼Œä½¿ç”¨ç®€åŒ–çš„ JSON æ ¼å¼ï¼š

#### ç¤ºä¾‹ 1: ç®€å•çš„å®šä»·è¡¨ç»„ä»¶å—

```json
{
  "fields": [
    {
      "name": "title_en",
      "type": "text",
      "label": "Title (English)",
      "required": true
    },
    {
      "name": "title_zh",
      "type": "text",
      "label": "Title (Chinese)"
    },
    {
      "name": "price",
      "type": "number",
      "label": "Price",
      "required": true
    },
    {
      "name": "currency",
      "type": "select",
      "label": "Currency",
      "options": ["USD", "EUR", "GBP", "CNY"],
      "defaultValue": "USD"
    },
    {
      "name": "features",
      "type": "array",
      "label": "Features",
      "itemType": "text"
    },
    {
      "name": "highlighted",
      "type": "checkbox",
      "label": "Highlight this plan"
    }
  ]
}
```

#### ç¤ºä¾‹ 2: å¸¦å›¾ç‰‡çš„å›¢é˜Ÿæˆå‘˜å¡ç‰‡

```json
{
  "fields": [
    {
      "name": "photo",
      "type": "relationship",
      "label": "Photo",
      "relationship": "Media"
    },
    {
      "name": "name",
      "type": "text",
      "label": "Name",
      "required": true
    },
    {
      "name": "position_en",
      "type": "text",
      "label": "Position (English)"
    },
    {
      "name": "position_zh",
      "type": "text",
      "label": "Position (Chinese)"
    },
    {
      "name": "bio_en",
      "type": "textarea",
      "label": "Bio (English)"
    },
    {
      "name": "bio_zh",
      "type": "textarea",
      "label": "Bio (Chinese)"
    },
    {
      "name": "linkedin",
      "type": "url",
      "label": "LinkedIn URL"
    }
  ]
}
```

---

### æ”¯æŒçš„å­—æ®µç±»å‹

| å­—æ®µç±»å‹ | JSON å®šä¹‰ | å‰ç«¯æ¸²æŸ“ | è¯´æ˜ |
|---------|----------|---------|------|
| **æ–‡æœ¬** | `"type": "text"` | `<input type="text">` | å•è¡Œæ–‡æœ¬ |
| **å¤šè¡Œæ–‡æœ¬** | `"type": "textarea"` | `<textarea>` | é•¿æ–‡æœ¬ |
| **æ•°å­—** | `"type": "number"` | `<input type="number">` | æ•°å€¼ |
| **URL** | `"type": "url"` | `<input type="url">` | ç½‘å€ |
| **Email** | `"type": "email"` | `<input type="email">` | é‚®ç®± |
| **å¤é€‰æ¡†** | `"type": "checkbox"` | `<input type="checkbox">` | å¸ƒå°”å€¼ |
| **ä¸‹æ‹‰é€‰æ‹©** | `"type": "select"` | `<select>` | å•é€‰ |
| **å¤šé€‰** | `"type": "multiselect"` | `<select multiple>` | å¤šé€‰ |
| **æ—¥æœŸ** | `"type": "date"` | `<input type="date">` | æ—¥æœŸ |
| **é¢œè‰²** | `"type": "color"` | `<input type="color">` | é¢œè‰²é€‰æ‹©å™¨ |
| **åª’ä½“** | `"type": "relationship"` + `"relationship": "Media"` | åª’ä½“é€‰æ‹©å™¨ | å…³è” Media è¡¨ |
| **æ•°ç»„** | `"type": "array"` + `"itemType"` | å¯é‡å¤å­—æ®µç»„ | åˆ—è¡¨ |
| **å¯¹è±¡** | `"type": "object"` + `"fields"` | åµŒå¥—å­—æ®µç»„ | åµŒå¥—ç»“æ„ |

---

### CMS åå°ç•Œé¢è®¾è®¡

#### 1. ç»„ä»¶å—åˆ—è¡¨é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component Blocks                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [+ Create Component Block]          [Filter: All â–¼]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ”’ System Template Blocks (8)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“· Single Image                    [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ–¼ï¸  Image Gallery                  [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ“ Left Image Right Text           [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ¬ Video Embed                     [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ”˜ CTA Button                      [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ’¬ Testimonial                     [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ“Š Data Table                      [View Schema]      â”‚  â”‚
â”‚  â”‚ âš ï¸  Alert Box                      [View Schema]      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  ğŸ”’ Reusable & Database Reference Blocks (3)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”— Reusable Block                  [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ“¦ Product Reference               [View Schema]      â”‚  â”‚
â”‚  â”‚ ğŸ“ Blog Post Reference             [View Schema]      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  âœï¸ Custom Template Blocks (2)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ’° Pricing Table                   [Edit] [Delete]    â”‚  â”‚
â”‚  â”‚ ğŸ‘¤ Team Member Card                [Edit] [Delete]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 2. åˆ›å»º/ç¼–è¾‘ç»„ä»¶å—ç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Component Block                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Basic Information                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Key *           [pricing-table            ]    â”‚ â”‚
â”‚  â”‚ Name *          [ğŸ’° Pricing Table          ]    â”‚ â”‚
â”‚  â”‚ Icon            [ğŸ’°] (Emoji picker)            â”‚ â”‚
â”‚  â”‚ Description     [A customizable pricing...]    â”‚ â”‚
â”‚  â”‚ Type *          [ğŸ“¦ Template Block â–¼]          â”‚ â”‚
â”‚  â”‚ Category        [Data Display â–¼]               â”‚ â”‚
â”‚  â”‚ Status          [âšª Active â–¼]                   â”‚ â”‚
â”‚  â”‚ Order           [10]                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  Field Schema                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [+ Add Field]                                  â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ â”Œâ”€ Field 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚ â”‚ Name:        [title_en]                â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Type:        [Text â–¼]                  â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Label:       [Title (English)]         â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Required:    [âœ“]                       â”‚    â”‚ â”‚
â”‚  â”‚ â”‚              [â–²] [â–¼] [ğŸ—‘ï¸]              â”‚    â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ â”Œâ”€ Field 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚ â”‚ Name:        [price]                   â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Type:        [Number â–¼]                â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Label:       [Price]                   â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Required:    [âœ“]                       â”‚    â”‚ â”‚
â”‚  â”‚ â”‚              [â–²] [â–¼] [ğŸ—‘ï¸]              â”‚    â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ â”Œâ”€ Field 3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚ â”‚ Name:        [features]                â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Type:        [Array â–¼]                 â”‚    â”‚ â”‚
â”‚  â”‚ â”‚   Item Type: [Text â–¼]                  â”‚    â”‚ â”‚
â”‚  â”‚ â”‚ Label:       [Features]                â”‚    â”‚ â”‚
â”‚  â”‚ â”‚              [â–²] [â–¼] [ğŸ—‘ï¸]              â”‚    â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  Preview Template (Optional, Advanced)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Use Default Preview]  [Custom React Code]     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  [Cancel]  [Save as Draft]  [Save & Publish]        â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æŠ€æœ¯å®ç°æ–¹æ¡ˆ

#### æ–¹æ¡ˆ 1: è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ï¼ˆæ¨èï¼‰

```typescript
// keystone/dynamic-component-blocks.ts
import { component, fields } from '@keystone-6/core/component-blocks'

export async function loadDynamicComponentBlocks(context) {
  // ä»æ•°æ®åº“åŠ è½½æ‰€æœ‰ ACTIVE çŠ¶æ€çš„ç»„ä»¶å—å®šä¹‰
  const definitions = await context.query.ComponentBlockDefinition.findMany({
    where: { status: { equals: 'ACTIVE' } },
    orderBy: { order: 'asc' }
  })
  
  const dynamicBlocks = {}
  
  for (const def of definitions) {
    const schema = JSON.parse(def.schema)
    
    // å°† JSON schema è½¬æ¢ä¸º Keystone fields
    const keystoneFields = convertJSONSchemaToKeystoneFields(schema)
    
    dynamicBlocks[def.key] = component({
      label: `${def.icon} ${def.name}`,
      schema: keystoneFields,
      preview: createDefaultPreview(def, keystoneFields)
    })
  }
  
  return dynamicBlocks
}

function convertJSONSchemaToKeystoneFields(schema) {
  const keystoneFields = {}
  
  for (const field of schema.fields) {
    switch (field.type) {
      case 'text':
        keystoneFields[field.name] = fields.text({
          label: field.label,
          validation: field.required ? { isRequired: true } : undefined
        })
        break
      
      case 'number':
        keystoneFields[field.name] = fields.integer({
          label: field.label,
          validation: field.required ? { isRequired: true } : undefined
        })
        break
      
      case 'select':
        keystoneFields[field.name] = fields.select({
          label: field.label,
          options: field.options.map(opt => ({ label: opt, value: opt })),
          defaultValue: field.defaultValue
        })
        break
      
      case 'relationship':
        keystoneFields[field.name] = fields.relationship({
          label: field.label,
          relationship: field.relationship
        })
        break
      
      case 'array':
        keystoneFields[field.name] = fields.array(
          convertSingleField({ ...field, type: field.itemType })
        )
        break
      
      // ... å…¶ä»–ç±»å‹
    }
  }
  
  return keystoneFields
}

function createDefaultPreview(definition, fields) {
  return (props) => {
    return (
      <div style={{ 
        border: '1px solid #ddd', 
        borderRadius: '8px', 
        padding: '16px',
        backgroundColor: '#f9f9f9'
      }}>
        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
          <span style={{ fontSize: '24px' }}>{definition.icon}</span>
          <strong>{definition.name}</strong>
        </div>
        <div style={{ fontSize: '14px', color: '#666' }}>
          {Object.keys(fields).map(key => (
            <div key={key} style={{ marginBottom: '4px' }}>
              <strong>{fields[key].label}:</strong> {String(props.fields[key].value) || '(empty)'}
            </div>
          ))}
        </div>
      </div>
    )
  }
}
```

---

#### æ–¹æ¡ˆ 2: æ„å»ºæ—¶ç”Ÿæˆï¼ˆæ€§èƒ½æ›´å¥½ï¼Œä½†éœ€é‡å¯ï¼‰

```typescript
// scripts/generate-component-blocks.ts
// åœ¨ Keystone å¯åŠ¨å‰è¿è¡Œï¼Œå°†æ•°æ®åº“ä¸­çš„å®šä¹‰ç”Ÿæˆä¸ºä»£ç æ–‡ä»¶

import { generateComponentBlocksCode } from './generators'

async function main() {
  const definitions = await fetchComponentBlockDefinitions()
  const code = generateComponentBlocksCode(definitions)
  
  // å†™å…¥åˆ° keystone/component-blocks/generated.ts
  await fs.writeFile('./keystone/component-blocks/generated.ts', code)
  
  console.log('âœ… Component blocks generated')
}
```

**ä¼˜ç¼ºç‚¹å¯¹æ¯”**ï¼š

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| **è¿è¡Œæ—¶åŠ è½½** | å³æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯ | æ€§èƒ½ç•¥ä½ |
| **æ„å»ºæ—¶ç”Ÿæˆ** | æ€§èƒ½æœ€ä¼˜ï¼Œä»£ç å¯è¿½è¸ª | éœ€è¦é‡å¯ Keystone |

**æ¨è**ï¼šV1 ä½¿ç”¨**è¿è¡Œæ—¶åŠ è½½**ï¼ŒåæœŸä¼˜åŒ–å¯æ”¹ä¸º**æ„å»ºæ—¶ç”Ÿæˆ**ã€‚

---

### ä½¿ç”¨æµç¨‹ç¤ºä¾‹

#### è¿è¥äººå‘˜åˆ›å»º"å®šä»·è¡¨"ç»„ä»¶å—

1. **è¿›å…¥ CMS** â†’ **Component Blocks** é¡µé¢
2. ç‚¹å‡» **[+ Create Component Block]**
3. å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼š
   - Key: `pricing-table`
   - Name: `ğŸ’° Pricing Table`
   - Icon: `ğŸ’°`
   - Type: `Template Block`
4. æ·»åŠ å­—æ®µï¼š
   - `title_en` (Text, Required)
   - `title_zh` (Text)
   - `price` (Number, Required)
   - `currency` (Select: USD/EUR/GBP/CNY)
   - `features` (Array of Text)
   - `highlighted` (Checkbox)
5. ç‚¹å‡» **[Save & Publish]**
6. âœ… ç»„ä»¶å—ç«‹å³å‡ºç°åœ¨ Document Field ç¼–è¾‘å™¨çš„ **"+" æŒ‰é’®**èœå•ä¸­

#### åœ¨äº§å“è¯¦æƒ…é¡µä½¿ç”¨æ–°ç»„ä»¶

1. è¿›å…¥ **Product Series** â†’ **Glass Standoff**
2. åœ¨ `contentBody` ç¼–è¾‘å™¨ä¸­ç‚¹å‡» **"+"**
3. çœ‹åˆ°æ–°çš„ **"ğŸ’° Pricing Table"** é€‰é¡¹
4. é€‰æ‹©å¹¶é…ç½®ï¼š
   - Title: "Standard Plan"
   - Price: 299
   - Currency: USD
   - Features: ["Feature 1", "Feature 2", "Feature 3"]
5. ä¿å­˜é¡µé¢
6. âœ… å‰ç«¯è‡ªåŠ¨æ¸²æŸ“å®šä»·è¡¨

---

### åˆå§‹ç³»ç»Ÿç»„ä»¶å—å®šä¹‰

åœ¨ Keystone seed æ•°æ®ä¸­é¢„å®šä¹‰æ‰€æœ‰ç³»ç»Ÿç»„ä»¶å—ï¼š

```typescript
// keystone/seed-data/component-blocks.ts
export const systemComponentBlocks = [
  {
    key: 'single-image',
    name: 'Single Image',
    icon: 'ğŸ“·',
    type: 'TEMPLATE',
    isSystem: true, // ğŸ”’ ä¸å¯åˆ é™¤
    schema: JSON.stringify({
      fields: [
        { name: 'image', type: 'relationship', relationship: 'Media', required: true },
        { name: 'caption_en', type: 'text', label: 'Caption (English)' },
        { name: 'caption_zh', type: 'text', label: 'Caption (Chinese)' },
        // ... 24+ è¯­è¨€
      ]
    }),
    status: 'ACTIVE',
    order: 1
  },
  
  {
    key: 'image-gallery',
    name: 'Image Gallery',
    icon: 'ğŸ–¼ï¸',
    type: 'TEMPLATE',
    isSystem: true,
    schema: JSON.stringify({
      fields: [
        { name: 'images', type: 'array', itemType: { type: 'relationship', relationship: 'Media' } },
        { name: 'layout', type: 'select', options: ['grid-2', 'grid-3', 'grid-4', 'carousel'] },
      ]
    }),
    status: 'ACTIVE',
    order: 2
  },
  
  // ... å…¶ä»– 6 ä¸ªç³»ç»Ÿæ¨¡æ¿ç»„ä»¶å—
  
  {
    key: 'reusable-block',
    name: 'Reusable Block',
    icon: 'ğŸ”—',
    type: 'REUSABLE',
    isSystem: true, // ğŸ”’ ä¸å¯åˆ é™¤
    schema: JSON.stringify({
      fields: [
        { name: 'block', type: 'relationship', relationship: 'ReusableBlock', required: true }
      ]
    }),
    status: 'ACTIVE',
    order: 100
  },
  
  {
    key: 'product-reference',
    name: 'Product Reference',
    icon: 'ğŸ“¦',
    type: 'DATABASE_REF',
    isSystem: true, // ğŸ”’ ä¸å¯åˆ é™¤
    schema: JSON.stringify({
      fields: [
        { name: 'product', type: 'relationship', relationship: 'Product', required: true },
        { name: 'displayStyle', type: 'select', options: ['card', 'inline'] },
      ]
    }),
    status: 'ACTIVE',
    order: 101
  },
]
```

---

### å®‰å…¨ä¸é™åˆ¶

#### 1. åˆ é™¤ä¿æŠ¤

```typescript
hooks: {
  beforeOperation: async ({ operation, item, context }) => {
    if (operation === 'delete') {
      // æ£€æŸ¥ä½¿ç”¨æƒ…å†µ
      const usage = await findPagesUsingComponentBlock(item.key, context)
      
      if (usage.length > 0) {
        throw new Error(
          `Cannot delete: This component block is used in ${usage.length} page(s):\n` +
          usage.map(p => `- ${p.title}`).join('\n') +
          '\n\nPlease remove all usages first.'
        )
      }
    }
  }
}
```

#### 2. Key å‘½åè§„èŒƒéªŒè¯

```typescript
hooks: {
  validateInput: ({ resolvedData, addValidationError }) => {
    const key = resolvedData.key
    if (key) {
      // åªå…è®¸å°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦
      if (!/^[a-z0-9-]+$/.test(key)) {
        addValidationError('Key must contain only lowercase letters, numbers, and hyphens')
      }
      
      // ç¦æ­¢ç³»ç»Ÿä¿ç•™å‰ç¼€
      if (key.startsWith('system-') || key.startsWith('keystone-')) {
        addValidationError('Keys cannot start with "system-" or "keystone-"')
      }
    }
  }
}
```

#### 3. Schema å¤æ‚åº¦é™åˆ¶

```typescript
// é™åˆ¶å­—æ®µæ•°é‡å’ŒåµŒå¥—æ·±åº¦ï¼Œé˜²æ­¢æ€§èƒ½é—®é¢˜
const MAX_FIELDS = 20
const MAX_NESTING_DEPTH = 3

function validateSchema(schema, depth = 0) {
  if (depth > MAX_NESTING_DEPTH) {
    throw new Error('Schema nesting too deep')
  }
  
  if (schema.fields.length > MAX_FIELDS) {
    throw new Error(`Too many fields (max ${MAX_FIELDS})`)
  }
  
  // é€’å½’éªŒè¯åµŒå¥—å­—æ®µ
  for (const field of schema.fields) {
    if (field.type === 'object' && field.fields) {
      validateSchema({ fields: field.fields }, depth + 1)
    }
  }
}
```

---

## ğŸ§© ç»„ä»¶å—ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¦‚å¿µ

åœ¨ Keystone Document Field ä¸­ï¼Œ**æ‰€æœ‰å¤æ‚çš„å†…å®¹ç»“æ„**éƒ½é€šè¿‡ **"+" æŒ‰é’®**æ’å…¥çš„**ç»„ä»¶å— (Component Blocks)** æ¥å®ç°ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document Field ç¼–è¾‘å™¨                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥å…·æ ï¼š                                            â”‚
â”‚  [B] [I] [U] ... (åŸºç¡€æ ¼å¼åŒ–)                       â”‚
â”‚  [Layouts] (å¤šåˆ—å¸ƒå±€)                                â”‚
â”‚  [+] â† è¿™é‡Œæ˜¯ç»„ä»¶å—çš„å…¥å£ï¼                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  ç‚¹å‡» "+" æŒ‰é’®åï¼Œå¼¹å‡ºç»„ä»¶åº“ï¼š                        â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ğŸ“¦ æ¨¡æ¿ç»„ä»¶å— (Template Blocks)     â”‚            â”‚
â”‚  â”‚  â”œâ”€ å•å¼ å›¾ç‰‡                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ å›¾ç‰‡ç”»å»Š                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ å·¦å›¾å³æ–‡ / å³å›¾å·¦æ–‡               â”‚            â”‚
â”‚  â”‚  â”œâ”€ è§†é¢‘åµŒå…¥                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ CTA æŒ‰é’®                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ å¼•ç”¨/è¯„ä»·                        â”‚            â”‚
â”‚  â”‚  â”œâ”€ æ•°æ®è¡¨æ ¼                         â”‚            â”‚
â”‚  â”‚  â””â”€ è­¦å‘Š/æç¤ºæ¡†                      â”‚            â”‚
â”‚  â”‚                                      â”‚            â”‚
â”‚  â”‚  ğŸ”— å¤ç”¨ç»„ä»¶å— (Reusable Blocks)     â”‚            â”‚
â”‚  â”‚  â”œâ”€ å…¨å±€é¡µè„š                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ ç»Ÿä¸€è¯¢ä»·è¡¨å•                     â”‚            â”‚
â”‚  â”‚  â”œâ”€ äº§å“å¯¹æ¯”è¡¨                       â”‚            â”‚
â”‚  â”‚  â””â”€ è‡ªå®šä¹‰å¤ç”¨å—...                  â”‚            â”‚
â”‚  â”‚                                      â”‚            â”‚
â”‚  â”‚  ğŸ”— æ•°æ®åº“å¼•ç”¨ç»„ä»¶                    â”‚            â”‚
â”‚  â”‚  â”œâ”€ äº§å“å¼•ç”¨                         â”‚            â”‚
â”‚  â”‚  â”œâ”€ åšå®¢æ–‡ç« å¼•ç”¨                     â”‚            â”‚
â”‚  â”‚  â””â”€ æ¡ˆä¾‹å¼•ç”¨                         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ä¸¤ç§ç»„ä»¶å—ç±»å‹å¯¹æ¯”

| ç‰¹æ€§ | **ğŸ“¦ æ¨¡æ¿ç»„ä»¶å—** | **ğŸ”— å¤ç”¨ç»„ä»¶å—** |
|------|------------------|------------------|
| **è‹±æ–‡å** | Template Blocks | Reusable Blocks |
| **æ’å…¥æ–¹å¼** | ç‚¹å‡» "+" æŒ‰é’®é€‰æ‹© | ç‚¹å‡» "+" æŒ‰é’®é€‰æ‹© |
| **å­˜å‚¨æ–¹å¼** | æ•°æ®**ç›´æ¥åµŒå…¥**å½“å‰æ–‡æ¡£çš„ JSON ä¸­ | å­˜å‚¨ä¸€ä¸ª**å¼•ç”¨ ID**ï¼Œå®é™…å†…å®¹åœ¨ `ReusableBlock` è¡¨ |
| **ä¿®æ”¹å½±å“èŒƒå›´** | åªå½±å“**å½“å‰é¡µé¢** | å½±å“**æ‰€æœ‰**å¼•ç”¨äº†å®ƒçš„é¡µé¢ |
| **å…¸å‹ç”¨é€”** | é¡µé¢ç‰¹æœ‰çš„å†…å®¹ï¼ˆå¦‚äº§å“è¯¦æƒ…é¡µçš„è§„æ ¼è¡¨ï¼‰ | è·¨é¡µé¢å…±äº«çš„å†…å®¹ï¼ˆå¦‚å…¨å±€é¡µè„šã€ç»Ÿä¸€è¡¨å•ï¼‰ |
| **ç±»æ¯”** | ğŸ–¨ï¸ å¤å° (å›¾ç« å¼å¤åˆ») | ğŸ”— å¿«æ·æ–¹å¼ (å…¨å±€é“¾æ¥) |

---

### å®ç°åŸç†

#### æ¨¡æ¿ç»„ä»¶å— (Template Blocks)

**æ•°æ®å­˜å‚¨ç¤ºä¾‹**ï¼š

```json
// ProductSeries.contentBody (å­˜å‚¨åœ¨æ•°æ®åº“ä¸­)
{
  "type": "component-block",
  "component": "imageGallery",
  "props": {
    "images": [
      { "id": "media_123", "url": "...", "altText": "..." },
      { "id": "media_456", "url": "...", "altText": "..." }
    ],
    "layout": "grid-3",
    "showCaptions": true
  }
}
```

**ç‰¹ç‚¹**ï¼š
- æ•°æ®**å®Œæ•´åœ°**å­˜å‚¨åœ¨å½“å‰æ–‡æ¡£ä¸­
- ä¿®æ”¹æ­¤ç»„ä»¶**ä¸ä¼š**å½±å“å…¶ä»–é¡µé¢
- å¦‚æœå›¾ç‰‡ `media_123` åœ¨æ•°æ®åº“ä¸­è¢«åˆ é™¤ï¼Œå‰ç«¯éœ€è¦å¤„ç†**æ–­é“¾**

---

#### å¤ç”¨ç»„ä»¶å— (Reusable Blocks)

**æ•°æ®å­˜å‚¨ç¤ºä¾‹**ï¼š

```json
// ProductSeries.contentBody (åªå­˜å‚¨å¼•ç”¨)
{
  "type": "component-block",
  "component": "reusableBlock",
  "props": {
    "blockId": "reusable_global_footer" // åªå­˜å‚¨ ID
  }
}

// ReusableBlock è¡¨ä¸­çš„å®é™…æ•°æ®
{
  "id": "reusable_global_footer",
  "key": "global-footer",
  "name": "Global Footer",
  "type": "FOOTER",
  "content_en": { /* å®Œæ•´çš„ Document Field JSON */ },
  "content_zh": { /* å®Œæ•´çš„ Document Field JSON */ },
  // ...
}
```

**ç‰¹ç‚¹**ï¼š
- å½“å‰æ–‡æ¡£åªå­˜å‚¨ä¸€ä¸ª **ID å¼•ç”¨**
- å®é™…å†…å®¹å­˜å‚¨åœ¨ `ReusableBlock` è¡¨ä¸­
- ä¿®æ”¹ `ReusableBlock` åï¼Œ**æ‰€æœ‰**å¼•ç”¨å®ƒçš„é¡µé¢ä¼š**è‡ªåŠ¨åŒæ­¥æ›´æ–°**

---

### è¿è¥äººå‘˜ä½¿ç”¨ä½“éªŒ

#### åœºæ™¯ 1: æ’å…¥æ¨¡æ¿ç»„ä»¶å—ï¼ˆå›¾ç‰‡ç”»å»Šï¼‰

1. åœ¨ç¼–è¾‘å™¨ä¸­ç‚¹å‡» **"+" æŒ‰é’®**
2. ä»å¼¹å‡ºèœå•é€‰æ‹© **"ğŸ“¦ Image Gallery"**
3. åœ¨é…ç½®é¢æ¿ä¸­ï¼š
   - é€‰æ‹© 3 å¼ å›¾ç‰‡
   - é€‰æ‹©å¸ƒå±€ï¼šGrid (3 columns)
   - å‹¾é€‰"æ˜¾ç¤ºå›¾ç‰‡è¯´æ˜"
4. ç‚¹å‡»"æ’å…¥"
5. âœ… å›¾ç‰‡ç”»å»Šå‡ºç°åœ¨ç¼–è¾‘å™¨ä¸­

**å¦‚æœä¿®æ”¹**ï¼š
- åªèƒ½åœ¨**å½“å‰é¡µé¢**é‡æ–°æ‰“å¼€æ­¤ç»„ä»¶è¿›è¡Œç¼–è¾‘
- ä¿®æ”¹**ä¸ä¼š**å½±å“å…¶ä»–é¡µé¢çš„å›¾ç‰‡ç”»å»Š

---

#### åœºæ™¯ 2: æ’å…¥å¤ç”¨ç»„ä»¶å—ï¼ˆå…¨å±€é¡µè„šï¼‰

1. åœ¨ç¼–è¾‘å™¨ä¸­ç‚¹å‡» **"+" æŒ‰é’®**
2. ä»å¼¹å‡ºèœå•é€‰æ‹© **"ğŸ”— Reusable Block"**
3. ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹© **"Global Footer"**
4. ç‚¹å‡»"æ’å…¥"
5. âœ… å…¨å±€é¡µè„šçš„é¢„è§ˆå‡ºç°åœ¨ç¼–è¾‘å™¨ä¸­

**å¦‚æœä¿®æ”¹**ï¼š
- éœ€è¦å» **CMS çš„ "Reusable Blocks" ç®¡ç†é¡µé¢**
- æ‰¾åˆ° "Global Footer" æ¡ç›®å¹¶ç¼–è¾‘
- ä¿å­˜åï¼Œ**æ‰€æœ‰**å¼•ç”¨äº†å®ƒçš„é¡µé¢ä¼š**è‡ªåŠ¨æ›´æ–°**

---

### Keystone é…ç½®å®ç°

#### componentBlocks å®šä¹‰ï¼ˆæ‰€æœ‰ç»„ä»¶éƒ½åœ¨è¿™é‡Œï¼‰

```typescript
// keystone/component-blocks/index.ts
import { component, fields } from '@keystone-6/core/component-blocks'

export const componentBlocks = {
  // ============================================
  // ğŸ“¦ æ¨¡æ¿ç»„ä»¶å— (Template Blocks)
  // ============================================
  
  singleImage: component({
    label: 'ğŸ“· Single Image',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  imageGallery: component({
    label: 'ğŸ–¼ï¸ Image Gallery',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  leftImageRightText: component({
    label: 'ğŸ“ Left Image Right Text',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  videoEmbed: component({
    label: 'ğŸ¬ Video Embed',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  ctaButton: component({
    label: 'ğŸ”˜ CTA Button',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  testimonial: component({
    label: 'ğŸ’¬ Testimonial',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  dataTable: component({
    label: 'ğŸ“Š Data Table',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  alertBox: component({
    label: 'âš ï¸ Alert Box',
    schema: { /* ... */ },
    preview: (props) => { /* ... */ }
  }),
  
  // ============================================
  // ğŸ”— å¤ç”¨ç»„ä»¶å— (Reusable Blocks)
  // ============================================
  
  reusableBlock: component({
    label: 'ğŸ”— Reusable Block',
    schema: {
      block: fields.relationship({ 
        label: 'Select Reusable Block', 
        relationship: 'ReusableBlock',
        selection: 'id key name type'
      }),
    },
    preview: (props) => {
      const block = props.fields.block.value?.data
      if (!block) {
        return (
          <div style={{ 
            border: '2px dashed #ccc', 
            padding: '20px', 
            borderRadius: '8px',
            textAlign: 'center',
            color: '#999'
          }}>
            Select a reusable block...
          </div>
        )
      }
      
      return (
        <div style={{ 
          border: '2px solid #007bff', 
          padding: '20px', 
          borderRadius: '8px',
          backgroundColor: '#f0f8ff'
        }}>
          <div style={{ 
            display: 'flex', 
            alignItems: 'center', 
            gap: '8px',
            marginBottom: '8px'
          }}>
            <span style={{ fontSize: '24px' }}>ğŸ”—</span>
            <strong style={{ color: '#007bff' }}>{block.name}</strong>
          </div>
          <p style={{ 
            margin: 0, 
            fontSize: '14px', 
            color: '#666' 
          }}>
            This is a globally managed block. Changes will affect all pages using it.
          </p>
          <p style={{ 
            margin: '8px 0 0', 
            fontSize: '12px', 
            color: '#999' 
          }}>
            Key: <code>{block.key}</code> | Type: {block.type}
          </p>
        </div>
      )
    }
  }),
  
  // ============================================
  // ğŸ”— æ•°æ®åº“å¼•ç”¨ç»„ä»¶
  // ============================================
  
  productReference: component({
    label: 'ğŸ“¦ Product Reference',
    schema: {
      product: fields.relationship({ 
        label: 'Select Product', 
        relationship: 'Product',
        selection: 'id sku name_en mainImage { url altText_en }'
      }),
      displayStyle: fields.select({
        label: 'Display Style',
        options: [
          { label: 'Card', value: 'card' },
          { label: 'Inline', value: 'inline' },
        ],
        defaultValue: 'card'
      }),
    },
    preview: (props) => {
      const product = props.fields.product.value?.data
      if (!product) return <div>Select a product...</div>
      
      return (
        <div style={{ border: '1px solid #ddd', padding: '16px', borderRadius: '8px' }}>
          <strong>{product.name_en}</strong>
          <p>SKU: {product.sku}</p>
        </div>
      )
    }
  }),
  
  blogPostReference: component({
    label: 'ğŸ“ Blog Post Reference',
    schema: {
      post: fields.relationship({ 
        label: 'Select Blog Post', 
        relationship: 'Blog',
        selection: 'id slug title_en excerpt_en'
      }),
    },
    preview: (props) => { /* ... */ }
  }),
}
```

---

### CMS åå°ç®¡ç†

#### å¤ç”¨ç»„ä»¶å—ç®¡ç†ç•Œé¢

è¿è¥äººå‘˜å¯ä»¥åœ¨ CMS ä¸­çœ‹åˆ°ä¸€ä¸ªä¸“é—¨çš„ç®¡ç†é¡µé¢ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reusable Blocks                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [+ Create Reusable Block]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  ğŸ“„ Global Footer                                â”‚
â”‚     Key: global-footer  |  Type: FOOTER          â”‚
â”‚     [Edit] [View Usage]                          â”‚
â”‚                                                  â”‚
â”‚  ğŸ“ Standard Inquiry Form                        â”‚
â”‚     Key: inquiry-form  |  Type: CONTACT_FORM     â”‚
â”‚     [Edit] [View Usage]                          â”‚
â”‚                                                  â”‚
â”‚  ğŸ“Š Product Comparison Table                     â”‚
â”‚     Key: product-comparison  |  Type: CUSTOM     â”‚
â”‚     [Edit] [View Usage]                          â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**"View Usage" åŠŸèƒ½**ï¼ˆå¯é€‰ï¼Œä½†æ¨èå®ç°ï¼‰ï¼š

ç‚¹å‡»åæ˜¾ç¤º**å“ªäº›é¡µé¢æ­£åœ¨ä½¿ç”¨æ­¤å¤ç”¨å—**ï¼Œé¿å…è¯¯åˆ æˆ–è¯¯æ”¹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Usage of "Global Footer"                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  This block is used in:                  â”‚
â”‚                                          â”‚
â”‚  â€¢ Product: Glass Standoff               â”‚
â”‚  â€¢ Product: Glass Clip                   â”‚
â”‚  â€¢ Product: Glass Hinge                  â”‚
â”‚  â€¢ Blog Post: 2025 Industry Trends       â”‚
â”‚  â€¢ Page: About Us > Our Story            â”‚
â”‚                                          â”‚
â”‚  Total: 5 pages                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æœ€ä½³å®è·µå»ºè®®

#### 1. ä»€ä¹ˆæ—¶å€™ç”¨æ¨¡æ¿ç»„ä»¶å—ï¼Ÿ

âœ… **é€‚åˆåœºæ™¯**ï¼š
- é¡µé¢ç‰¹æœ‰çš„å†…å®¹ï¼ˆå¦‚äº§å“è¯¦æƒ…é¡µçš„æŠ€æœ¯å‚æ•°è¡¨ï¼‰
- éœ€è¦ä¸ªæ€§åŒ–å®šåˆ¶çš„ç»„ä»¶
- ä¸€æ¬¡æ€§ä½¿ç”¨çš„å†…å®¹

âŒ **ä¸é€‚åˆåœºæ™¯**ï¼š
- éœ€è¦è·¨é¡µé¢ä¿æŒä¸€è‡´çš„å†…å®¹ï¼ˆç”¨å¤ç”¨ç»„ä»¶å—ï¼‰

---

#### 2. ä»€ä¹ˆæ—¶å€™ç”¨å¤ç”¨ç»„ä»¶å—ï¼Ÿ

âœ… **é€‚åˆåœºæ™¯**ï¼š
- å…¨å±€é¡µè„š/é¡µçœ‰
- ç»Ÿä¸€æ ·å¼çš„è¡¨å•ï¼ˆè”ç³»è¡¨å•ã€è¯¢ä»·è¡¨å•ï¼‰
- æ³•å¾‹å£°æ˜ã€å…è´£æ¡æ¬¾
- ç¤¾äº¤åª’ä½“é“¾æ¥åŒºåŸŸ
- ç»Ÿä¸€çš„ CTA åŒºå—

âŒ **ä¸é€‚åˆåœºæ™¯**ï¼š
- éœ€è¦åœ¨ä¸åŒé¡µé¢æœ‰ä¸åŒå†…å®¹çš„ç»„ä»¶

---

#### 3. å‘½åè§„èŒƒ

**å¤ç”¨ç»„ä»¶å—çš„ Key å‘½å**ï¼š
- `global-footer` âœ…
- `inquiry-form-standard` âœ…
- `social-media-links` âœ…
- `footer1` âŒï¼ˆä¸æ¸…æ™°ï¼‰
- `temp` âŒï¼ˆæ— æ„ä¹‰ï¼‰

---

## ğŸ§© åŠ¨æ€å†…å®¹åŒº (Document Field) å®Œæ•´é…ç½®

**Document Field** æ˜¯ Keystone 6 æä¾›çš„å¼ºå¤§å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒï¼š

1. **å¯Œæ–‡æœ¬æ ¼å¼åŒ–** (ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€åˆ é™¤çº¿ç­‰)
2. **æ ‡é¢˜å±‚çº§** (H1-H6)
3. **åˆ—è¡¨** (æœ‰åºã€æ— åº)
4. **é“¾æ¥** (å†…éƒ¨ã€å¤–éƒ¨)
5. **ä»£ç å—** (å¸¦è¯­æ³•é«˜äº®)
6. **å¼•ç”¨å—**
7. **åˆ†éš”çº¿**
8. **å¤šåˆ—å¸ƒå±€** (1/2ã€1/3ã€1/1/1 ç­‰)
9. **è‡ªå®šä¹‰ç»„ä»¶å—** (Component Blocks)

**å‚è€ƒæ–‡æ¡£**: https://keystonejs.com/docs/guides/document-field-demo

---

### Document Field é…ç½®ç¤ºä¾‹

```typescript
// keystone/schemas/ProductSeries.ts (å®Œæ•´é…ç½®)
import { list } from '@keystone-6/core'
import { document } from '@keystone-6/fields-document'
import { componentBlocks } from '../component-blocks'

export const ProductSeries = list({
  fields: {
    // ... å…¶ä»–å­—æ®µ
    
    contentBody: document({
      // ğŸ”¥ å¯Œæ–‡æœ¬æ ¼å¼åŒ–
      formatting: {
        inlineMarks: {
          bold: true,
          italic: true,
          underline: true,
          strikethrough: true,
          code: true,
          superscript: true,
          subscript: true,
          keyboard: true,
        },
        listTypes: {
          ordered: true,
          unordered: true,
        },
        alignment: {
          center: true,    // å±…ä¸­å¯¹é½
          end: true,       // å³å¯¹é½ (é å³)
        },
        // æ³¨æ„ï¼šå·¦å¯¹é½æ˜¯é»˜è®¤çš„ï¼Œä¸éœ€è¦é…ç½®
        // Keystone ä¼šè‡ªåŠ¨æä¾› "left", "center", "right" ä¸‰ç§å¯¹é½æ–¹å¼
        headingLevels: [1, 2, 3, 4, 5, 6],
        blockTypes: {
          blockquote: true,
          code: true,
        },
        softBreaks: true,
      },
      
      // ğŸ”¥ é“¾æ¥
      links: true,
      
      // ğŸ”¥ åˆ†éš”çº¿
      dividers: true,
      
      // ğŸ”¥ å¤šåˆ—å¸ƒå±€ (Keystone å®˜æ–¹æä¾›çš„ 5 ç§å¸ƒå±€)
      layouts: [
        [1, 1],           // ä¸¤åˆ—ç­‰å®½ (50% / 50%)
        [1, 1, 1],        // ä¸‰åˆ—ç­‰å®½ (33% / 33% / 33%)
        [1, 1, 1, 1],     // å››åˆ—ç­‰å®½ (25% / 25% / 25% / 25%)
        [1, 2],           // å·¦çª„å³å®½ (33% / 66%)
        [2, 1],           // å·¦å®½å³çª„ (66% / 33%)
      ],
      
      // ğŸ”¥ å…³ç³»å¼•ç”¨ (å¯åœ¨æ–‡æ¡£ä¸­æ’å…¥é“¾æ¥åˆ°å…¶ä»–å†…å®¹)
      relationships: {
        product: {
          listKey: 'Product',
          label: 'Product',
          selection: 'id sku name_en',
        },
        blog: {
          listKey: 'Blog',
          label: 'Blog Post',
          selection: 'id slug title_en',
        },
      },
      
      // ğŸ”¥ è‡ªå®šä¹‰ç»„ä»¶å—
      componentBlocks,
      
      ui: {
        description: 'æ‹–æ‹½ç»„ä»¶å—æˆ–ä½¿ç”¨ "/" å‘½ä»¤å¿«é€Ÿæ’å…¥å†…å®¹'
      }
    }),
  }
})
```

---

### ç¼–è¾‘å™¨åŠŸèƒ½æ¸…å•

#### 1. åŸºç¡€æ ¼å¼åŒ–

| åŠŸèƒ½ | å¿«æ·é”® | è¯´æ˜ |
|------|--------|------|
| **ç²—ä½“** | `Ctrl/Cmd + B` | **Bold text** |
| **æ–œä½“** | `Ctrl/Cmd + I` | *Italic text* |
| **ä¸‹åˆ’çº¿** | `Ctrl/Cmd + U` | <u>Underlined text</u> |
| **åˆ é™¤çº¿** | `Ctrl/Cmd + Shift + X` | ~~Strikethrough~~ |
| **è¡Œå†…ä»£ç ** | `` Ctrl/Cmd + ` `` | `inline code` |
| **ä¸Šæ ‡** | - | X<sup>2</sup> |
| **ä¸‹æ ‡** | - | H<sub>2</sub>O |
| **é”®ç›˜** | - | <kbd>Ctrl</kbd> + <kbd>C</kbd> |

#### 2. æ ‡é¢˜å±‚çº§

```markdown
# Heading 1
## Heading 2
### Heading 3
#### Heading 4
##### Heading 5
###### Heading 6
```

å¿«æ·é”®ï¼š`Ctrl/Cmd + Alt + 1-6`

#### 3. åˆ—è¡¨

```markdown
- Unordered list item 1
- Unordered list item 2
  - Nested item

1. Ordered list item 1
2. Ordered list item 2
   1. Nested item
```

å¿«æ·é”®ï¼š
- æ— åºåˆ—è¡¨ï¼š`Ctrl/Cmd + Shift + 8`
- æœ‰åºåˆ—è¡¨ï¼š`Ctrl/Cmd + Shift + 7`

#### 4. å¼•ç”¨å—

```markdown
> This is a blockquote
> It can span multiple lines
```

#### 5. ä»£ç å—

````markdown
```javascript
function hello() {
  console.log('Hello, world!')
}
```
````

æ”¯æŒè¯­æ³•é«˜äº®çš„è¯­è¨€ï¼š
- JavaScript, TypeScript
- Python, Ruby, PHP
- HTML, CSS, SCSS
- JSON, YAML
- Markdown
- SQL
- Bash/Shell

#### 6. é“¾æ¥

```markdown
[Link text](https://example.com)
```

å¿«æ·é”®ï¼š`Ctrl/Cmd + K`

**å†…éƒ¨é“¾æ¥**ï¼šå¯ä»¥é“¾æ¥åˆ°å…¶ä»– Keystone å†…å®¹é¡¹ï¼ˆå¦‚äº§å“ã€æ–‡ç« ï¼‰

#### 7. åˆ†éš”çº¿

```markdown
---
```

è§†è§‰ä¸Šæ˜¾ç¤ºä¸ºä¸€æ¡æ°´å¹³çº¿ã€‚

#### 8. å¤šåˆ—å¸ƒå±€

è¿è¥äººå‘˜å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­é€‰æ‹© **5 ç§**å®˜æ–¹æä¾›çš„åˆ—å¸ƒå±€ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Col 1     â”‚    Col 2     â”‚  [1, 1] - ä¸¤åˆ—ç­‰å®½ (50% / 50%)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Col 1  â”‚  Col 2  â”‚  Col 3  â”‚  [1, 1, 1] - ä¸‰åˆ—ç­‰å®½ (33% / 33% / 33%)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ Col1 â”‚ Col2 â”‚ Col3 â”‚ Col4 â”‚  [1, 1, 1, 1] - å››åˆ—ç­‰å®½ (25% / 25% / 25% / 25%)
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Col 1 â”‚      Col 2       â”‚  [1, 2] - å·¦çª„å³å®½ (33% / 66%)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Col 1       â”‚  Col 2 â”‚  [2, 1] - å·¦å®½å³çª„ (66% / 33%)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ¯åˆ—å†…éƒ¨å¯ä»¥ç‹¬ç«‹æ·»åŠ ä»»ä½•å†…å®¹ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ã€ç»„ä»¶å—ï¼‰ã€‚

#### 9. æ–‡æœ¬å¯¹é½

Keystone é»˜è®¤æä¾› **3 ç§æ–‡æœ¬å¯¹é½æ–¹å¼**ï¼š

| å¯¹é½æ–¹å¼ | è¯´æ˜ | å¿«æ·é”® |
|---------|------|--------|
| **å·¦å¯¹é½** | é»˜è®¤å¯¹é½æ–¹å¼ | `Ctrl/Cmd + Shift + L` |
| **å±…ä¸­å¯¹é½** | æ–‡æœ¬å±…ä¸­æ˜¾ç¤º | `Ctrl/Cmd + Shift + E` |
| **å³å¯¹é½** | æ–‡æœ¬é å³æ˜¾ç¤º | `Ctrl/Cmd + Shift + R` |

**æ³¨æ„**ï¼š
- å·¦å¯¹é½æ˜¯é»˜è®¤çš„ï¼Œä¸éœ€è¦åœ¨é…ç½®ä¸­æ˜¾å¼å¯ç”¨
- `alignment.center: true` å¯ç”¨å±…ä¸­å¯¹é½
- `alignment.end: true` å¯ç”¨å³å¯¹é½ï¼ˆåœ¨è‹±æ–‡ä¸­ç§°ä¸º "end" å¯¹é½ï¼‰

---

### ç¼–è¾‘å™¨å·¥å…·æ è¯¦è§£

#### ä¸»å·¥å…·æ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [B] [I] [U] [S] Hâ–¼ [â‰¡] [â€¢] [#] ["] [</>] [|] [ğŸ”—] [â†] [â†’] [â†”] [+] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€ è‡ªå®šä¹‰ç»„ä»¶ (é‡è¦!)
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€ ä¸¤ç«¯å¯¹é½
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€ å³å¯¹é½
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å±…ä¸­å¯¹é½
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å·¦å¯¹é½
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ’å…¥é“¾æ¥
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†éš”çº¿
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä»£ç å—
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¼•ç”¨å—
  â”‚   â”‚   â”‚   â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ‰åºåˆ—è¡¨
  â”‚   â”‚   â”‚   â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ— åºåˆ—è¡¨
  â”‚   â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ ‡é¢˜çº§åˆ«ä¸‹æ‹‰
  â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ é™¤çº¿
  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¸‹åˆ’çº¿
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–œä½“
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç²—ä½“
```

#### **ğŸ”¥ "+" æŒ‰é’® - è‡ªå®šä¹‰ç»„ä»¶ (Custom Components)**

è¿™æ˜¯ Keystone Document Field æœ€å¼ºå¤§çš„åŠŸèƒ½ï¼

å½“è¿è¥äººå‘˜ç‚¹å‡»å·¥å…·æ **æœ€å³ä¾§çš„ "+" æŒ‰é’®**æ—¶ï¼Œä¼šå¼¹å‡º**è‡ªå®šä¹‰ç»„ä»¶åº“**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Insert Custom Component             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ–¼ï¸  Single Image                     â”‚
â”‚  ğŸ–¼ï¸  Image Gallery                    â”‚
â”‚  ğŸ“  Left Image Right Text            â”‚
â”‚  ğŸ“  Right Image Left Text            â”‚
â”‚  ğŸ¬  Video Embed                      â”‚
â”‚  ğŸ”˜  CTA Button                       â”‚
â”‚  ğŸ’¬  Testimonial / Quote              â”‚
â”‚  ğŸ“Š  Data Table                       â”‚
â”‚  âš ï¸  Alert / Notice Box               â”‚
â”‚  ğŸ”—  Reusable Block (Global Content) â”‚
â”‚  ğŸ“¦  Product Reference                â”‚
â”‚  ğŸ“  Blog Post Reference              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸æ™®é€šç»„ä»¶å—çš„åŒºåˆ«**ï¼š

| æ–¹å¼ | æ’å…¥æ–¹æ³• | ç‰¹ç‚¹ |
|------|---------|------|
| **æ™®é€šæ ¼å¼åŒ–** | å·¥å…·æ å·¦ä¾§æŒ‰é’® | åŸºç¡€æ–‡æœ¬æ ·å¼ã€åˆ—è¡¨ã€å¼•ç”¨ç­‰ |
| **"+" è‡ªå®šä¹‰ç»„ä»¶** | å·¥å…·æ æœ€å³ä¾§ **"+" æŒ‰é’®** | å¤æ‚çš„ç»“æ„åŒ–æ•°æ®ç»„ä»¶ï¼Œå¯ä»¥**é“¾æ¥åˆ°æ•°æ®åº“**ä¸­çš„å…¶ä»–å†…å®¹ |

**è‡ªå®šä¹‰ç»„ä»¶çš„æ ¸å¿ƒä¼˜åŠ¿**ï¼š

1. **ç»“æ„åŒ–æ•°æ®å­˜å‚¨**ï¼šä¸æ˜¯å­˜å‚¨ä¸º HTMLï¼Œè€Œæ˜¯å­˜å‚¨ä¸º JSON æ•°æ®
2. **å¯ç¼–è¾‘æ€§å¼º**ï¼šæ’å…¥åå¯ä»¥éšæ—¶é‡æ–°æ‰“å¼€ç¼–è¾‘ï¼Œä¿®æ”¹å‚æ•°
3. **æ•°æ®åº“å…³è”**ï¼šå¯ä»¥ä½¿ç”¨ `fields.relationship()` é“¾æ¥åˆ°å…¶ä»– Keystone å†…å®¹ï¼ˆå¦‚äº§å“ã€æ–‡ç« ï¼‰
4. **ç±»å‹å®‰å…¨**ï¼šæœ‰æ˜ç¡®çš„ Schema å®šä¹‰ï¼Œé¿å…æ•°æ®é”™è¯¯

**ç¤ºä¾‹ï¼šæ’å…¥"äº§å“å¼•ç”¨"ç»„ä»¶**

```typescript
// åœ¨ componentBlocks ä¸­å®šä¹‰
productReference: component({
  label: 'Product Reference',
  schema: {
    // ğŸ”¥ å…³é”®ï¼šå¯ä»¥ç›´æ¥å…³è”åˆ°æ•°æ®åº“ä¸­çš„äº§å“
    product: fields.relationship({ 
      label: 'Select Product', 
      relationship: 'Product',
      selection: 'id sku name_en mainImage { url altText_en }' // æŒ‡å®šè¦è·å–çš„å­—æ®µ
    }),
    displayStyle: fields.select({
      label: 'Display Style',
      options: [
        { label: 'Card', value: 'card' },
        { label: 'Inline', value: 'inline' },
        { label: 'Banner', value: 'banner' },
      ],
      defaultValue: 'card'
    }),
    showPrice: fields.checkbox({ label: 'Show Price' }),
    ctaText_en: fields.text({ label: 'CTA Text (English)', defaultValue: 'View Product' }),
    ctaText_zh: fields.text({ label: 'CTA Text (Chinese)', defaultValue: 'æŸ¥çœ‹äº§å“' }),
  },
  preview: (props) => {
    const product = props.fields.product.value
    if (!product) {
      return <div style={{ padding: '20px', border: '2px dashed #ccc' }}>
        Select a product...
      </div>
    }
    
    return (
      <div style={{
        border: '1px solid #ddd',
        borderRadius: '8px',
        padding: '16px',
        display: 'flex',
        gap: '16px',
        alignItems: 'center'
      }}>
        {product.data?.mainImage && (
          <img 
            src={product.data.mainImage.url} 
            alt={product.data.mainImage.altText_en}
            style={{ width: '100px', height: '100px', objectFit: 'cover', borderRadius: '4px' }}
          />
        )}
        <div>
          <h4 style={{ margin: '0 0 8px' }}>{product.data?.name_en}</h4>
          <p style={{ margin: '0', color: '#666', fontSize: '14px' }}>SKU: {product.data?.sku}</p>
          <button style={{
            marginTop: '8px',
            padding: '8px 16px',
            backgroundColor: '#007bff',
            color: 'white',
            border: 'none',
            borderRadius: '4px',
            cursor: 'pointer'
          }}>
            {props.fields.ctaText_en.value}
          </button>
        </div>
      </div>
    )
  }
}),

// ç±»ä¼¼åœ°ï¼Œå¯ä»¥å®šä¹‰ Blog Post Reference
blogPostReference: component({
  label: 'Blog Post Reference',
  schema: {
    post: fields.relationship({ 
      label: 'Select Blog Post', 
      relationship: 'Blog',
      selection: 'id slug title_en excerpt_en coverImage { url altText_en }'
    }),
    // ... å…¶ä»–å­—æ®µ
  },
  preview: (props) => {
    // æ¸²æŸ“åšå®¢æ–‡ç« å¡ç‰‡é¢„è§ˆ
  }
})
```

**è¿è¥äººå‘˜ä½¿ç”¨ä½“éªŒ**ï¼š

1. ç‚¹å‡» **"+"** æŒ‰é’®
2. é€‰æ‹© **"Product Reference"**
3. åœ¨å¼¹å‡ºçš„é…ç½®é¢æ¿ä¸­ï¼š
   - ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­**é€‰æ‹©ä¸€ä¸ªäº§å“**ï¼ˆåˆ—è¡¨ä»æ•°æ®åº“å®æ—¶åŠ è½½ï¼‰
   - é€‰æ‹©æ˜¾ç¤ºæ ·å¼ï¼ˆå¡ç‰‡/å†…è”/æ¨ªå¹…ï¼‰
   - å‹¾é€‰æ˜¯å¦æ˜¾ç¤ºä»·æ ¼
   - è‡ªå®šä¹‰ CTA æŒ‰é’®æ–‡å­—
4. ç‚¹å‡»"æ’å…¥"
5. ç»„ä»¶ç«‹å³å‡ºç°åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæ˜¾ç¤º**å®æ—¶çš„äº§å“é¢„è§ˆ**
6. å¦‚æœäº§å“ä¿¡æ¯åœ¨æ•°æ®åº“ä¸­æ›´æ–°ï¼ˆå¦‚æ”¹åã€æ¢å›¾ï¼‰ï¼Œ**æ­¤å¼•ç”¨ä¼šè‡ªåŠ¨æ›´æ–°**

---

### "+" æŒ‰é’®è‡ªå®šä¹‰ç»„ä»¶å®Œæ•´åˆ—è¡¨

åŸºäºé¡¹ç›®éœ€æ±‚ï¼Œä»¥ä¸‹æ˜¯æ¨èçš„è‡ªå®šä¹‰ç»„ä»¶ï¼š
  // 1. å¯Œæ–‡æœ¬
  richText: component({
    label: 'Rich Text',
    schema: {
      content: fields.child({ kind: 'block', placeholder: 'Write content...' })
    },
    preview: (props) => props.fields.content.element
  }),
  
  // 2. å•å¼ å›¾ç‰‡
  singleImage: component({
    label: 'Single Image',
    schema: {
      image: fields.relationship({ label: 'Image', relationship: 'Media' }),
      caption_en: fields.text({ label: 'Caption (English)' }),
      caption_zh: fields.text({ label: 'Caption (Chinese)' }),
      // ... å…¶ä»–è¯­è¨€
    },
    preview: (props) => {
      return (
        <div>
          <p>Image: {props.fields.image.value?.label}</p>
          <p>Caption: {props.fields.caption_en.value}</p>
        </div>
      )
    }
  }),
  
  // 3. å›¾ç‰‡ç”»å»Š
    
  // 2. å›¾ç‰‡ç”»å»Š
  imageGallery: component({
    label: 'ğŸ–¼ï¸ Image Gallery',
    schema: {
      images: fields.array(
        fields.relationship({ 
          label: 'Image', 
          relationship: 'Media',
          selection: 'id url altText_en altText_zh thumbnailUrl'
        })
      ),
      layout: fields.select({
        label: 'Layout',
        options: [
          { label: 'Grid (2 columns)', value: 'grid-2' },
          { label: 'Grid (3 columns)', value: 'grid-3' },
          { label: 'Grid (4 columns)', value: 'grid-4' },
          { label: 'Carousel', value: 'carousel' },
          { label: 'Masonry', value: 'masonry' },
        ],
        defaultValue: 'grid-3'
      }),
      showCaptions: fields.checkbox({ label: 'Show Image Captions' }),
    },
    preview: (props) => {
      const imageCount = props.fields.images.elements.length
      return (
        <div style={{ 
          border: '1px solid #ddd', 
          borderRadius: '8px', 
          padding: '16px',
          backgroundColor: '#f9f9f9'
        }}>
          <p style={{ margin: '0 0 8px', fontWeight: 'bold' }}>
            ğŸ–¼ï¸ Image Gallery ({imageCount} {imageCount === 1 ? 'image' : 'images'})
          </p>
          <p style={{ margin: 0, fontSize: '14px', color: '#666' }}>
            Layout: {props.fields.layout.value}
          </p>
        </div>
      )
    }
  }),
  leftImageRightText: component({
    label: 'Left Image Right Text',
    schema: {
      image: fields.relationship({ label: 'Image', relationship: 'Media' }),
      title_en: fields.text({ label: 'Title (English)' }),
      title_zh: fields.text({ label: 'Title (Chinese)' }),
      content: fields.child({ kind: 'block' }),
    },
    preview: (props) => {
      return (
        <div style={{ display: 'flex', gap: '20px' }}>
          <div style={{ flex: 1 }}>Image</div>
          <div style={{ flex: 1 }}>
            <h3>{props.fields.title_en.value}</h3>
            {props.fields.content.element}
          </div>
        </div>
      )
    }
  }),
  
  // 6. è§†é¢‘åµŒå…¥
  videoEmbed: component({
    label: 'Video Embed',
    schema: {
      platform: fields.select({
        label: 'Platform',
        options: [
          { label: 'YouTube', value: 'youtube' },
          { label: 'Vimeo', value: 'vimeo' },
        ],
        defaultValue: 'youtube'
      }),
      videoId: fields.text({ 
        label: 'Video ID',
        validation: { isRequired: true }
      }),
      caption_en: fields.text({ label: 'Caption (English)' }),
      caption_zh: fields.text({ label: 'Caption (Chinese)' }),
    },
    preview: (props) => {
      const { platform, videoId } = props.fields
      const embedUrl = platform.value === 'youtube'
        ? `https://www.youtube.com/embed/${videoId.value}`
        : `https://player.vimeo.com/video/${videoId.value}`
      
      return (
        <div>
          <iframe
            width="100%"
            height="315"
            src={embedUrl}
            frameBorder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowFullScreen
          />
          <p>{props.fields.caption_en.value}</p>
        </div>
      )
    }
  }),
  
  // 7. CTA æŒ‰é’®
  ctaButton: component({
    label: 'CTA Button',
    schema: {
      text_en: fields.text({ label: 'Button Text (English)' }),
      text_zh: fields.text({ label: 'Button Text (Chinese)' }),
      link: fields.text({ label: 'Link URL' }),
      style: fields.select({
        label: 'Style',
        options: [
          { label: 'Primary', value: 'primary' },
          { label: 'Secondary', value: 'secondary' },
          { label: 'Outline', value: 'outline' },
        ],
        defaultValue: 'primary'
      }),
      openInNewTab: fields.checkbox({ label: 'Open in new tab' }),
    },
    preview: (props) => {
      return (
        <button style={{
          padding: '12px 24px',
          fontSize: '16px',
          fontWeight: 'bold',
          borderRadius: '8px',
          cursor: 'pointer',
          backgroundColor: props.fields.style.value === 'primary' ? '#007bff' : '#6c757d',
          color: 'white',
          border: 'none',
        }}>
          {props.fields.text_en.value || 'Button'}
        </button>
      )
    }
  }),
  
  // 8. å¼•ç”¨/å®¢æˆ·è¯„ä»·
  testimonial: component({
    label: 'Testimonial',
    schema: {
      quote_en: fields.text({ 
        label: 'Quote (English)',
        multiline: true 
      }),
      quote_zh: fields.text({ 
        label: 'Quote (Chinese)',
        multiline: true 
      }),
      author: fields.text({ label: 'Author Name' }),
      position: fields.text({ label: 'Position/Company' }),
      avatar: fields.relationship({ label: 'Avatar', relationship: 'Media' }),
    },
    preview: (props) => {
      return (
        <blockquote style={{
          borderLeft: '4px solid #007bff',
          paddingLeft: '20px',
          fontStyle: 'italic',
          color: '#555',
        }}>
          <p>"{props.fields.quote_en.value}"</p>
          <footer>
            â€” <strong>{props.fields.author.value}</strong>
            {props.fields.position.value && `, ${props.fields.position.value}`}
          </footer>
        </blockquote>
      )
    }
  }),
  
  // 9. æ•°æ®è¡¨æ ¼
  dataTable: component({
    label: 'Data Table',
    schema: {
      headers: fields.array(
        fields.object({
          key: fields.text({ label: 'Key' }),
          label_en: fields.text({ label: 'Label (English)' }),
          label_zh: fields.text({ label: 'Label (Chinese)' }),
        })
      ),
      rows: fields.array(
        fields.object({
          cells: fields.text({ 
            label: 'Cells (comma-separated)',
            multiline: true 
          })
        })
      ),
      caption_en: fields.text({ label: 'Caption (English)' }),
      caption_zh: fields.text({ label: 'Caption (Chinese)' }),
    },
    preview: (props) => {
      return (
        <div>
          <table style={{ width: '100%', borderCollapse: 'collapse' }}>
            <thead>
              <tr>
                {props.fields.headers.elements.map((header, i) => (
                  <th key={i} style={{ 
                    border: '1px solid #ddd', 
                    padding: '8px',
                    backgroundColor: '#f2f2f2'
                  }}>
                    {header.fields.label_en.value}
                  </th>
                ))}
              </tr>
            </thead>
            <tbody>
              {props.fields.rows.elements.map((row, i) => (
                <tr key={i}>
                  {row.fields.cells.value?.split(',').map((cell, j) => (
                    <td key={j} style={{ 
                      border: '1px solid #ddd', 
                      padding: '8px' 
                    }}>
                      {cell.trim()}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
          {props.fields.caption_en.value && (
            <p style={{ fontSize: '14px', color: '#666', marginTop: '8px' }}>
              {props.fields.caption_en.value}
            </p>
          )}
        </div>
      )
    }
  }),
  
  // 10. è­¦å‘Š/æç¤ºæ¡†
  alertBox: component({
    label: 'Alert Box',
    schema: {
      type: fields.select({
        label: 'Type',
        options: [
          { label: 'Info', value: 'info' },
          { label: 'Success', value: 'success' },
          { label: 'Warning', value: 'warning' },
          { label: 'Error', value: 'error' },
        ],
        defaultValue: 'info'
      }),
      title_en: fields.text({ label: 'Title (English)' }),
      title_zh: fields.text({ label: 'Title (Chinese)' }),
      content: fields.child({ kind: 'block', placeholder: 'Alert content...' }),
    },
    preview: (props) => {
      const colors = {
        info: '#d1ecf1',
        success: '#d4edda',
        warning: '#fff3cd',
        error: '#f8d7da',
      }
      return (
        <div style={{
          padding: '16px',
          borderRadius: '8px',
          backgroundColor: colors[props.fields.type.value],
          border: `1px solid ${colors[props.fields.type.value]}`,
        }}>
          <strong>{props.fields.title_en.value}</strong>
          {props.fields.content.element}
        </div>
      )
    }
  }),
    label: 'Reusable Block',
    schema: {
      block: fields.relationship({ 
        label: 'Block', 
        relationship: 'ReusableBlock' 
      }),
    },
    preview: (props) => {
      return (
        <div style={{ 
          border: '2px dashed #ccc', 
          padding: '20px', 
          borderRadius: '8px' 
        }}>
          <p>ğŸ”— Reusable Block: {props.fields.block.value?.label}</p>
        </div>
      )
    }
  }),
}
```

---


---

**è¿”å›**: [README.md](./README.md)
