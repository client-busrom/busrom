# 03 - æ ¸å¿ƒæ•°æ®æ¨¡å‹

> **é˜…è¯»æ—¶é—´**: 15 åˆ†é’Ÿ  
> **é€‚ç”¨å¯¹è±¡**: åç«¯å¼€å‘å·¥ç¨‹å¸ˆ

åŒ…å«: HomePage, Media, MediaCategory, MediaTag, Category, ProductSeries, Product, Blog, Application, FaqItem, ContactForm

---

## ğŸ“‹ æ ¸å¿ƒæ¨¡å‹è¯¦ç»†å®šä¹‰

### 1. Media (åª’ä½“åº“)

**åŠŸèƒ½**: ç®¡ç†æ‰€æœ‰å›¾ç‰‡èµ„æºï¼Œå­˜å‚¨åˆ° AWS S3ï¼Œé€šè¿‡ CloudFront CDN åˆ†å‘

**æ–‡ä»¶ä½ç½®**: `cms/schemas/Media.ts`

```typescript
import { list } from '@keystone-6/core'
import { text, json, select, image, relationship, timestamp } from '@keystone-6/core/fields'

export const Media = list({
  fields: {
    /**
     * AWS S3 å›¾ç‰‡å­—æ®µ
     * 
     * å›¾ç‰‡å­˜å‚¨åœ¨ S3 bucketï¼Œé€šè¿‡ CloudFront åˆ†å‘
     * å­˜å‚¨é…ç½®åœ¨ keystone.ts ä¸­
     */
    file: image({
      storage: 's3_images',
    }),

    /**
     * æ–‡ä»¶å
     * 
     * ç´¢å¼•ä»¥ä¾¿å¿«é€Ÿæœç´¢
     */
    filename: text({
      validation: { isRequired: true },
      isIndexed: true,
    }),

    /**
     * çŠ¶æ€ - è½¯åˆ é™¤å®ç°
     * 
     * ACTIVE: åœ¨åª’ä½“åº“ä¸­å¯è§
     * ARCHIVED: éšè—ä½†æœªåˆ é™¤ï¼ˆä¿æŒæ•°æ®å®Œæ•´æ€§ï¼‰
     */
    status: select({
      options: [
        { label: 'Active', value: 'ACTIVE' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'ACTIVE',
      ui: {
        displayMode: 'segmented-control',
      },
    }),

    // ==================================================================
    // ğŸŒ å¤šè¯­è¨€ Alt æ–‡æœ¬ï¼ˆJSON æ ¼å¼ + è‡ªå®šä¹‰ç¼–è¾‘å™¨ï¼‰
    // ==================================================================
    altText: json({
      label: 'Alt Text',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Image alt text in all 24 languages with auto-translation (Required for SEO)',
      },
    }),

    /**
     * ä¸»åˆ†ç±»ï¼ˆæ ‘å½¢ç»“æ„ï¼Œå•é€‰ï¼‰
     * 
     * ç”¨äºç»„ç»‡å›¾ç‰‡çš„ä¸»è¦åˆ†ç±»
     * ä¾‹å¦‚ï¼šProduct > æŒ‰åŠŸèƒ½åˆ†ç±» > åœºæ™¯å›¾
     */
    primaryCategory: relationship({
      ref: 'MediaCategory',
      many: false,
      ui: {
        displayMode: 'select',
        description: 'é€‰æ‹©ä¸»è¦åˆ†ç±»',
      },
    }),

    /**
     * æ ‡ç­¾ï¼ˆå¤šå¯¹å¤šï¼Œå¤šé€‰ï¼‰
     * 
     * ç”¨äºå¤šç»´åº¦æ ‡è®°
     * ä¾‹å¦‚ï¼šäº§å“ç³»åˆ—ã€åŠŸèƒ½ç±»å‹ã€è§„æ ¼ã€é¢œè‰²ç­‰
     */
    tags: relationship({
      ref: 'MediaTag',
      many: true,
      ui: {
        displayMode: 'cards',
        cardFields: ['name', 'type', 'color'],
        inlineConnect: true,
        description: 'é€‰æ‹©å¤šä¸ªæ ‡ç­¾',
      },
    }),

    /**
     * å…ƒæ•°æ®ï¼ˆJSON æ ¼å¼ï¼‰
     * 
     * å­˜å‚¨é¢å¤–å±æ€§
     * ä¾‹å¦‚ï¼šåœºæ™¯ç¼–å·ã€è§„æ ¼ã€é¢œè‰²ç­‰
     */
    metadata: json({
      defaultValue: {},
      ui: {
        description: 'å­˜å‚¨é¢å¤–å±æ€§ï¼ˆè§„æ ¼ã€é¢œè‰²ã€åœºæ™¯ç¼–å·ç­‰ï¼‰',
      },
    }),
    // ç¤ºä¾‹ metadata ç»“æ„ï¼š
    // {
    //   "sceneNumber": 1,
    //   "sceneType": "ç»„åˆ",
    //   "seriesNumber": 2,
    //   "specs": ["50mm", "ä¸é”ˆé’¢"],
    //   "colors": ["é»‘è‰²", "é“¶è‰²"]
    // }

    /**
     * ä¸Šä¼ è€…
     * 
     * è¿½è¸ªå“ªä¸ªç®¡ç†å‘˜ä¸Šä¼ äº†æ­¤æ–‡ä»¶
     */
    uploadedBy: relationship({
      ref: 'User',
      many: false,
      ui: {
        displayMode: 'cards',
        cardFields: ['name', 'email'],
      },
    }),

    /**
     * æ—¶é—´æˆ³
     */
    createdAt: timestamp({
      defaultValue: { kind: 'now' },
    }),

    updatedAt: timestamp({
      db: { updatedAt: true },
    }),
  },

  /**
   * GraphQL é…ç½®
   */
  graphql: {
    plural: 'MediaFiles',
  },

  /**
   * è®¿é—®æ§åˆ¶
   * 
   * ğŸ”’ ç¦ç”¨ç‰©ç†åˆ é™¤ä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±
   * ä½¿ç”¨è½¯åˆ é™¤ï¼ˆstatus: ARCHIVEDï¼‰ä»£æ›¿
   */
  access: {
    operation: {
      query: () => true,
      create: () => true,
      update: () => true,
      delete: () => false, // ç¦ç”¨ UI ä¸­çš„åˆ é™¤æŒ‰é’®
    },
  },

  /**
   * UI é…ç½®
   */
  ui: {
    listView: {
      initialColumns: ['file', 'filename', 'status', 'primaryCategory', 'tags'],
      initialSort: { field: 'createdAt', direction: 'DESC' },
      pageSize: 50,
    },
    labelField: 'filename',
  },
})
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "id": "ckxxx",
  "filename": "glass-standoff-scene-1.jpg",
  "file": {
    "url": "https://d1234567.cloudfront.net/glass-standoff-scene-1.jpg"
  },
  "altText": {
    "en": "Glass standoff installation scene",
    "zh": "ç»ç’ƒæ”¯æ’‘ä»¶å®‰è£…åœºæ™¯"
  },
  "primaryCategory": {
    "id": "scene-photo",
    "name": "Scene Photo"
  },
  "tags": [
    { "name": "Glass Standoff", "type": "PRODUCT_SERIES" },
    { "name": "Combination Scene", "type": "SCENE_TYPE" }
  ],
  "metadata": {
    "sceneNumber": 1,
    "sceneType": "ç»„åˆ"
  },
  "status": "ACTIVE"
}
```

---

### 2. MediaCategory (åª’ä½“ä¸»åˆ†ç±»)

**åŠŸèƒ½**: æ ‘å½¢åˆ†ç±»ç³»ç»Ÿï¼Œæœ€å¤š3å±‚æ·±åº¦

**æ–‡ä»¶ä½ç½®**: `cms/schemas/MediaCategory.ts`

```typescript
import { list } from '@keystone-6/core'
import { text, json, select, relationship, timestamp, integer, virtual } from '@keystone-6/core/fields'
import { graphql } from '@keystone-6/core'

export const MediaCategory = list({
  fields: {
    /**
     * åˆ†ç±»åç§°ï¼ˆå¤šè¯­è¨€ï¼‰
     */
    name: json({
      label: 'Category Name',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Category name in all 24 languages',
      },
    }),

    /**
     * Slugï¼ˆURL å‹å¥½çš„åç§°ï¼‰
     * 
     * ç”¨äº API ç­›é€‰: /api/media?category=product-scene
     */
    slug: text({
      validation: { isRequired: true },
      isIndexed: 'unique',
      ui: {
        description: 'URL-friendly version (e.g., "product-scene")',
      },
    }),

    /**
     * æ ‘å½¢ç»“æ„ï¼ˆè‡ªå¼•ç”¨ï¼‰
     */
    parent: relationship({
      ref: 'MediaCategory.children',
      many: false,
      ui: {
        displayMode: 'select',
        description: 'çˆ¶åˆ†ç±»ï¼ˆç•™ç©ºåˆ™ä¸ºé¡¶çº§åˆ†ç±»ï¼‰',
      },
    }),

    children: relationship({
      ref: 'MediaCategory.parent',
      many: true,
      ui: {
        displayMode: 'count',
      },
    }),

    /**
     * å±‚çº§æ·±åº¦ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
     * 
     * ç”¨äºé™åˆ¶å±‚çº§ï¼ˆæœ€å¤š3å±‚ï¼‰
     */
    depth: integer({
      defaultValue: 0,
      ui: {
        createView: { fieldMode: 'hidden' },
        itemView: { fieldMode: 'read' },
      },
    }),

    /**
     * åˆ†ç±»ç±»å‹
     */
    type: select({
      options: [
        { label: 'Common', value: 'COMMON' },
        { label: 'Product Series', value: 'PRODUCT_SERIES' },
        { label: 'Product Function', value: 'PRODUCT_FUNCTION' },
      ],
      ui: {
        displayMode: 'segmented-control',
      },
    }),

    /**
     * æ’åº
     */
    order: integer({
      defaultValue: 0,
    }),

    /**
     * å›¾æ ‡ï¼ˆå¯é€‰ï¼‰
     */
    icon: text({
      ui: {
        description: 'å›¾æ ‡åç§°ï¼ˆå¦‚ "folder", "image"ï¼‰',
      },
    }),

    /**
     * æè¿°
     */
    description: json({
      label: 'Description',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    /**
     * åª’ä½“æ•°é‡ï¼ˆè™šæ‹Ÿå­—æ®µï¼‰
     */
    mediaCount: virtual({
      field: graphql.field({
        type: graphql.Int,
        async resolve(item, args, context) {
          const count = await context.query.Media.count({
            where: {
              primaryCategory: { id: { equals: item.id } },
            },
          })
          return count
        },
      }),
    }),

    /**
     * æ—¶é—´æˆ³
     */
    createdAt: timestamp({
      defaultValue: { kind: 'now' },
    }),
  },

  /**
   * Hooks - è‡ªåŠ¨è®¡ç®—å±‚çº§æ·±åº¦
   */
  hooks: {
    resolveInput: async ({ resolvedData, context }) => {
      if (resolvedData.parent) {
        const parent = await context.query.MediaCategory.findOne({
          where: { id: resolvedData.parent.connect.id },
          query: 'id depth',
        })
        
        const newDepth = (parent?.depth || 0) + 1
        
        if (newDepth > 2) {
          throw new Error('åˆ†ç±»å±‚çº§ä¸èƒ½è¶…è¿‡3å±‚')
        }
        
        return {
          ...resolvedData,
          depth: newDepth,
        }
      }
      
      return { ...resolvedData, depth: 0 }
    },
  },

  /**
   * è®¿é—®æ§åˆ¶
   */
  access: {
    operation: {
      delete: () => false,
    },
  },

  /**
   * UI é…ç½®
   */
  ui: {
    listView: {
      initialColumns: ['name', 'type', 'parent', 'depth', 'mediaCount', 'order'],
      initialSort: { field: 'order', direction: 'ASC' },
    },
  },
})
```

**é¢„è®¾åˆ†ç±»ç»“æ„**:
```
ğŸ“ Commonï¼ˆé€šç”¨ï¼‰
   â””â”€ é¡µé¢å›¾ç‰‡

ğŸ“ Productï¼ˆäº§å“ï¼‰
   â”œâ”€ ğŸ“ æŒ‰äº§å“ç³»åˆ—
   â”‚
   â””â”€ ğŸ“ æŒ‰åŠŸèƒ½åˆ†ç±»
      â”œâ”€ ğŸ“„ åœºæ™¯å›¾
      â”œâ”€ ğŸ“„ ç™½åº•å›¾
      â”œâ”€ ğŸ“„ å°ºå¯¸å›¾
      â”œâ”€ ğŸ“„ å®æ‹å›¾
      â””â”€ ğŸ“„ åˆç”¨å›¾
```

---

### 3. MediaTag (åª’ä½“æ ‡ç­¾)

**åŠŸèƒ½**: æ‰å¹³çš„å¤šå¯¹å¤šæ ‡ç­¾ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `cms/schemas/MediaTag.ts`

```typescript
import { list } from '@keystone-6/core'
import { text, json, select, integer, virtual } from '@keystone-6/core/fields'
import { graphql } from '@keystone-6/core'

export const MediaTag = list({
  fields: {
    /**
     * æ ‡ç­¾åç§°ï¼ˆå¤šè¯­è¨€ï¼‰
     */
    name: json({
      label: 'Tag Name',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Tag name in all 24 languages',
      },
    }),

    /**
     * Slug
     */
    slug: text({
      isIndexed: 'unique',
      validation: { isRequired: true },
    }),

    /**
     * æ ‡ç­¾ç±»å‹ï¼ˆç”¨äºåˆ†ç»„ï¼‰
     */
    type: select({
      options: [
        { label: 'Product Series', value: 'PRODUCT_SERIES' },
        { label: 'Function Type', value: 'FUNCTION_TYPE' },
        { label: 'Scene Type', value: 'SCENE_TYPE' },
        { label: 'Spec', value: 'SPEC' },
        { label: 'Color', value: 'COLOR' },
        { label: 'Custom', value: 'CUSTOM' },
      ],
      defaultValue: 'CUSTOM',
      ui: {
        displayMode: 'select',
      },
    }),

    /**
     * æ ‡ç­¾é¢œè‰²ï¼ˆç”¨äº UI æ˜¾ç¤ºï¼‰
     */
    color: text({
      defaultValue: '#3b82f6',
      ui: {
        description: 'HEX é¢œè‰²ä»£ç ï¼ˆå¦‚ #3b82f6ï¼‰',
      },
    }),

    /**
     * æ’åº
     */
    order: integer({
      defaultValue: 0,
    }),

    /**
     * åª’ä½“æ•°é‡ï¼ˆè™šæ‹Ÿå­—æ®µï¼‰
     */
    mediaCount: virtual({
      field: graphql.field({
        type: graphql.Int,
        async resolve(item, args, context) {
          const count = await context.query.Media.count({
            where: {
              tags: { some: { id: { equals: item.id } } },
            },
          })
          return count
        },
      }),
    }),
  },

  /**
   * è®¿é—®æ§åˆ¶
   */
  access: {
    operation: {
      delete: () => false,
    },
  },

  /**
   * UI é…ç½®
   */
  ui: {
    listView: {
      initialColumns: ['name', 'type', 'color', 'mediaCount', 'order'],
      initialSort: { field: 'order', direction: 'ASC' },
    },
  },
})
```

**é¢„è®¾æ ‡ç­¾**:

**äº§å“ç³»åˆ—æ ‡ç­¾**ï¼ˆ10ä¸ªï¼‰:
- Glass Standoffï¼ˆå¹¿å‘Šèºä¸ï¼‰
- Glass Connected Fittingï¼ˆç»ç’ƒæ æ†æ‰¶æ‰‹è¿æ¥ä»¶ï¼‰
- Glass Fence Spigotï¼ˆç»ç’ƒæŠ¤æ æ”¯æ¶åº•åº§ï¼‰
- Guardrail Glass Clipï¼ˆæŠ¤æ ç³»åˆ—ï¼‰
- Bathroom Glass Clipï¼ˆæµ´å®¤ç³»åˆ—ï¼‰
- Glass Hingeï¼ˆæµ´å®¤å¤¹ï¼‰
- Sliding Door Kitï¼ˆç§»é—¨æ»‘è½®å¥—è£…ï¼‰
- Bathroom Handleï¼ˆæµ´å®¤&å¤§é—¨æ‹‰æ‰‹ï¼‰
- Door Handleï¼ˆå¤§é—¨æ‹‰æ‰‹ï¼‰
- Hidden Hookï¼ˆæŒ‚é’©ï¼‰

**åŠŸèƒ½ç±»å‹æ ‡ç­¾**:
- Scene Photoï¼ˆåœºæ™¯å›¾ï¼‰
- White Backgroundï¼ˆç™½åº•å›¾ï¼‰
- Dimension Drawingï¼ˆå°ºå¯¸å›¾ï¼‰
- Real Shotï¼ˆå®æ‹å›¾ï¼‰
- Composite Useï¼ˆåˆç”¨å›¾ï¼‰

**åœºæ™¯ç±»å‹æ ‡ç­¾**:
- Normal Sceneï¼ˆæ™®é€šåœºæ™¯å›¾ï¼‰
- Single Sceneï¼ˆå•ç‹¬åœºæ™¯å›¾ï¼‰
- Combination Sceneï¼ˆåœºæ™¯ç»„åˆå›¾ï¼‰
- Series Sceneï¼ˆç³»åˆ—åœºæ™¯å›¾ï¼‰

---

### 4. Category (é€šç”¨åˆ†ç±»)

**åŠŸèƒ½**: ç”¨äºäº§å“ã€åšå®¢ã€åº”ç”¨æ¡ˆä¾‹ã€é¡µé¢ã€FAQç­‰çš„åˆ†ç±»

```typescript
// keystone/schemas/Category.ts
export const Category = list({
  fields: {
    // åç§°ï¼ˆå¤šè¯­è¨€ JSON æ ¼å¼ï¼‰
    name: json({
      label: 'Category Name',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // Slugï¼ˆå”¯ä¸€ï¼‰
    slug: text({ 
      isIndexed: 'unique', 
      validation: { isRequired: true } 
    }),

    // åˆ†ç±»ç±»å‹
    type: select({
      options: [
        { label: 'Page', value: 'PAGE' },
        { label: 'Product', value: 'PRODUCT' },
        { label: 'Blog', value: 'BLOG' },
        { label: 'Application', value: 'APPLICATION' },
        { label: 'FAQ', value: 'FAQ' },
      ],
      validation: { isRequired: true }
    }),

    // æ ‘å½¢ç»“æ„
    parent: relationship({ 
      ref: 'Category.children' 
    }),
    
    children: relationship({ 
      ref: 'Category.parent', 
      many: true 
    }),

    // æè¿°ï¼ˆå¤šè¯­è¨€ï¼‰
    description: json({
      label: 'Description',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // æ’åº
    order: integer({ defaultValue: 0 }),

    // æ—¶é—´æˆ³
    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
  },

  // ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => false,
    }
  },

  ui: {
    listView: {
      initialColumns: ['name', 'type', 'parent', 'order'],
    }
  }
})
```

---

### 5. ProductSeries (äº§å“ç³»åˆ—)

**æ–‡ä»¶ä½ç½®**: `cms/schemas/ProductSeries.ts`

**å¤šè¯­è¨€æ–¹æ¡ˆ**ï¼š
- âœ… **JSON æ–¹æ¡ˆ**ï¼šname, description (çŸ­æ–‡æœ¬å­—æ®µ)
- âœ… **å…³ç³»è¡¨æ–¹æ¡ˆ**ï¼šcontentTranslations (å¯Œæ–‡æœ¬å†…å®¹)

```typescript
// cms/schemas/ProductSeries.ts
import { list, graphql } from '@keystone-6/core'
import { text, json, select, relationship, timestamp, integer, virtual } from '@keystone-6/core/fields'

export const ProductSeries = list({
  fields: {
    // Slugï¼ˆURL å‹å¥½æ ‡è¯†ï¼‰
    slug: text({
      validation: { isRequired: true },
      isIndexed: 'unique',
    }),

    // ==================================================================
    // ğŸŒ å¤šè¯­è¨€å­—æ®µï¼šJSON æ–¹æ¡ˆï¼ˆçŸ­æ–‡æœ¬ï¼‰
    // ==================================================================

    // åç§°ï¼ˆå¤šè¯­è¨€ JSONï¼‰
    name: json({
      label: 'Series Name',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Series name in all 24 languages',
      },
    }),

    // ç®€çŸ­æè¿°ï¼ˆå¤šè¯­è¨€ JSONï¼‰
    description: json({
      label: 'Series Description',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Short description in all 24 languages',
      },
    }),

    // ==================================================================
    // ğŸŒ å¤šè¯­è¨€å­—æ®µï¼šå…³ç³»è¡¨æ–¹æ¡ˆï¼ˆå¯Œæ–‡æœ¬å†…å®¹ï¼‰
    // ==================================================================

    // å¯Œæ–‡æœ¬å†…å®¹ç¿»è¯‘ï¼ˆå…³ç³»è¡¨ï¼‰
    contentTranslations: relationship({
      ref: 'ProductSeriesContentTranslation.productSeries',
      many: true,
      ui: {
        displayMode: 'cards',
        cardFields: ['locale', 'updatedAt'],
        inlineCreate: { fields: ['locale'] },
        inlineEdit: { fields: ['locale', 'content'] },
        linkToItem: true,
        description: 'Click language card to edit rich text content',
      },
    }),

    // è™šæ‹Ÿå­—æ®µï¼šæŒ‰è¯­è¨€æŸ¥è¯¢å†…å®¹
    contentByLocale: virtual({
      field: graphql.field({
        type: graphql.object<{ locale: string; content: any }>()({
          name: 'ContentTranslation',
          fields: {
            locale: graphql.field({ type: graphql.String }),
            content: graphql.field({ type: graphql.JSON }),
          },
        }),
        args: {
          locale: graphql.arg({ type: graphql.nonNull(graphql.String) }),
        },
        async resolve(item, { locale }, context) {
          const translations = await context.query.ProductSeriesContentTranslation.findMany({
            where: {
              productSeries: { id: { equals: item.id as string } },
              locale: { equals: locale },
            },
            query: 'locale content',
          })
          return translations[0] || { locale, content: null }
        },
      }),
      ui: {
        listView: { fieldMode: 'hidden' },
        itemView: { fieldMode: 'hidden' },
      },
    }),

    // è™šæ‹Ÿå­—æ®µï¼šæ˜¾ç¤ºå·²ç¿»è¯‘çš„è¯­è¨€åˆ—è¡¨
    translatedLocales: virtual({
      field: graphql.field({
        type: graphql.String,
        async resolve(item, args, context) {
          const translations = await context.query.ProductSeriesContentTranslation.findMany({
            where: {
              productSeries: { id: { equals: item.id as string } },
            },
            query: 'locale',
          })
          const locales = translations.map((t: any) => String(t.locale))
          return JSON.stringify(locales)
        },
      }),
      ui: {
        listView: { fieldMode: 'read' },
        views: './custom-fields/TranslatedLocalesDisplay',
      },
    }),

    // ==================================================================
    // ğŸ–¼ï¸ åª’ä½“ & å…³ç³»
    // ==================================================================

    featuredImage: relationship({
      ref: 'Media',
      many: false,
      ui: {
        displayMode: 'cards',
        cardFields: ['file', 'filename'],
      },
    }),

    category: relationship({
      ref: 'Category',
      many: false,
    }),

    products: relationship({
      ref: 'Product.series',
      many: true,
    }),

    // ==================================================================
    // âš™ï¸ ç³»ç»Ÿå­—æ®µ
    // ==================================================================

    order: integer({ defaultValue: 0 }),

    status: select({
      options: [
        { label: 'Active', value: 'ACTIVE' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'ACTIVE',
      ui: {
        displayMode: 'segmented-control',
      },
    }),

    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
    updatedAt: timestamp({ db: { updatedAt: true } }),
  },

  graphql: {
    plural: 'ProductSeriesItems',
  },

  // ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => true, // ä½¿ç”¨ status: ARCHIVED ä»£æ›¿ç‰©ç†åˆ é™¤
    }
  },

  ui: {
    listView: {
      initialColumns: ['slug', 'translatedLocales', 'category', 'order', 'status'],
    },
    labelField: 'slug',
  }
})
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "id": "ckxxx",
  "slug": "glass-standoff-series",
  "name": {
    "en": "Glass Standoff Series",
    "zh": "å¹¿å‘Šèºä¸ç³»åˆ—"
  },
  "description": {
    "en": "High-quality glass mounting hardware",
    "zh": "é«˜å“è´¨ç»ç’ƒå®‰è£…äº”é‡‘"
  },
  "contentTranslations": [
    {
      "locale": "en",
      "content": [{"type": "paragraph", "children": [{"text": "..."}]}]
    },
    {
      "locale": "zh",
      "content": [{"type": "paragraph", "children": [{"text": "..."}]}]
    }
  ],
  "status": "ACTIVE"
}
```

---

### 6. Product (äº§å“/SKU)

**æ–‡ä»¶ä½ç½®**: `cms/schemas/Product.ts`

**å¤šè¯­è¨€æ–¹æ¡ˆ**ï¼š
- âœ… **JSON æ–¹æ¡ˆ**ï¼šname, shortDescription, description (çŸ­æ–‡æœ¬å­—æ®µ)
- âœ… **å…³ç³»è¡¨æ–¹æ¡ˆ**ï¼šcontentTranslations (å¯Œæ–‡æœ¬å†…å®¹)

```typescript
// cms/schemas/Product.ts
import { list, graphql } from '@keystone-6/core'
import { text, json, select, relationship, timestamp, checkbox, integer, virtual } from '@keystone-6/core/fields'

export const Product = list({
  fields: {
    // SKUï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
    sku: text({
      validation: { isRequired: true },
      isIndexed: 'unique',
    }),

    // Slugï¼ˆURL å‹å¥½æ ‡è¯†ï¼‰
    slug: text({
      validation: { isRequired: true },
      isIndexed: 'unique',
    }),

    // ==================================================================
    // ğŸŒ å¤šè¯­è¨€å­—æ®µï¼šJSON æ–¹æ¡ˆï¼ˆçŸ­æ–‡æœ¬ï¼‰
    // ==================================================================

    // åç§°ï¼ˆå¤šè¯­è¨€ JSONï¼‰
    name: json({
      label: 'Product Name',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONField',
        description: 'Product name in all 24 languages',
      },
    }),

    // ç®€çŸ­æè¿°ï¼ˆå¤šè¯­è¨€ JSONï¼‰
    shortDescription: json({
      label: 'Short Description',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONDocumentField',
        description: 'Brief description in all 24 languages',
      },
    }),

    // å®Œæ•´æè¿°ï¼ˆå¤šè¯­è¨€ JSONï¼‰
    description: json({
      label: 'Full Description',
      defaultValue: {},
      ui: {
        views: './custom-fields/MultilingualJSONDocumentField',
        description: 'Detailed description in all 24 languages',
      },
    }),

    // ==================================================================
    // ğŸŒ å¤šè¯­è¨€å­—æ®µï¼šå…³ç³»è¡¨æ–¹æ¡ˆï¼ˆå¯Œæ–‡æœ¬å†…å®¹ï¼‰
    // ==================================================================

    // å¯Œæ–‡æœ¬å†…å®¹ç¿»è¯‘ï¼ˆå…³ç³»è¡¨ï¼‰
    contentTranslations: relationship({
      ref: 'ProductContentTranslation.product',
      many: true,
      ui: {
        displayMode: 'cards',
        cardFields: ['locale', 'updatedAt'],
        inlineCreate: { fields: ['locale'] },
        inlineEdit: { fields: ['locale', 'content'] },
        linkToItem: true,
        description: 'Click language card to edit rich text content',
      },
    }),

    // è™šæ‹Ÿå­—æ®µï¼šæŒ‰è¯­è¨€æŸ¥è¯¢å†…å®¹
    contentByLocale: virtual({
      field: graphql.field({
        type: graphql.object<{ locale: string; content: any }>()({
          name: 'ProductContentByLocale',
          fields: {
            locale: graphql.field({ type: graphql.String }),
            content: graphql.field({ type: graphql.JSON }),
          },
        }),
        args: {
          locale: graphql.arg({ type: graphql.nonNull(graphql.String) }),
        },
        async resolve(item, { locale }, context) {
          const translations = await context.query.ProductContentTranslation.findMany({
            where: {
              product: { id: { equals: item.id as string } },
              locale: { equals: locale },
            },
            query: 'locale content',
          })
          return translations[0] || { locale, content: null }
        },
      }),
      ui: {
        listView: { fieldMode: 'hidden' },
        itemView: { fieldMode: 'hidden' },
      },
    }),

    // è™šæ‹Ÿå­—æ®µï¼šæ˜¾ç¤ºå·²ç¿»è¯‘çš„è¯­è¨€åˆ—è¡¨
    translatedLocales: virtual({
      field: graphql.field({
        type: graphql.String,
        async resolve(item, args, context) {
          const translations = await context.query.ProductContentTranslation.findMany({
            where: {
              product: { id: { equals: item.id as string } },
            },
            query: 'locale',
          })
          const locales = translations.map((t: any) => String(t.locale))
          return JSON.stringify(locales)
        },
      }),
      ui: {
        listView: { fieldMode: 'read' },
        views: './custom-fields/TranslatedLocalesDisplay',
      },
    }),

    // ==================================================================
    // ğŸ–¼ï¸ åª’ä½“ & å…³ç³»
    // ==================================================================

    images: relationship({
      ref: 'Media',
      many: true,
      ui: {
        displayMode: 'cards',
        cardFields: ['file', 'filename'],
      },
    }),

    featuredImage: relationship({
      ref: 'Media',
      many: false,
      ui: {
        displayMode: 'cards',
        cardFields: ['file', 'filename'],
      },
    }),

    series: relationship({
      ref: 'ProductSeries.products',
      many: false,
    }),

    category: relationship({
      ref: 'Category',
      many: false,
    }),

    // ==================================================================
    // âš™ï¸ ç³»ç»Ÿå­—æ®µ
    // ==================================================================

    isFeatured: checkbox({
      defaultValue: false,
    }),

    order: integer({
      defaultValue: 0,
    }),

    status: select({
      options: [
        { label: 'Active', value: 'ACTIVE' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'ACTIVE',
      ui: {
        displayMode: 'segmented-control',
      },
    }),

    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
    updatedAt: timestamp({ db: { updatedAt: true } }),
  },

  // ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => true, // ä½¿ç”¨ status: ARCHIVED ä»£æ›¿ç‰©ç†åˆ é™¤
    }
  },

  ui: {
    listView: {
      initialColumns: ['sku', 'series', 'category', 'isFeatured', 'status'],
    },
    labelField: 'sku',
  }
})
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "id": "ckxxx",
  "sku": "GDH-001-SS",
  "slug": "glass-door-handle-stainless-steel",
  "name": {
    "en": "Glass Door Handle - Stainless Steel",
    "zh": "ç»ç’ƒé—¨æŠŠæ‰‹ - ä¸é”ˆé’¢"
  },
  "shortDescription": {
    "en": "Premium stainless steel door handle",
    "zh": "ä¼˜è´¨ä¸é”ˆé’¢é—¨æŠŠæ‰‹"
  },
  "contentTranslations": [
    {
      "locale": "en",
      "content": [{"type": "paragraph", "children": [{"text": "..."}]}]
    },
    {
      "locale": "zh",
      "content": [{"type": "paragraph", "children": [{"text": "..."}]}]
    }
  ],
  "isFeatured": true,
  "status": "ACTIVE"
}
```

---

### 7. Blog (åšå®¢æ–‡ç« )

```typescript
// keystone/schemas/Blog.ts
export const Blog = list({
  fields: {
    // æ ‡é¢˜ï¼ˆå¤šè¯­è¨€ï¼‰
    title: json({
      label: 'Title',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // Slug
    slug: text({ isIndexed: 'unique' }),

    // ğŸ”¥ è½¯åˆ é™¤çŠ¶æ€
    status: select({
      options: [
        { label: 'Published', value: 'PUBLISHED' },
        { label: 'Draft', value: 'DRAFT' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'DRAFT'
    }),

    // æ‘˜è¦
    excerpt: json({
      label: 'Excerpt',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // å°é¢å›¾
    coverImage: relationship({ ref: 'Media' }),

    // åˆ†ç±»
    categories: relationship({ 
      ref: 'Category', 
      many: true 
    }),

    // ä½œè€…
    author: text({ defaultValue: 'Busrom Team' }),

    // å†…å®¹
    content: json({
      label: 'Content',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONDocumentField',
      },
    }),

    // SEO
    seo: relationship({ ref: 'GlobalSEO' }),

    // å‘å¸ƒæ—¶é—´
    publishedAt: timestamp(),
    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
    updatedAt: timestamp({ db: { updatedAt: true } }),
  },

  // ğŸ”¥ ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => false,
    }
  }
})
```

---

### 8. Application (åº”ç”¨æ¡ˆä¾‹)

```typescript
// keystone/schemas/Application.ts
export const Application = list({
  fields: {
    // åç§°ï¼ˆå¤šè¯­è¨€ï¼‰
    name: json({
      label: 'Application Name',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // Slug
    slug: text({ isIndexed: 'unique' }),

    // ğŸ”¥ è½¯åˆ é™¤çŠ¶æ€
    status: select({
      options: [
        { label: 'Published', value: 'PUBLISHED' },
        { label: 'Draft', value: 'DRAFT' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'DRAFT'
    }),

    // ä¸»å›¾
    mainImage: relationship({ ref: 'Media' }),

    // ç›¸å†Œ
    images: relationship({ 
      ref: 'Media', 
      many: true 
    }),

    // æè¿°
    description: json({
      label: 'Description',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONDocumentField',
      },
    }),

    // SEO
    seo: relationship({ ref: 'GlobalSEO' }),

    // æ—¶é—´æˆ³
    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
    updatedAt: timestamp({ db: { updatedAt: true } }),
  },

  // ğŸ”¥ ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => false,
    }
  }
})
```

---

### 9. FaqItem (å¸¸è§é—®é¢˜)

```typescript
// keystone/schemas/FaqItem.ts
export const FaqItem = list({
  fields: {
    // é—®é¢˜ï¼ˆå¤šè¯­è¨€ï¼‰
    question: json({
      label: 'Question',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONField',
      },
    }),

    // ç­”æ¡ˆï¼ˆå¤šè¯­è¨€ï¼‰
    answer: json({
      label: 'Answer',
      defaultValue: '{}',
      ui: {
        views: './custom-fields/MultilingualJSONDocumentField',
      },
    }),

    // ğŸ”¥ è½¯åˆ é™¤çŠ¶æ€
    status: select({
      options: [
        { label: 'Published', value: 'PUBLISHED' },
        { label: 'Draft', value: 'DRAFT' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'DRAFT'
    }),

    // åˆ†ç±»
    category: relationship({ ref: 'Category' }),

    // æ’åº
    order: integer({ defaultValue: 0 }),

    // æ—¶é—´æˆ³
    createdAt: timestamp({ defaultValue: { kind: 'now' } }),
  },

  // ğŸ”¥ ç¦ç”¨ç‰©ç†åˆ é™¤
  access: {
    operation: {
      delete: () => false,
    }
  }
})
```

---

### 10. ContactForm (è¡¨å•æäº¤)

```typescript
// keystone/schemas/ContactForm.ts
export const ContactForm = list({
  fields: {
    // è¡¨å•å­—æ®µ
    name: text({ validation: { isRequired: true } }),
    email: text({ validation: { isRequired: true } }),
    whatsapp: text(),
    companyName: text(),
    message: text({ 
      ui: { displayMode: 'textarea' },
      validation: { isRequired: true }
    }),

    // å¤„ç†çŠ¶æ€
    status: select({
      options: [
        { label: 'Unread', value: 'UNREAD' },
        { label: 'Read', value: 'READ' },
        { label: 'Archived', value: 'ARCHIVED' },
      ],
      defaultValue: 'UNREAD'
    }),

    // è¿½è¸ªå­—æ®µ
    source: text(), // æ¥æºé¡µé¢æˆ–äº§å“ SKU
    locale: text(), // ç”¨æˆ·è¯­è¨€
    ipAddress: text(),
    userAgent: text(),

    // æ—¶é—´æˆ³
    submittedAt: timestamp({ defaultValue: { kind: 'now' } }),
  },

  // è¡¨å•æ•°æ®å¯ä»¥ç‰©ç†åˆ é™¤ï¼ˆç‰¹æ®Šæƒ…å†µï¼‰
  access: {
    operation: {
      create: () => true,
      delete: ({ session }) => session?.data.role === 'ADMIN',
    }
  },

  ui: {
    listView: {
      initialColumns: ['name', 'email', 'status', 'submittedAt'],
      initialSort: { field: 'submittedAt', direction: 'DESC' },
    }
  }
})
```

---

## ğŸ”‘ å…³é”®è®¾è®¡æ¨¡å¼

### 1. å¤šè¯­è¨€å®ç°

**æ‰€æœ‰æ–‡æœ¬å­—æ®µä½¿ç”¨ JSON æ ¼å¼**ï¼š
```typescript
name: json({
  label: 'Name',
  defaultValue: '{}',
  ui: {
    views: './custom-fields/MultilingualJSONField',
  },
})
```

**æ•°æ®æ ¼å¼**ï¼š
```json
{
  "en": "Glass Standoff",
  "zh": "å¹¿å‘Šèºä¸",
  "es": "Tornillo de soporte de vidrio"
}
```

---

### 2. è½¯åˆ é™¤æœºåˆ¶

**æ‰€æœ‰å†…å®¹æ¨¡å‹ä½¿ç”¨ `status` å­—æ®µ**ï¼š
```typescript
status: select({
  options: [
    { label: 'Published', value: 'PUBLISHED' },
    { label: 'Draft', value: 'DRAFT' },
    { label: 'Archived', value: 'ARCHIVED' },
  ],
  defaultValue: 'DRAFT'
})
```

**ç¦ç”¨ç‰©ç†åˆ é™¤**ï¼š
```typescript
access: {
  operation: {
    delete: () => false, // ç¦ç”¨åˆ é™¤æŒ‰é’®
  }
}
```

---

### 3. åª’ä½“åˆ†ç±»ç³»ç»Ÿ

**æ··åˆæ–¹æ¡ˆ**ï¼š
- **ä¸»åˆ†ç±»ï¼ˆMediaCategoryï¼‰**ï¼šæ ‘å½¢ç»“æ„ï¼Œæœ€å¤š3å±‚
- **æ ‡ç­¾ï¼ˆMediaTagï¼‰**ï¼šæ‰å¹³å¤šå¯¹å¤š
- **å…ƒæ•°æ®ï¼ˆmetadataï¼‰**ï¼šJSON æ ¼å¼å­˜å‚¨é¢å¤–å±æ€§

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [02-å¤šè¯­è¨€æ–¹æ¡ˆ.md](./02-å¤šè¯­è¨€æ–¹æ¡ˆ.md) - JSON å¤šè¯­è¨€å®ç°è¯¦è§£
- [åª’ä½“åˆ†ç±»ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ](../../åª’ä½“åˆ†ç±»ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ.md) - å®Œæ•´çš„åˆ†ç±»ç³»ç»Ÿè®¾è®¡

---

**è¿”å›**: [README.md](./README.md)