# 01 - 前端开发指南

> **阅读时间**: 15 分钟  
> **适用对象**: 前端开发工程师

---

## ✅ 开发任务清单

### Phase 1: 项目初始化 (优先级: P0)
- [ ] 创建 Next.js 15 项目 (App Router)
- [ ] 配置 Tailwind CSS
- [ ] 配置 TypeScript
- [ ] 配置 i18n 路由 (middleware.ts)
- [ ] 创建基础目录结构

### Phase 2: 核心组件开发 (优先级: P0)
- [ ] Header / Navigation 组件
- [ ] Footer 组件
- [ ] SEO 组件 (generateMetadata)
- [ ] 多语言切换组件

### Phase 3: 首页开发 (优先级: P0)
- [ ] 实现所有 16 个首页区块 (见下文详细清单)
- [ ] 对接 `/api/v1/home` 接口
- [ ] 实现 SWR 数据刷新

### Phase 4: 其他页面开发 (优先级: P1)
- [ ] Product 系列页
- [ ] Shop 产品列表页
- [ ] Service 相关页面
- [ ] About Us 相关页面
- [ ] Contact Us 页面

### Phase 5: 优化与测试 (优先级: P2)
- [ ] 性能优化 (Code Splitting, Lazy Loading)
- [ ] SEO 优化验证
- [ ] 响应式测试 (多设备)
- [ ] 浏览器兼容性测试

---

## 📂 项目目录结构

```
busrom-frontend/
├── app/
│   ├── [locale]/              # 动态语言路由
│   │   ├── page.tsx           # 首页 (Server Component)
│   │   ├── layout.tsx         # 根布局
│   │   ├── product/
│   │   │   ├── page.tsx       # 产品系列列表
│   │   │   └── [series]/
│   │   │       └── page.tsx   # 系列详情
│   │   ├── shop/
│   │   │   ├── page.tsx       # 产品列表
│   │   │   └── [sku]/
│   │   │       └── page.tsx   # 产品详情
│   │   ├── service/
│   │   ├── about-us/
│   │   └── contact-us/
│   └── api/                   # Next.js API Routes (可选)
├── components/
│   ├── layout/                # 布局组件
│   │   ├── Header.tsx
│   │   ├── Footer.tsx
│   │   └── Navigation.tsx
│   ├── home/                  # 首页专用组件
│   │   ├── hero-banner.tsx
│   │   ├── product-series-carousel.tsx
│   │   └── ... (16个区块组件)
│   ├── ui/                    # 通用 UI 组件
│   │   ├── Button.tsx
│   │   ├── Card.tsx
│   │   └── ...
│   └── SEO.tsx                # SEO 组件
├── lib/
│   ├── api.ts                 # API 调用函数
│   ├── i18n.ts                # 多语言工具函数
│   └── utils.ts               # 通用工具函数
├── public/
│   ├── images/
│   └── icons/
├── styles/
│   └── globals.css            # Tailwind 入口
├── middleware.ts              # i18n 中间件
├── i18n.config.ts             # i18n 配置
└── languages.ts               # 24+ 语言定义
```

---

## 🏠 首页开发 - 16 个区块详细清单

### 已完成的组件 (参考现有代码)

以下组件已经实现，需要进行**样式调整和数据对接**：

| 区块名称 | 组件路径 | 待办事项 | 数据字段 |
|---------|---------|---------|---------|
| **1. Hero Banner** | `components/home/hero-banner.tsx`<br>`components/HeroBanner/HeroBanner1-9.tsx` | • 最终确定字体大小和行高<br>• 统一图片路径到 `/public/` | `content.heroBanner[]` |
| **2. 产品系列轮播** | `components/home/product-series-carousel.tsx` | • 优化动画流畅度<br>• 确保点击跳转到 `/product/[series]` | `content.productSeriesCarousel[]` |
| **3. 服务特点** | `components/home/service-features.tsx` | • 调整进度条节点位置<br>• 确认品牌配色 | `content.serviceFeatures` |
| **4. 3D 球体** | `components/home/sphere-3d.tsx` | • **核心开发**: 使用 Three.js 实现<br>• 移动端显示占位符 | `content.sphere3d` |
| **5. 表单跳转引导** | `components/home/simple-cta.tsx` | • 精确调整图片错位百分比<br>• SVG 线条响应式处理 | `content.simpleCta` |
| **6. 产品系列介绍** | `components/home/series-intro.tsx` | • 确保卡片尺寸动态计算准确<br>• 使用真实图片替换假图 | `content.seriesIntro[]` |
| **7. 精选产品** | `components/home/featured-products.tsx` | • 优化 hover 效果<br>• 水平滚动体验优化 | `content.featuredProducts` |
| **8. 品牌优势** | `components/home/brand-advantages.tsx` | • 调试滚动吸附逻辑<br>• 确定椭圆定位百分比 | `content.brandAdvantages` |
| **9. OEM/ODM** | `components/home/oem-odm.tsx` | • 精确调整 clipPath 百分比<br>• 处理 z-index 重叠 | `content.oemOdm` |
| **10. 获取报价** | `components/home/quote-steps.tsx` | • 调试图片定位算法<br>• 确保轮播自动重启 | `content.quoteSteps` |
| **11. 表单** | `components/home/main-form.tsx` | • 添加客户端验证<br>• 对接提交 API | `content.mainForm` |
| **12. 为什么选择** | `components/home/why-choose-busrom.tsx` | • 完善图标映射<br>• 检查动画延迟 | `content.whyChooseBusrom` |
| **13. 精选案例** | `components/home/case-studies.tsx` | • 确保轮播布局正确重叠 | `content.caseStudies` |
| **14. 品牌分析** | `components/home/brand-analysis.tsx` | • 同步 SVG 轮播与描述 | `content.brandAnalysis` |
| **15. 品牌价值** | `components/home/brand-value.tsx` | • 调试手风琴高度过渡 | `content.brandValue` |
| **16. Footer** | (复用全局 Footer) | • 对接多语言数据 | `content.footer` |

---

## 🔌 API 对接规范

### 数据获取流程

```typescript
// app/[locale]/page.tsx (Server Component)
import { getHomeContent } from '@/lib/api'

export default async function HomePage({ params }: { params: { locale: string } }) {
  // 服务端获取初始数据
  const initialContent = await getHomeContent(params.locale)
  
  return <HomePageClient initialContent={initialContent} locale={params.locale} />
}

// components/HomePageClient.tsx (Client Component)
'use client'
import useSWR from 'swr'

export default function HomePageClient({ initialContent, locale }) {
  // 客户端使用 SWR 刷新数据
  const { data: content } = useSWR(
    `/api/v1/home?locale=${locale}`,
    fetcher,
    { fallbackData: initialContent }
  )
  
  return (
    <>
      <HeroBanner data={content.heroBanner} />
      <ProductSeriesCarousel data={content.productSeriesCarousel} />
      {/* ... 其他组件 */}
    </>
  )
}
```

### API 调用函数

```typescript
// lib/api.ts
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001'

export async function getHomeContent(locale: string) {
  const res = await fetch(`${API_BASE_URL}/api/v1/home?locale=${locale}`, {
    next: { revalidate: 3600 } // ISR: 1小时
  })
  
  if (!res.ok) {
    throw new Error('Failed to fetch home content')
  }
  
  return res.json()
}

export async function getProductSeries(locale: string) {
  const res = await fetch(`${API_BASE_URL}/api/v1/product/series?locale=${locale}`)
  return res.json()
}

// ... 其他 API 函数
```

---

## 🌐 多语言实现

### middleware.ts

```typescript
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'
import { languages, DEFAULT_LANGUAGE } from './languages'

export function middleware(request: NextRequest) {
  const pathname = request.nextUrl.pathname
  
  // 检查路径是否已包含语言代码
  const pathnameHasLocale = languages.some(
    (lang) => pathname.startsWith(`/${lang.code}/`) || pathname === `/${lang.code}`
  )
  
  if (pathnameHasLocale) return NextResponse.next()
  
  // 获取访客偏好语言
  let locale = DEFAULT_LANGUAGE
  
  // 1. 优先检查 Cookie
  const localeCookie = request.cookies.get('NEXT_LOCALE')?.value
  if (localeCookie && languages.some(l => l.code === localeCookie)) {
    locale = localeCookie
  } else {
    // 2. 其次检查 Accept-Language 头
    const acceptLang = request.headers.get('accept-language')
    if (acceptLang) {
      const preferred = acceptLang.split(',')[0].split('-')[0]
      if (languages.some(l => l.code === preferred)) {
        locale = preferred
      }
    }
  }
  
  // 重定向到语言路径
  const url = request.nextUrl.clone()
  url.pathname = `/${locale}${pathname}`
  return NextResponse.redirect(url)
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)']
}
```

---

## 🎨 Tailwind CSS 使用规范

### 禁止事项

❌ **严禁**混用以下内容：
- Bootstrap、Foundation 等其他 CSS 框架
- 大段自定义 CSS 类
- Inline styles (除非动态计算必需)

### 推荐实践

✅ **必须**使用 Tailwind 原子类：

```tsx
// ✅ 正确
<div className="flex items-center justify-between px-4 py-2 bg-white shadow-md">
  <h1 className="text-2xl font-bold text-gray-900">Title</h1>
</div>

// ❌ 错误
<div className="my-custom-header">
  <h1 style={{ fontSize: '24px', fontWeight: 'bold' }}>Title</h1>
</div>
```

### 响应式设计

```tsx
<div className="
  w-full              // Mobile: 全宽
  md:w-1/2            // Tablet: 50%
  lg:w-1/3            // Desktop: 33.33%
  px-4                // 水平内边距
  py-8 md:py-12       // 垂直内边距 (响应式)
">
  <img 
    src="/image.jpg" 
    alt="Description"
    className="w-full h-auto rounded-lg shadow-lg"
  />
</div>
```

---

## 🖼️ 图片优化

### Next.js Image 组件

```tsx
import Image from 'next/image'

// ✅ 推荐：使用 Next.js Image 组件
<Image
  src={content.heroBanner[0].image}  // S3 URL
  alt={content.heroBanner[0].title}
  width={1920}
  height={1080}
  priority                            // 首屏图片
  quality={90}
/>

// ✅ 响应式图片
<Image
  src="/hero.jpg"
  alt="Hero"
  fill                                // 填充父容器
  className="object-cover"
  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
/>
```

---

## 🔍 SEO 实现

### generateMetadata 函数

```typescript
// app/[locale]/product/[series]/page.tsx
import type { Metadata } from 'next'

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const series = await getProductSeries(params.series, params.locale)
  
  return {
    title: series.seo.title,
    description: series.seo.description,
    openGraph: {
      title: series.seo.title,
      description: series.seo.description,
      images: [series.seo.ogImage],
      url: `https://busrom.com/${params.locale}/product/${params.series}`,
    },
    alternates: {
      canonical: `https://busrom.com/${params.locale}/product/${params.series}`,
      languages: {
        'en': `/en/product/${params.series}`,
        'zh': `/zh/product/${params.series}`,
        'es': `/es/product/${params.series}`,
        // ... 其他 24+ 语言
      }
    },
    robots: {
      index: true,
      follow: true,
    }
  }
}
```

### 结构化数据

```tsx
// components/ProductSchema.tsx
export function ProductSchema({ product }: { product: Product }) {
  const schema = {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": product.name,
    "image": product.mainImage,
    "description": product.seo.description,
    "brand": {
      "@type": "Brand",
      "name": "Busrom"
    },
    "offers": {
      "@type": "Offer",
      "availability": "https://schema.org/InStock",
      "priceCurrency": "USD"
    }
  }
  
  return (
    <script
      type="application/ld+json"
      dangerouslySetInnerHTML={{ __html: JSON.stringify(schema) }}
    />
  )
}
```

---

## 📊 性能优化清单

- [ ] 使用 `next/image` 自动优化图片
- [ ] 首屏内容使用 `priority` 属性
- [ ] 非首屏组件使用 `dynamic` 懒加载
- [ ] 使用 `revalidate` 实现 ISR (Incremental Static Regeneration)
- [ ] 避免在 Server Component 中使用 `useState`/`useEffect`
- [ ] 使用 `loading.tsx` 提供加载状态
- [ ] 字体优化：使用 `next/font`

---

## 🧪 测试清单

### 响应式测试设备

- [ ] iPhone SE (375px)
- [ ] iPhone 14 Pro (430px)
- [ ] iPad (768px)
- [ ] iPad Pro (1024px)
- [ ] Desktop (1440px)
- [ ] Large Desktop (1920px)

### 浏览器测试

- [ ] Chrome (最新版)
- [ ] Safari (最新版)
- [ ] Firefox (最新版)
- [ ] Edge (最新版)

### SEO 验收

- [ ] Lighthouse SEO 分数 > 95
- [ ] 所有图片有 alt 属性
- [ ] 所有页面有 unique title/description
- [ ] sitemap.xml 可访问
- [ ] robots.txt 可访问

---

## 🤖 Claude Code Prompt 模板

```markdown
你好，我需要你帮我开发 Busrom 网站的前端页面。

**项目背景**：
- 技术栈：Next.js 14 (App Router) + Tailwind CSS + TypeScript
- 需求文档：请仔细阅读 `/docs/01-前端开发指南.md`

**你的任务**：
[Phase 1] 创建项目基础架构和 i18n 配置
[Phase 2] 开发首页的 16 个区块组件
[Phase 3] 对接后端 API `/api/v1/home`

**具体要求**：
- 严格使用 Tailwind CSS，禁用 Bootstrap
- 所有图片必须有 alt 属性
- 实现完整的响应式设计
- 确保 SEO 最佳实践

**验收标准**：
- [ ] 所有组件已实现
- [ ] Lighthouse Performance > 90
- [ ] Lighthouse SEO > 95
- [ ] 多语言切换正常工作

请开始工作，并在完成后向我汇报。
```

---

**文档版本**: v1.0  
**最后更新**: 2025-10-31