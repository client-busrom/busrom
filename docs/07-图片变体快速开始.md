# å›¾ç‰‡å˜ä½“å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿä¸Šæ‰‹

### ç¬¬ä¸€æ­¥: ä¸Šä¼ å›¾ç‰‡åˆ°CMS

1. ç™»å½• Keystone CMS åå°
2. è¿›å…¥ **Media** ç®¡ç†é¡µé¢
3. ç‚¹å‡» **Create Media** æŒ‰é’®
4. ä¸Šä¼ å›¾ç‰‡å¹¶å¡«å†™ä¿¡æ¯:
   - Filename: äº§å“åç§° (å¦‚: `glass-standoff-black-50mm`)
   - Alt Text: ä¸ºæ¯ä¸ªè¯­è¨€å¡«å†™æè¿° (å¿…å¡«ï¼Œå¯¹SEOé‡è¦)
   - Primary Category: é€‰æ‹©ä¸»åˆ†ç±»
   - Tags: é€‰æ‹©ç›¸å…³æ ‡ç­¾
5. ç‚¹å‡» **Save** ä¿å­˜

### ç¬¬äºŒæ­¥: æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„å˜ä½“

ä¿å­˜åï¼Œé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚å‘ä¸‹æ»šåŠ¨åˆ° **Image Variants (å›¾ç‰‡å˜ä½“)** åŒºåŸŸï¼Œä½ ä¼šçœ‹åˆ°:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… å·²ç”Ÿæˆ 6 ä¸ªå›¾ç‰‡å˜ä½“                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ–¼ï¸ Thumbnail (ç¼©ç•¥å›¾) - 150Ã—150            â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â”‚                                             â”‚
â”‚ ğŸ“± Small (ç§»åŠ¨ç«¯) - 400px                  â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â”‚                                             â”‚
â”‚ ğŸ’» Medium (å¹³æ¿) - 800px                   â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â”‚                                             â”‚
â”‚ ğŸ–¥ï¸ Large (æ¡Œé¢) - 1200px                   â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â”‚                                             â”‚
â”‚ ğŸ“º XLarge (å…¨å±) - 1920px                  â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â”‚                                             â”‚
â”‚ âš¡ WebP (WebPæ ¼å¼) - Optimized             â”‚
â”‚    [é¢„è§ˆ] [å¤åˆ¶URL]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **æç¤º**: å¦‚æœçœ‹åˆ°"â³ ç”Ÿæˆä¸­..."ï¼Œç­‰å¾…10-30ç§’ååˆ·æ–°é¡µé¢ã€‚

### ç¬¬ä¸‰æ­¥: åœ¨å‰ç«¯ä½¿ç”¨å˜ä½“

#### æ–¹å¼1: æœ€ç®€å• - å“åº”å¼å›¾ç‰‡ç»„ä»¶

åˆ›å»º `components/ResponsiveImage.tsx`:

```tsx
import Image from 'next/image'

interface MediaFile {
  url: string
  altText: { [key: string]: string }
  variants?: {
    small?: string
    medium?: string
    large?: string
    xlarge?: string
    webp?: string
  }
}

export function ResponsiveImage({
  media,
  locale = 'en',
}: {
  media: MediaFile
  locale?: string
}) {
  const alt = media.altText?.[locale] || 'Product image'
  const variants = media.variants

  // å¦‚æœæ²¡æœ‰å˜ä½“ï¼Œä½¿ç”¨åŸå›¾
  if (!variants) {
    return <img src={media.url} alt={alt} />
  }

  return (
    <picture>
      {/* WebP - ç°ä»£æµè§ˆå™¨ */}
      <source
        type="image/webp"
        srcSet={`
          ${variants.small} 400w,
          ${variants.medium} 800w,
          ${variants.large} 1200w,
          ${variants.xlarge} 1920w
        `}
        sizes="(max-width: 640px) 400px, (max-width: 1024px) 800px, 1200px"
      />

      {/* JPEG - æ—§æµè§ˆå™¨å›é€€ */}
      <img
        src={variants.large || media.url}
        alt={alt}
        loading="lazy"
      />
    </picture>
  )
}
```

**ä½¿ç”¨:**

```tsx
// åœ¨ä»»ä½•é¡µé¢ä½¿ç”¨
import { ResponsiveImage } from '@/components/ResponsiveImage'

export default function ProductPage({ product }) {
  return (
    <div>
      <ResponsiveImage media={product.images[0]} locale="en" />
    </div>
  )
}
```

#### æ–¹å¼2: æ ¹æ®åœºæ™¯é€‰æ‹©å°ºå¯¸

```tsx
// äº§å“åˆ—è¡¨ç¼©ç•¥å›¾
<img src={product.image.variants.thumbnail} alt={product.name} />

// ç§»åŠ¨ç«¯äº§å“è¯¦æƒ…
<img src={product.image.variants.small} alt={product.name} />

// æ¡Œé¢äº§å“è¯¦æƒ…
<img src={product.image.variants.large} alt={product.name} />

// å…¨å±è½®æ’­å›¾
<img src={product.image.variants.xlarge} alt={product.name} />
```

#### æ–¹å¼3: GraphQLæŸ¥è¯¢

```graphql
query GetProduct($sku: String!) {
  product(where: { sku: $sku }) {
    name
    images {
      file {
        url
      }
      altText
      variants  # åŒ…å«æ‰€æœ‰å˜ä½“
    }
  }
}
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| ä½¿ç”¨åœºæ™¯ | ä½¿ç”¨åŸå›¾ | ä½¿ç”¨å˜ä½“ | èŠ‚çœ |
|---------|---------|---------|------|
| ç§»åŠ¨ç«¯åˆ—è¡¨ | 3.5MB | 50KB | **98.6%** |
| å¹³æ¿è¯¦æƒ…é¡µ | 3.5MB | 180KB | **94.9%** |
| æ¡Œé¢äº§å“é¡µ | 3.5MB | 420KB | **88.0%** |

## âš¡ ä¼˜åŒ–å»ºè®®

### 1. ç¼©ç•¥å›¾åœºæ™¯ (åˆ—è¡¨/ç½‘æ ¼)
```tsx
<img src={image.variants.thumbnail} />
```

### 2. ç§»åŠ¨ç«¯åœºæ™¯
```tsx
<img src={image.variants.small} />
```

### 3. æ¡Œé¢ç«¯åœºæ™¯
```tsx
<img src={image.variants.large} />
```

### 4. Heroè½®æ’­åœºæ™¯
```tsx
<img src={image.variants.xlarge} />
```

### 5. ä¼˜å…ˆä½¿ç”¨WebP
```tsx
<picture>
  <source type="image/webp" srcSet={image.variants.webp} />
  <img src={image.variants.large} />
</picture>
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜: variantså­—æ®µä¸ºç©º {}

**åŸå› **: S3é…ç½®æœªå®Œæˆæˆ–ç”Ÿæˆå¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥ `cms/.env` ä¸­çš„S3é…ç½®
2. æŸ¥çœ‹CMSæ§åˆ¶å°æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
3. ç­‰å¾…10-30ç§’ååˆ·æ–°é¡µé¢

### é—®é¢˜: å˜ä½“URLè®¿é—®404

**åŸå› **: S3æƒé™è®¾ç½®é—®é¢˜

**è§£å†³**:
1. ç¡®è®¤S3 bucketè®¾ç½®ä¸ºå…¬å¼€è¯»å–
2. æ£€æŸ¥CDNé…ç½®æ˜¯å¦æ­£ç¡®
3. æµ‹è¯•ç›´æ¥è®¿é—®S3 URL

## ğŸ“š æ›´å¤šèµ„æº

- [å®Œæ•´ä½¿ç”¨æŒ‡å—](./07-å›¾ç‰‡å˜ä½“ä½¿ç”¨æŒ‡å—.md)
- [APIæ–‡æ¡£](./02-APIæ¥å£è§„èŒƒ.md)
- [æ€§èƒ½ä¼˜åŒ–å»ºè®®](./04-å®‰å…¨ä¸æ€§èƒ½.md)

---

**ä¸‹ä¸€æ­¥**: æŸ¥çœ‹ [å®Œæ•´ä½¿ç”¨æŒ‡å—](./07-å›¾ç‰‡å˜ä½“ä½¿ç”¨æŒ‡å—.md) äº†è§£æ›´å¤šé«˜çº§ç”¨æ³•
