# ğŸš€ Busrom å®Œæ•´æƒé™è®¾ç½®æŒ‡å—

## ä¸ºä»€ä¹ˆéœ€è¦æ›´å¤šæƒé™ï¼Ÿ

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼ŒBusrom é¡¹ç›®å°†ä½¿ç”¨ä»¥ä¸‹ AWS æœåŠ¡ï¼š

### å½“å‰éœ€è¦çš„æœåŠ¡ï¼š
- âœ… **ECR** - Docker é•œåƒå­˜å‚¨
- âœ… **ECS** - å®¹å™¨è¿è¡Œ
- âœ… **S3** - åª’ä½“æ–‡ä»¶å­˜å‚¨
- âœ… **RDS** - PostgreSQL æ•°æ®åº“
- âœ… **CloudWatch** - æ—¥å¿—å’Œç›‘æ§
- âœ… **Secrets Manager** - å¯†é’¥ç®¡ç†
- âœ… **ELB** - è´Ÿè½½å‡è¡¡
- âœ… **VPC** - ç½‘ç»œé…ç½®
- âœ… **IAM** - æƒé™ç®¡ç†

### æœªæ¥éœ€è¦çš„æœåŠ¡ï¼š
- ğŸ¤– **SageMaker** - LightGBM æ¨¡å‹è®­ç»ƒå’Œæ¨ç†
- ğŸ§  **Bedrock** (å¯é€‰) - AWS æ‰˜ç®¡çš„ AI æ¨¡å‹
- ğŸ”„ **Lambda** - Serverless å‡½æ•°ï¼ˆå¯èƒ½ç”¨äº API é›†æˆï¼‰
- ğŸ“Š **DynamoDB** - NoSQL æ•°æ®åº“ï¼ˆç”¨äºé«˜æ€§èƒ½æ•°æ®å­˜å‚¨ï¼‰
- ğŸŒ **API Gateway** - API ç®¡ç†ï¼ˆå¯èƒ½ç”¨äº Gemini API ä»£ç†ï¼‰
- â˜ï¸ **CloudFront** - CDN åŠ é€Ÿ

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: AdministratorAccessï¼ˆæœ€æ¨è â­â­â­â­â­ï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**
- å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- éœ€è¦é¢‘ç¹å°è¯•æ–° AWS æœåŠ¡
- ä¸ªäººæˆ–å°å›¢é˜Ÿé¡¹ç›®
- å¿«é€ŸåŸå‹å¼€å‘

**ä¼˜ç‚¹ï¼š**
- âœ… ä¸€æ¬¡æ€§é…ç½®ï¼Œæ— éœ€åå¤æ·»åŠ æƒé™
- âœ… å¯ä»¥ä½¿ç”¨ä»»ä½• AWS æœåŠ¡
- âœ… çœæ—¶çœåŠ›ï¼Œä¸“æ³¨äºå¼€å‘

**ç¼ºç‚¹ï¼š**
- âš ï¸ æƒé™å¾ˆå¤§ï¼Œéœ€è¦å¦¥å–„ä¿ç®¡è®¿é—®å¯†é’¥
- âš ï¸ ä¸ç¬¦åˆæœ€å°æƒé™åŸåˆ™

**å¦‚ä½•é™„åŠ ï¼š**

è®© AWS ç®¡ç†å‘˜è¿è¡Œï¼š

```bash
./scripts/attach-full-permissions.sh busrom-develop
# ç„¶åé€‰æ‹© 1
```

æˆ–ç›´æ¥è¿è¡Œï¼š

```bash
aws iam attach-user-policy \
  --user-name busrom-develop \
  --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
```

**AWS æ§åˆ¶å°æ–¹å¼ï¼š**
1. è¿›å…¥ IAM â†’ ç”¨æˆ· â†’ busrom-develop
2. æƒé™ â†’ æ·»åŠ æƒé™ â†’ é™„åŠ ç­–ç•¥
3. æœç´¢å¹¶å‹¾é€‰ `AdministratorAccess`
4. ç‚¹å‡»æ·»åŠ æƒé™

---

### æ–¹æ¡ˆ 2: æ‰©å±•æœåŠ¡æƒé™é›†ï¼ˆæ›´å®‰å…¨ â­â­â­â­ï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**
- éœ€è¦å¤šä¸ªæœåŠ¡ä½†ä¸æƒ³ç»™å®Œå…¨ç®¡ç†å‘˜æƒé™
- ç¬¦åˆå…¬å¸å®‰å…¨æ”¿ç­–
- ç”Ÿäº§ç¯å¢ƒï¼ˆä½†ä»éœ€ç»†åŒ–ï¼‰

**åŒ…å«çš„æœåŠ¡æƒé™ï¼š**

```bash
# æ ¸å¿ƒéƒ¨ç½²æœåŠ¡ï¼ˆ9ä¸ªï¼‰
- AmazonEC2ContainerRegistryFullAccess
- AmazonECS_FullAccess
- AmazonS3FullAccess
- AmazonRDSFullAccess
- CloudWatchLogsFullAccess
- SecretsManagerReadWrite
- ElasticLoadBalancingFullAccess
- AmazonVPCFullAccess
- IAMFullAccess

# AI/ML æœåŠ¡ï¼ˆ2ä¸ªï¼‰
- AmazonSageMakerFullAccess          # LightGBM æ¨¡å‹è®­ç»ƒ
- AmazonBedrockFullAccess             # AWS AI æ¨¡å‹ï¼ˆå¯é€‰ï¼‰

# æ•°æ®å’Œåˆ†æï¼ˆ3ä¸ªï¼‰
- AmazonDynamoDBFullAccess            # NoSQL æ•°æ®åº“
- AmazonElastiCacheFullAccess         # Redis/Memcached ç¼“å­˜
- AmazonKinesisFullAccess             # å®æ—¶æ•°æ®æµ

# å…¶ä»–å¸¸ç”¨æœåŠ¡ï¼ˆ5ä¸ªï¼‰
- CloudFrontFullAccess                # CDN
- AmazonSNSFullAccess                 # æ¶ˆæ¯æ¨é€
- AmazonSQSFullAccess                 # æ¶ˆæ¯é˜Ÿåˆ—
- AWSLambda_FullAccess                # Serverless å‡½æ•°
- AmazonAPIGatewayAdministrator       # API ç½‘å…³

# å¼€å‘å·¥å…·ï¼ˆ3ä¸ªï¼‰
- AWSCodeBuildAdminAccess             # æ„å»º
- AWSCodeDeployFullAccess             # éƒ¨ç½²
- AWSCodePipelineFullAccess           # CI/CD æµæ°´çº¿
```

**å¦‚ä½•é™„åŠ ï¼š**

```bash
./scripts/attach-full-permissions.sh busrom-develop
# ç„¶åé€‰æ‹© 2
```

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | AdministratorAccess | æ‰©å±•æƒé™é›† | æœ€å°æƒé™ |
|------|-------------------|-----------|---------|
| **æ˜“ç”¨æ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­ |
| **å®‰å…¨æ€§** | â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| **çµæ´»æ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­ |
| **ç»´æŠ¤æˆæœ¬** | â­â­â­â­â­ | â­â­â­ | â­ |
| **é€‚ç”¨åœºæ™¯** | å¼€å‘ç¯å¢ƒ | å¼€å‘/é¢„å‘å¸ƒ | ç”Ÿäº§ç¯å¢ƒ |

---

## ğŸ¤– å…³äº SageMaker å’Œ Gemini API

### SageMaker ä½¿ç”¨è¯´æ˜

æ·»åŠ  `AmazonSageMakerFullAccess` åï¼Œæ‚¨å¯ä»¥ï¼š

1. **è®­ç»ƒ LightGBM æ¨¡å‹ï¼š**
```python
# ç¤ºä¾‹ä»£ç ç»“æ„
import sagemaker
from sagemaker import get_execution_role

role = get_execution_role()
session = sagemaker.Session()

# ä¸Šä¼ è®­ç»ƒæ•°æ®åˆ° S3
train_data = session.upload_data(
    path='data/train.csv',
    bucket='busrom-ml-data-staging',
    key_prefix='lightgbm/train'
)

# ä½¿ç”¨ SageMaker LightGBM å®¹å™¨
from sagemaker.sklearn.estimator import SKLearn

lightgbm_estimator = SKLearn(
    entry_point='train.py',
    role=role,
    instance_type='ml.m5.xlarge',
    framework_version='0.23-1'
)

lightgbm_estimator.fit({'train': train_data})
```

2. **éƒ¨ç½²æ¨¡å‹æ¨ç†ç«¯ç‚¹ï¼š**
```python
predictor = lightgbm_estimator.deploy(
    initial_instance_count=1,
    instance_type='ml.t2.medium'
)
```

### Gemini API é›†æˆè¯´æ˜

Gemini API æ˜¯ Google çš„æœåŠ¡ï¼Œä¸éœ€è¦ AWS æƒé™ã€‚ä½†æ‚¨å¯èƒ½éœ€è¦ï¼š

1. **åœ¨ AWS Secrets Manager å­˜å‚¨ Gemini API Keyï¼š**
```bash
aws secretsmanager create-secret \
  --name busrom/staging/GEMINI_API_KEY \
  --secret-string "your-gemini-api-key-here"
```

2. **åœ¨åº”ç”¨ä»£ç ä¸­è°ƒç”¨ï¼š**
```typescript
// ä» Secrets Manager è·å– API Key
import { SecretsManagerClient, GetSecretValueCommand } from "@aws-sdk/client-secrets-manager";

const client = new SecretsManagerClient({ region: "us-east-1" });
const response = await client.send(
  new GetSecretValueCommand({ SecretId: "busrom/staging/GEMINI_API_KEY" })
);
const geminiApiKey = response.SecretString;

// è°ƒç”¨ Gemini API
import { GoogleGenerativeAI } from "@google/generative-ai";

const genAI = new GoogleGenerativeAI(geminiApiKey);
const model = genAI.getGenerativeModel({ model: "gemini-pro" });

const result = await model.generateContent(
  "æ ¹æ®ä»¥ä¸‹å†…å®¹ç”Ÿæˆ SEO ä¼˜åŒ–å»ºè®®: " + pageContent
);
```

3. **æˆ–ä½¿ç”¨ Lambda ä½œä¸ºä»£ç†ï¼š**
```bash
# Lambda å¯ä»¥å®šæœŸè°ƒç”¨ Gemini API å¹¶ç¼“å­˜ç»“æœ
# è¿™æ ·å¯ä»¥å‡å°‘ API è°ƒç”¨æ¬¡æ•°å’Œæˆæœ¬
```

---

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. å¯ç”¨ MFAï¼ˆå¤šå› ç´ è®¤è¯ï¼‰

```bash
# ä¸º IAM ç”¨æˆ·å¯ç”¨ MFA
aws iam enable-mfa-device \
  --user-name busrom-develop \
  --serial-number arn:aws:iam::660753258365:mfa/busrom-develop \
  --authentication-code1 123456 \
  --authentication-code2 789012
```

### 2. å®šæœŸè½®æ¢è®¿é—®å¯†é’¥

```bash
# æ¯ 90 å¤©åˆ›å»ºæ–°å¯†é’¥
aws iam create-access-key --user-name busrom-develop

# åˆ é™¤æ—§å¯†é’¥
aws iam delete-access-key \
  --user-name busrom-develop \
  --access-key-id AKIA_OLD_KEY
```

### 3. ç›‘æ§å¯ç–‘æ´»åŠ¨

åœ¨ CloudWatch è®¾ç½®å‘Šè­¦ï¼š
- ç™»å½•å¤±è´¥æ¬¡æ•°è¿‡å¤š
- å¼‚å¸¸çš„ API è°ƒç”¨
- æ¥è‡ªå¼‚å¸¸åœ°ç†ä½ç½®çš„è®¿é—®

### 4. ç¯å¢ƒéš”ç¦»

```bash
# ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºä¸åŒçš„ IAM ç”¨æˆ·
- busrom-develop-staging    # Staging ç¯å¢ƒ
- busrom-develop-production # Production ç¯å¢ƒï¼ˆæƒé™æ›´å—é™ï¼‰
```

---

## ğŸ“ å¿«é€Ÿæ‰§è¡Œæ¸…å•

- [ ] å†³å®šä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆAdministratorAccessï¼‰è¿˜æ˜¯æ–¹æ¡ˆ 2ï¼ˆæ‰©å±•æƒé™é›†ï¼‰
- [ ] è®© AWS ç®¡ç†å‘˜è¿è¡Œ `./scripts/attach-full-permissions.sh busrom-develop`
- [ ] éªŒè¯æƒé™ï¼š`aws iam list-attached-user-policies --user-name busrom-develop`
- [ ] è¿è¡ŒåŸºç¡€è®¾æ–½è„šæœ¬ï¼š`./scripts/setup-aws-infrastructure.sh staging`
- [ ] ï¼ˆæ¨èï¼‰å¯ç”¨ MFA
- [ ] ï¼ˆæ¨èï¼‰è®¾ç½®è®¿é—®å¯†é’¥è½®æ¢æé†’
- [ ] å°† Gemini API Key å­˜å‚¨åˆ° Secrets Manager
- [ ] å¼€å§‹å¼€å‘ SageMaker æ¨¡å‹è®­ç»ƒä»£ç 

---

## ğŸ“ é¢å¤–èµ„æº

- [AWS SageMaker æ–‡æ¡£](https://docs.aws.amazon.com/sagemaker/)
- [LightGBM on SageMaker](https://aws.amazon.com/blogs/machine-learning/train-and-deploy-lightgbm-models-using-amazon-sagemaker/)
- [Google Gemini API æ–‡æ¡£](https://ai.google.dev/docs)
- [AWS Secrets Manager æœ€ä½³å®è·µ](https://docs.aws.amazon.com/secretsmanager/latest/userguide/best-practices.html)

---

**å»ºè®®ï¼šå¯¹äºæ‚¨çš„ç”¨ä¾‹ï¼ˆå¼€å‘ç¯å¢ƒ + éœ€è¦å®éªŒå¤šç§ AWS æœåŠ¡ï¼‰ï¼Œç›´æ¥ä½¿ç”¨ AdministratorAccess æ˜¯æœ€é«˜æ•ˆçš„é€‰æ‹©ï¼**
